% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/weighted_var.R
\name{weighted_var}
\alias{weighted_var}
\title{Calculate Sample Weighted Variance}
\usage{
weighted_var(x, w, na.rm = FALSE)
}
\arguments{
\item{x}{numeric vector; the data values for which to calculate weighted variance.
Missing values are allowed if \code{na.rm = TRUE}}

\item{w}{numeric vector; the precision weights corresponding to each observation in \code{x}.
These represent how much confidence to place in each measurement (higher = more trusted).
Must be the same length as \code{x}. Should be non-negative}

\item{na.rm}{logical; if \code{TRUE}, missing values (both \code{NA} and \code{NaN})
are removed before computation. If \code{FALSE} (default), missing
values will cause the function to return \code{NA}}
}
\value{
numeric; the weighted sample variance. Returns \code{NA} if insufficient
data or if \code{na.rm = FALSE} and missing values are present
}
\description{
Computes the sample weighted variance of a numeric vector using precision weights.
This function implements the standard unbiased weighted variance estimator commonly
used in statistical applications where observations have different precisions
or levels of confidence.
}
\details{
The weighted variance is calculated using the formula:
\deqn{s^2_w = \frac{\sum w_i}{(\sum w_i)^2 - \sum w_i^2} \sum w_i (x_i - \bar{x}_w)^2}

where \eqn{\bar{x}_w} is the weighted mean and \eqn{w_i} are the weights.

This function uses precision weights (also called reliability weights), which represent how much confidence or trust to place in each observation, rather than frequency weights that represent how many times to count each observation.

The denominator correction (\eqn{(\sum w_i)^2 - \sum w_i^2}) provides an
unbiased estimator for precision weights. Examples of precision weights include
probabilities (0-1), measurement confidence scores, or inverse error variances.
}
\examples{
\dontrun{
values <- c(2.1, 3.5, 1.8, 4.2, 2.9)
weights <- c(0.8, 0.3, 0.9, 0.5, 0.7)
weighted_var(values, weights)
}
}
\seealso{
\code{\link{weighted.mean}} for weighted mean calculation,
\code{\link{var}} for unweighted sample variance
}
\keyword{internal}
