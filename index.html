<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Toolkit to Estimate Infectious Disease Dynamics Parameters • mitey</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Toolkit to Estimate Infectious Disease Dynamics Parameters">
<meta name="description" content="This package provides methods to estimate key epidemiological parameters for infectious diseases with particular application to scabies.">
<meta property="og:description" content="This package provides methods to estimate key epidemiological parameters for infectious diseases with particular application to scabies.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">mitey</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/code_validation_for_Vink_method.html">Code validation for Vink method</a></li>
    <li><a class="dropdown-item" href="articles/epidemiology_of_scabies.html">Estimation of the epidemiological characteristics of scabies</a></li>
    <li><a class="dropdown-item" href="articles/reproduce_results_ainslie_et_al.html">Reproduce Results from Ainslie et al.</a></li>
    <li><a class="dropdown-item" href="articles/rt_estimation_validation.html">Validation of time-varying reproduction number estimation</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kylieainslie/mitey/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="the-mitey-package">The <code>mitey</code> package<a class="anchor" aria-label="anchor" href="#the-mitey-package"></a>
</h1></div>
<!-- badges: start -->
<!-- [![R-CMD-check](https://github.com/kylieainslie/mitey/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/kylieainslie/mitey/actions/workflows/R-CMD-check.yaml) -->
<!--[![CRAN_Status_Badge](https://www.r-pkg.org/badges/version/your-package)](https://CRAN.R-project.org/package=your-package) -->
<!-- [![codecov](https://codecov.io/gh/kylieainslie/mitey/branch/main/graph/badge.svg)](https://codecov.io/gh/kylieainslie/mitey) -->
<!-- [![License](https://img.shields.io/badge/license-MIT-blue.svg)](./LICENSE) -->
<!-- ![GitHub Stars](https://img.shields.io/github/stars/kylieainslie/mitey) -->
<!-- [![DOI](https://zenodo.org/badge/DOI/<DOI>.svg)](https://doi.org/<DOI>)  -->
<!--[![Downloads](https://cranlogs.r-pkg.org/badges/grand-total/mitey)](https://CRAN.R-project.org/package=mitey) -->
<!-- badges: end -->
<p>The <code>mitey</code> package is a lightweight package designed originally as a companion to the analyses presented by <a href="http://dx.doi.org/10.2139/ssrn.5184990" class="external-link">Ainslie et al. 2025</a> on scabies transmission. However, these methods are more widely applicable than in the context of scabies, thus the motivation behind creating the <code>mitey</code> package was twofold and also provides flexible, documented code for methods to estimate epidemiological quantities of interest.</p>
<p>Currently, <code>mitey</code> includes methods to estimate a) the mean and standard deviation of the serial interval distribution using a maximum likelihood framework developed by <a href="https://doi.org/10.1093/aje/kwu209" class="external-link">Vink et al. 2014</a> and b) the time-varying reproduction number using the method developed by <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC1766383/" class="external-link">Walling and Lipsitch 2007</a>.</p>
<div class="section level3">
<h3 id="estimating-the-serial-interval">Estimating the serial interval<a class="anchor" aria-label="anchor" href="#estimating-the-serial-interval"></a>
</h3>
<p>The method developed by Vink et al. uses data about the time of symptom onset with no precise information about transmission pairs and an assumed underlying serial interval distribution (either Gaussian or Gamma) to estimate the mean and standard deviation of the serial interval distribution. Briefly, the method involves calculating the index case-to-case (ICC) interval for each person, where the person with the earliest date of symptom onset will be considered the index case. The rest of the individuals will have an ICC interval calculated as the number of days between their symptom onset and the index case.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p>Install <a href="http://cran.r-project.org" class="external-link">R</a></p></li>
<li><p>Install the development version of mitey from <a href="https://github.com/kylieainslie/mitey" class="external-link">GitHub</a>:</p></li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"kylieainslie/mitey"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="vignettes">Vignettes<a class="anchor" aria-label="anchor" href="#vignettes"></a>
</h2>
<ul>
<li><p>The manuscript pre-print that motivated the development of this package can be found <a href="https://kylieainslie.github.io/mitey/articles/epidemiology_of_scabies.html">here</a>.</p></li>
<li><p>A script that reproduces the results from <a href="http://dx.doi.org/10.2139/ssrn.5184990" class="external-link">Ainslie et al. 2025</a> can be found <a href="https://kylieainslie.github.io/mitey/articles/reproduce_results_ainslie_et_al.html">here</a>.</p></li>
<li><p>Validation of the method used to estimate the mean and standard deviation of the serial interval proposed by <a href="https://doi.org/10.1093/aje/kwu209" class="external-link">Vink et al. 2014</a> can be found <a href="https://kylieainslie.github.io/mitey/articles/code_validation_for_Vink_method.html">here</a>.</p></li>
<li><p>Validation of the method used to estimate the time-varying reproduction number proposed by <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC1766383/" class="external-link">Wallinga and Lipsitch 2007</a> can be found <a href="https://kylieainslie.github.io/mitey/articles/rt_estimation_validation.html">here</a>.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h2>
<p>Several data files are stored in the repo so that the results presented in <a href="http://dx.doi.org/10.2139/ssrn.5184990" class="external-link">Ainslie et al. 2025</a> are reproducible. Data files are stored in <code>inst/extdata/data/</code>. Below is a brief description of the different files.</p>
<ul>
<li>
<code>si_data.rds</code>
<ul>
<li>Description: Data on date of symptom onset for scabies outbreaks described by Kaburi et al., Akunzirwe et al., Tjon-Kon-Fat et al., and Ariza et al. For all outbreaks except Kaburi et al. the raw data was not available, thus the date of symptom onset data had to be reconstructed using the epidemic curve provided in the manuscript. The original data from Kaburi et al. is also available in the <code>data</code> directory (<code>Kaburi_et_al_data_scabies.xlsx</code>).</li>
<li>
<em>Source</em>:
<ul>
<li>
<a href="https://doi.org/10.1186/s12889-019-7085-6" class="external-link">Kaburi et al.</a>,</li>
<li>
<a href="https://doi.org/10.21203/rs.3.rs-3205380/v1" class="external-link">Akunzirwe et al.</a>,</li>
<li><a href="https://doi.org/10.1371/journal.pntd.0009485" class="external-link">Tjon-Kon-Fat et al.</a></li>
<li>
<a href="https://doi.org/10.1007/s10096-012-1752-1" class="external-link">Ariza et al.</a>.</li>
</ul>
</li>
</ul>
</li>
<li>
<code>scabies_data_yearly.xlsx</code>
<ul>
<li>
<em>Description:</em> Annual scabies incidence per 1000 people in the Netherlands from 2011-2023.</li>
<li>
<em>Source:</em> <a href="https://www.nivel.nl/nl/zorg-en-ziekte-in-cijfers" class="external-link">Nivel</a>
</li>
</ul>
</li>
<li>
<code>scabies_data_consultation_weekly.xslx</code>
<ul>
<li>
<em>Description:</em> Weekly numbers of persons consulting for scabies (per 100,000 people) from 2011 to 2023 in the Neltherlands as diagnosed by general practitioners (GPs). <em>Note:</em> Individuals in institutions (e.g., care homes, prisons) usually have their own health care provider and are generally not taken into account in GP registrations.</li>
<li>
<em>Source:</em> Nivel</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>This is a basic example of estimating the mean serial interval from data on time of symptom onset for an infectious disease. We first simulate index case-to-case (ICC) intervals. Here, we directly simulate the ICC intervals based on their route of transmission. The specified mean serial interval <code>hmu</code> is 15 and the specified standard deviation <code>hsigma</code> is 3. The weights for each route of transmission are specified as <code>hw1</code>, <code>hw2</code>, <code>hw3</code>, and <code>hw4</code>, respectively.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kylieainslie/mitey" class="external-link">mitey</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://strimmerlab.github.io/software/fdrtool/" class="external-link">fdrtool</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">5000</span>; <span class="va">hmu</span><span class="op">&lt;-</span><span class="fl">15</span>; <span class="va">hsigma</span><span class="op">&lt;-</span><span class="fl">3</span>; <span class="va">hw1</span> <span class="op">&lt;-</span> <span class="fl">0.2</span>; <span class="va">hw2</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>; <span class="va">hw3</span> <span class="op">&lt;-</span> <span class="fl">0.2</span>; <span class="va">hw4</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span></span>
<span><span class="va">CP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fdrtool/man/halfnorm.html" class="external-link">rhalfnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">hw1</span><span class="op">*</span><span class="va">N</span><span class="op">)</span>,theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">pi</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="va">hsigma</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">PS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">hw2</span><span class="op">*</span><span class="va">N</span>,mean<span class="op">=</span><span class="va">hmu</span>,sd<span class="op">=</span><span class="va">hsigma</span><span class="op">)</span></span>
<span><span class="va">PT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">hw3</span><span class="op">*</span><span class="va">N</span>,mean<span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="va">hmu</span>,sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="va">hsigma</span><span class="op">)</span></span>
<span><span class="va">PQ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">hw4</span><span class="op">*</span><span class="va">N</span>,mean<span class="op">=</span><span class="fl">3</span><span class="op">*</span><span class="va">hmu</span>,sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">*</span><span class="va">hsigma</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">CP</span>,<span class="va">PS</span>,<span class="va">PT</span>,<span class="va">PQ</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can look at our simulated data by plotting them as a histogram.</p>
<div class="figure">
<img src="reference/figures/README-plot_sim_data-1.png" alt="Figure 1. Histogram of index-case to case intervals (in days) for simulated data." width="100%"><p class="caption">
Figure 1. Histogram of index-case to case intervals (in days) for simulated data.
</p>
</div>
<p>Then, we estimate the mean and standard deviation of the simulated serial interval using the <code>si_estim</code> function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/si_estim.html">si_estim</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">)</span></span>
<span><span class="va">results</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt; [1] 15.16373</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sd</span></span>
<span><span class="co">#&gt; [1] 2.823293</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $wts</span></span>
<span><span class="co">#&gt; [1] 2.113966e-01 4.841131e-01 7.836824e-09 2.021913e-01 3.062666e-15</span></span>
<span><span class="co">#&gt; [6] 1.022991e-01 1.368660e-21</span></span></code></pre></div>
<p>The output of <code>si_estim</code> is a named list with elements <code>mean</code>, <code>sd</code>, and <code>wts</code>, which contain the estimated mean, standard deviation, and weights of the serial interval distribution, respectively. We see that using the simulated data and assuming an underlying normal distribution, we obtain estimates very close to the input values: a mean serial interval estimate of 15.16 and a standard deviation of 2.82. We are also able to recapture the input weights: hw1 = 0.21, hw2 = 0.48, hw3 = 0.2, hw4 = 0.1.</p>
<p>Using the <code>plot_si_fit</code> function, we can use the outputs of <code>si_estim</code> to plot the fitted serial interval over the symptom onset data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plot_si_fit.html">plot_si_fit</a></span><span class="op">(</span></span>
<span>    dat <span class="op">=</span> <span class="va">sim_data</span>,</span>
<span>    mean <span class="op">=</span> <span class="va">results</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    sd <span class="op">=</span> <span class="va">results</span><span class="op">$</span><span class="va">sd</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">results</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">results</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>                <span class="va">results</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">+</span> <span class="va">results</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, <span class="va">results</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span> <span class="op">+</span> <span class="va">results</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    dist <span class="op">=</span> <span class="st">"normal"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-plot_sim_data_fit-1.png" alt="Figure 2. Fitted serial interval curves plotted over symptom onset data for simulated symptom onset data. Red line is the fitted serial interval curves assuming an underlying Normal distribution." width="100%"><p class="caption">
Figure 2. Fitted serial interval curves plotted over symptom onset data for simulated symptom onset data. Red line is the fitted serial interval curves assuming an underlying Normal distribution.
</p>
</div>
<!--You'll still need to render `README.Rmd` regularly, to keep `README.md` up-to-date. `devtools::build_readme()` is handy for this. -->
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/kylieainslie/mitey/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/kylieainslie/mitey/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing mitey</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Kylie Ainslie <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-5419-7206" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kylie Ainslie.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
