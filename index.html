<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Toolkit to Estimate Infectious Disease Dynamics Parameters • mitey</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Toolkit to Estimate Infectious Disease Dynamics Parameters">
<meta name="description" content="This package provides methods to estimate key epidemiological parameters for infectious diseases with particular application to scabies.">
<meta property="og:description" content="This package provides methods to estimate key epidemiological parameters for infectious diseases with particular application to scabies.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">mitey</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/code_validation_for_Vink_method.html">Code validation for Vink method</a></li>
    <li><a class="dropdown-item" href="articles/epidemiology_of_scabies.html">On the epidemiological characteristics of scabies</a></li>
    <li><a class="dropdown-item" href="articles/rt_estimation_validation.html">Validation of time-varying reproduction number estimation</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kylieainslie/mitey/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="the-mitey-package">The <code>mitey</code> package<a class="anchor" aria-label="anchor" href="#the-mitey-package"></a>
</h1></div>
<!-- badges: start -->
<!-- badges: end -->
<p>The motivation behind creating the <code>mitey</code> package was twofold:</p>
<ol style="list-style-type: decimal">
<li><p>to provide the data and code to reproduce the results in Ainslie, K, Hooiveld, M, and Wallinga, J. 2024. On the epidemiological characteristics of scabies. <a href="https://kylieainslie.github.io/mitey/articles/epidemiology_of_scabies.html">pre-print</a>, and</p></li>
<li><p>to provide flexible, documented code for methods not previously available in <code>R</code> that can help estimate epidemiological quantities of interest.</p></li>
</ol>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p>Install <a href="http://cran.r-project.org" class="external-link">R</a></p></li>
<li><p>Install the development version of serosolver from <a href="https://github.com/kylieainslie/mitey" class="external-link">GitHub</a>:</p></li>
</ol>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"kylieainslie/mitey"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="guide-and-vignettes">Guide and vignettes<a class="anchor" aria-label="anchor" href="#guide-and-vignettes"></a>
</h2>
<p>A quick start guide and detailed vignettes are still in development.</p>
<p>Validation of the method used to estimate the mean and standard deviation of the serial interval proposed by <a href="https://doi.org/10.1093/aje/kwu209" class="external-link">Vink et al. 2014</a> can be found <a href="https://kylieainslie.github.io/mitey/articles/code_validation_for_Vink_method.html">here</a>.</p>
<p>The manuscript pre-print that motivated the development of this package can be found <a href="https://kylieainslie.github.io/mitey/articles/epidemiology_of_scabies.html">here</a>.</p>
<p>Validation of the method used to estimate the time-varying reproduction number proposed by <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC1766383/" class="external-link">Wallinga and Lipsitch 2007</a> can be found <a href="https://kylieainslie.github.io/mitey/articles/rt_estimation_validation.html">here</a>. <em>Note: this vignette is still under development, so is incomplete.</em></p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>This is a basic example of estimating the mean serial interval from data on time of symptom onset for an infectious disease. We first simulate index case-to-case (ICC) intervals. Here, we directly simulate the ICC intervals based on their route of transmission. The specified mean serial interval <code>hmu</code> is 15 and the specified standard deviation <code>hsigma</code> is 3. The weights for each route of transmission are specified as <code>hw1</code>, <code>hw2</code>, <code>hw3</code>, and <code>hw4</code>, respectively.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kylieainslie/mitey" class="external-link">mitey</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://strimmerlab.github.io/software/fdrtool/" class="external-link">fdrtool</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">5000</span>; <span class="va">hmu</span><span class="op">&lt;-</span><span class="fl">15</span>; <span class="va">hsigma</span><span class="op">&lt;-</span><span class="fl">3</span>; <span class="va">hw1</span> <span class="op">&lt;-</span> <span class="fl">0.2</span>; <span class="va">hw2</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>; <span class="va">hw3</span> <span class="op">&lt;-</span> <span class="fl">0.2</span>; <span class="va">hw4</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span></span>
<span><span class="va">CP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/fdrtool/man/halfnorm.html" class="external-link">rhalfnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">hw1</span><span class="op">*</span><span class="va">N</span><span class="op">)</span>,theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">pi</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="va">hsigma</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">PS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">hw2</span><span class="op">*</span><span class="va">N</span>,mean<span class="op">=</span><span class="va">hmu</span>,sd<span class="op">=</span><span class="va">hsigma</span><span class="op">)</span></span>
<span><span class="va">PT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">hw3</span><span class="op">*</span><span class="va">N</span>,mean<span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="va">hmu</span>,sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="va">hsigma</span><span class="op">)</span></span>
<span><span class="va">PQ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">hw4</span><span class="op">*</span><span class="va">N</span>,mean<span class="op">=</span><span class="fl">3</span><span class="op">*</span><span class="va">hmu</span>,sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">*</span><span class="va">hsigma</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">CP</span>,<span class="va">PS</span>,<span class="va">PT</span>,<span class="va">PQ</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can look at our simulated data by plotting them as a histogram.</p>
<div class="figure">
<img src="reference/figures/README-plot_sim_data-1.png" alt="Figure 1. Histogram of index-case to case intervals (in days) for simulated data." width="100%"><p class="caption">
Figure 1. Histogram of index-case to case intervals (in days) for simulated data.
</p>
</div>
<p>Then, we estimate the mean and standard deviation of the simulated serial interval using the <code>si_estim</code> function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/si_estim.html">si_estim</a></span><span class="op">(</span><span class="va">sim_data</span><span class="op">)</span></span>
<span><span class="va">results</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt; [1] 15.16373</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sd</span></span>
<span><span class="co">#&gt; [1] 2.823293</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $wts</span></span>
<span><span class="co">#&gt; [1] 2.113966e-01 4.841131e-01 7.836824e-09 2.021913e-01 3.062666e-15</span></span>
<span><span class="co">#&gt; [6] 1.022991e-01 1.368660e-21</span></span></code></pre></div>
<p>The output of <code>si_estim</code> is a named list with elements <code>mean</code>, <code>sd</code>, and <code>wts</code>, which contain the estimated mean, standard deviation, and weights of the serial interval distribution, respectively. We see that using the simulated data and assuming an underlying normal distribution, we obtain estimates very close to the input values: a mean serial interval estimate of 15.16 and a standard deviation of 2.82. We are also able to recapture the input weights: hw1 = 0.21, hw2 = 0.48, hw3 = 0.2, hw4 = 0.1.</p>
<p>Using the <code>plot_si_fit</code> function, we can use the outputs of <code>si_estim</code> to plot the fitted serial interval over the symptom onset data.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/plot_si_fit.html">plot_si_fit</a></span><span class="op">(</span></span>
<span>    dat <span class="op">=</span> <span class="va">sim_data</span>,</span>
<span>    mean <span class="op">=</span> <span class="va">results</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    sd <span class="op">=</span> <span class="va">results</span><span class="op">$</span><span class="va">sd</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">results</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">results</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">results</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>                <span class="va">results</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">+</span> <span class="va">results</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, <span class="va">results</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span> <span class="op">+</span> <span class="va">results</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    dist <span class="op">=</span> <span class="st">"normal"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reference/figures/README-plot_sim_data_fit-1.png" alt="Figure 2. Fitted serial interval curves plotted over symptom onset data for simulated symptom onset data. Red line is the fitted serial interval curves assuming an underlying Normal distribution." width="100%"><p class="caption">
Figure 2. Fitted serial interval curves plotted over symptom onset data for simulated symptom onset data. Red line is the fitted serial interval curves assuming an underlying Normal distribution.
</p>
</div>
<!--You'll still need to render `README.Rmd` regularly, to keep `README.md` up-to-date. `devtools::build_readme()` is handy for this. -->
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/kylieainslie/mitey/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/kylieainslie/mitey/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing mitey</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Kylie Ainslie <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-5419-7206" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kylie Ainslie.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
