<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate Time-Varying Case Reproduction Number Using Wallinga-Lipsitch Method — wallinga_lipsitch • mitey</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate Time-Varying Case Reproduction Number Using Wallinga-Lipsitch Method — wallinga_lipsitch"><meta name="description" content="Estimates the time-varying case reproduction number (R_c) from daily incidence data
using the method developed by Wallinga and Lipsitch (2007). The case reproduction
number represents the average number of secondary infections generated by cases
with symptom onset at time t, making it useful for retrospective outbreak analysis."><meta property="og:description" content="Estimates the time-varying case reproduction number (R_c) from daily incidence data
using the method developed by Wallinga and Lipsitch (2007). The case reproduction
number represents the average number of secondary infections generated by cases
with symptom onset at time t, making it useful for retrospective outbreak analysis."><meta property="og:image" content="https://kylieainslie.github.io/mitey/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mitey</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/code_validation_for_Vink_method.html">Code validation for Vink method</a></li>
    <li><a class="dropdown-item" href="../articles/quick_start_guide.html">Quick Start Guide: Estimating Epidemiological Parameters with `mitey`</a></li>
    <li><a class="dropdown-item" href="../articles/reproduce_results_ainslie_et_al.html">Reproduce Results from Ainslie et al.</a></li>
    <li><a class="dropdown-item" href="../articles/rt_estimation_validation.html">Estimation of time-varying reproduction number</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kylieainslie/mitey/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimate Time-Varying Case Reproduction Number Using Wallinga-Lipsitch Method</h1>
      <small class="dont-index">Source: <a href="https://github.com/kylieainslie/mitey/blob/v0.3.1/R/wallinga_lipsitch.R" class="external-link"><code>R/wallinga_lipsitch.R</code></a></small>
      <div class="d-none name"><code>wallinga_lipsitch.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimates the time-varying case reproduction number (R_c) from daily incidence data
using the method developed by Wallinga and Lipsitch (2007). The case reproduction
number represents the average number of secondary infections generated by cases
with symptom onset at time t, making it useful for retrospective outbreak analysis.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">wallinga_lipsitch</span><span class="op">(</span></span>
<span>  <span class="va">incidence</span>,</span>
<span>  <span class="va">dates</span>,</span>
<span>  <span class="va">si_mean</span>,</span>
<span>  <span class="va">si_sd</span>,</span>
<span>  si_dist <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>  smoothing <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  bootstrap <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_bootstrap <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  conf_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  shift <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-incidence">incidence<a class="anchor" aria-label="anchor" href="#arg-incidence"></a></dt>
<dd><p>numeric vector; daily case counts. Must be non-negative integers
or counts. Length must match <code>dates</code></p></dd>


<dt id="arg-dates">dates<a class="anchor" aria-label="anchor" href="#arg-dates"></a></dt>
<dd><p>vector; dates corresponding to each incidence count. Must be the same
length as <code>incidence</code>. Can be Date objects or anything coercible
to dates</p></dd>


<dt id="arg-si-mean">si_mean<a class="anchor" aria-label="anchor" href="#arg-si-mean"></a></dt>
<dd><p>numeric; mean of the serial interval distribution in days. Must be
positive. Typically estimated from contact tracing data or literature</p></dd>


<dt id="arg-si-sd">si_sd<a class="anchor" aria-label="anchor" href="#arg-si-sd"></a></dt>
<dd><p>numeric; standard deviation of the serial interval distribution in days.
Must be positive</p></dd>


<dt id="arg-si-dist">si_dist<a class="anchor" aria-label="anchor" href="#arg-si-dist"></a></dt>
<dd><p>character; distribution family for the serial interval. Options:</p><ul><li><p><code>"gamma"</code> (default): Recommended for most applications as it naturally
restricts to positive values</p></li>
<li><p><code>"normal"</code>: Allows negative serial intervals, useful when co-primary
infections are suspected</p></li>
</ul></dd>


<dt id="arg-smoothing">smoothing<a class="anchor" aria-label="anchor" href="#arg-smoothing"></a></dt>
<dd><p>integer; window size for temporal smoothing of R estimates. Use 0
for no smoothing (default), or positive integers for moving average
smoothing over the specified number of days</p></dd>


<dt id="arg-bootstrap">bootstrap<a class="anchor" aria-label="anchor" href="#arg-bootstrap"></a></dt>
<dd><p>logical; whether to calculate bootstrap confidence intervals.
Defaults to <code>FALSE</code>. Setting to <code>TRUE</code> increases
computation time but provides uncertainty quantification</p></dd>


<dt id="arg-n-bootstrap">n_bootstrap<a class="anchor" aria-label="anchor" href="#arg-n-bootstrap"></a></dt>
<dd><p>integer; number of bootstrap samples when <code>bootstrap = TRUE</code>.
More samples provide more stable intervals but increase computation
time. Defaults to 1000</p></dd>


<dt id="arg-conf-level">conf_level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>numeric; confidence level for bootstrap intervals, between 0 and 1.
Defaults to 0.95 (95% confidence intervals)</p></dd>


<dt id="arg-shift">shift<a class="anchor" aria-label="anchor" href="#arg-shift"></a></dt>
<dd><p>logical; whether to shift R estimates forward by one mean serial interval.
When <code>TRUE</code>, adds a <code>shifted_date</code> column for comparison with
instantaneous reproduction number estimates. Defaults to <code>FALSE</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with the following columns:</p><ul><li><p><code>date</code>: Original input dates</p></li>
<li><p><code>incidence</code>: Original input case counts</p></li>
<li><p><code>R</code>: Estimated case reproduction number</p></li>
<li><p><code>R_corrected</code>: Case reproduction number with right-truncation correction</p></li>
<li><p><code>R_lower, R_upper</code>: Bootstrap confidence intervals for R (if <code>bootstrap = TRUE</code>)</p></li>
<li><p><code>R_corrected_lower, R_corrected_upper</code>: Bootstrap confidence intervals for
R_corrected (if <code>bootstrap = TRUE</code>)</p></li>
<li><p><code>shifted_date</code>: Dates shifted forward by mean serial interval (if <code>shift = TRUE</code>)</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The method calculates the relative likelihood that each earlier case infected each
later case based on their time differences and the serial interval distribution, then
aggregates these likelihoods to estimate reproduction numbers. The approach makes
minimal assumptions beyond specifying the serial interval distribution.</p>
<p>Key features:</p><ul><li><p><strong>Pairwise likelihood approach</strong>: Considers all epidemiologically plausible transmission pairs (earlier to later cases)</p></li>
<li><p><strong>Right-truncation correction</strong>: Adjusts for unobserved future cases (see <code><a href="calculate_truncation_correction.html">calculate_truncation_correction</a></code>)</p></li>
<li><p><strong>Bootstrap confidence intervals</strong>: Quantifies estimation uncertainty</p></li>
<li><p><strong>Temporal shifting</strong>: Optional alignment with instantaneous R estimates</p></li>
<li><p><strong>Flexible smoothing</strong>: User-controlled temporal smoothing of estimates</p></li>
</ul><p>The Wallinga-Lipsitch method estimates the case reproduction number by:</p><ol><li><p>Computing transmission likelihoods from each earlier case to each later case based on the serial interval distribution</p></li>
<li><p>Normalizing these likelihoods so they sum to 1 for each potential infectee</p></li>
<li><p>Aggregating normalized likelihoods to estimate expected secondary cases per primary case</p></li>
<li><p>Applying corrections for right-truncation bias</p></li>
</ol><p><strong>Right-truncation correction</strong> accounts for secondary cases that may occur
after the observation period ends (see <code><a href="calculate_truncation_correction.html">calculate_truncation_correction</a></code>). This correction is particularly important for recent cases in the time series.</p>
<p><strong>Bootstrap confidence intervals</strong> are calculated by resampling individual
cases with replacement, providing non-parametric uncertainty estimates that
account for both Poisson sampling variation and method uncertainty.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The case reproduction number differs from the instantaneous reproduction
number in timing: R_c reflects the reproductive potential of cases by their
symptom onset date, while instantaneous R reflects transmission potential
at the time of infection. Use <code>shift = TRUE</code> for comparisons with
instantaneous R estimates.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Wallinga J, Lipsitch M (2007). How generation intervals shape the relationship between growth rates and reproductive numbers. Proceedings of the Royal Society B: Biological Sciences, 274(1609), 599-604. <a href="https://doi.org/10.1098/rspb.2006.3754" class="external-link">doi:10.1098/rspb.2006.3754</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="si_estim.html">si_estim</a></code> for serial interval estimation,
<code><a href="generate_synthetic_epidemic.html">generate_synthetic_epidemic</a></code> for testing data,
<code><a href="calculate_truncation_correction.html">calculate_truncation_correction</a></code> for right-truncation correction</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example 1: Basic usage with synthetic data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2023-01-01"</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"day"</span>, length.out <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">incidence</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">7</span>, <span class="fl">12</span>, <span class="fl">15</span>, <span class="fl">18</span>, <span class="fl">20</span>, <span class="fl">22</span>, <span class="fl">19</span>,</span></span>
<span class="r-in"><span>               <span class="fl">16</span>, <span class="fl">14</span>, <span class="fl">11</span>, <span class="fl">9</span>, <span class="fl">7</span>, <span class="fl">5</span>, <span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span>,</span></span>
<span class="r-in"><span>               <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Estimate reproduction number</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">wallinga_lipsitch</span><span class="op">(</span></span></span>
<span class="r-in"><span>  incidence <span class="op">=</span> <span class="va">incidence</span>,</span></span>
<span class="r-in"><span>  dates <span class="op">=</span> <span class="va">dates</span>,</span></span>
<span class="r-in"><span>  si_mean <span class="op">=</span> <span class="fl">7</span>,</span></span>
<span class="r-in"><span>  si_sd <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>  si_dist <span class="op">=</span> <span class="st">"gamma"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         date incidence         R R_corrected</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2023-01-01         1 18.651999          NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2023-01-02         2  9.587499    9.587576</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2023-01-03         4  5.705740    5.705825</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2023-01-04         7  3.529872    3.529970</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 2023-01-05        12  2.253060    2.253175</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 2023-01-06        15  1.466761    1.466898</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: With bootstrap confidence intervals</span></span></span>
<span class="r-in"><span><span class="va">result_ci</span> <span class="op">&lt;-</span> <span class="fu">wallinga_lipsitch</span><span class="op">(</span></span></span>
<span class="r-in"><span>  incidence <span class="op">=</span> <span class="va">incidence</span>,</span></span>
<span class="r-in"><span>  dates <span class="op">=</span> <span class="va">dates</span>,</span></span>
<span class="r-in"><span>  si_mean <span class="op">=</span> <span class="fl">7</span>,</span></span>
<span class="r-in"><span>  si_sd <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>  si_dist <span class="op">=</span> <span class="st">"gamma"</span>,</span></span>
<span class="r-in"><span>  bootstrap <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  n_bootstrap <span class="op">=</span> <span class="fl">500</span>  <span class="co"># Reduced for faster example</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot results with confidence intervals</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">result_ci</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">R_corrected_lower</span>, ymax <span class="op">=</span> <span class="va">R_corrected_upper</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                alpha <span class="op">=</span> <span class="fl">0.3</span>, fill <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">R_corrected</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"blue"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Reproduction Number"</span>,</span></span>
<span class="r-in"><span>         title <span class="op">=</span> <span class="st">"Time-varying Reproduction Number"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Please use `linewidth` instead.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 10 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_ribbon()`).</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Removed 11 rows containing missing values or values outside the scale range</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> (`geom_line()`).</span>
<span class="r-plt img"><img src="wallinga_lipsitch-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 3: With smoothing and shifting</span></span></span>
<span class="r-in"><span><span class="va">result_smooth</span> <span class="op">&lt;-</span> <span class="fu">wallinga_lipsitch</span><span class="op">(</span></span></span>
<span class="r-in"><span>  incidence <span class="op">=</span> <span class="va">incidence</span>,</span></span>
<span class="r-in"><span>  dates <span class="op">=</span> <span class="va">dates</span>,</span></span>
<span class="r-in"><span>  si_mean <span class="op">=</span> <span class="fl">7</span>,</span></span>
<span class="r-in"><span>  si_sd <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>  si_dist <span class="op">=</span> <span class="st">"gamma"</span>,</span></span>
<span class="r-in"><span>  smoothing <span class="op">=</span> <span class="fl">7</span>,  <span class="co"># 7-day smoothing window</span></span></span>
<span class="r-in"><span>  shift <span class="op">=</span> <span class="cn">TRUE</span>    <span class="co"># Shift for comparison with instantaneous R</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 4: Using normal distribution for serial interval</span></span></span>
<span class="r-in"><span><span class="va">result_normal</span> <span class="op">&lt;-</span> <span class="fu">wallinga_lipsitch</span><span class="op">(</span></span></span>
<span class="r-in"><span>  incidence <span class="op">=</span> <span class="va">incidence</span>,</span></span>
<span class="r-in"><span>  dates <span class="op">=</span> <span class="va">dates</span>,</span></span>
<span class="r-in"><span>  si_mean <span class="op">=</span> <span class="fl">6</span>,</span></span>
<span class="r-in"><span>  si_sd <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  si_dist <span class="op">=</span> <span class="st">"normal"</span>,</span></span>
<span class="r-in"><span>  smoothing <span class="op">=</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kylie Ainslie.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

