<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate Reproduction Number Estimates — calculate_r_estimates • mitey</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Reproduction Number Estimates — calculate_r_estimates"><meta name="description" content="Implements the Wallinga-Lipsitch algorithm to estimate case reproduction
numbers from incidence data and serial interval probabilities. This function
performs the likelihood calculations for retrospective reproduction
number estimation."><meta property="og:description" content="Implements the Wallinga-Lipsitch algorithm to estimate case reproduction
numbers from incidence data and serial interval probabilities. This function
performs the likelihood calculations for retrospective reproduction
number estimation."><meta property="og:image" content="https://kylieainslie.github.io/mitey/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mitey</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/code_validation_for_Vink_method.html">Code validation for Vink method</a></li>
    <li><a class="dropdown-item" href="../articles/quick_start_guide.html">Quick Start Guide: Estimating Epidemiological Parameters with `mitey`</a></li>
    <li><a class="dropdown-item" href="../articles/reproduce_results_ainslie_et_al.html">Reproduce Results from Ainslie et al.</a></li>
    <li><a class="dropdown-item" href="../articles/rt_estimation_validation.html">Estimation of time-varying reproduction number</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kylieainslie/mitey/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate Reproduction Number Estimates</h1>
      <small class="dont-index">Source: <a href="https://github.com/kylieainslie/mitey/blob/main/R/wl_helper_functions.R" class="external-link"><code>R/wl_helper_functions.R</code></a></small>
      <div class="d-none name"><code>calculate_r_estimates.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Implements the Wallinga-Lipsitch algorithm to estimate case reproduction
numbers from incidence data and serial interval probabilities. This function
performs the likelihood calculations for retrospective reproduction
number estimation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calculate_r_estimates</span><span class="op">(</span></span>
<span>  <span class="va">incidence</span>,</span>
<span>  <span class="va">si_prob</span>,</span>
<span>  <span class="va">dates</span>,</span>
<span>  <span class="va">si_mean</span>,</span>
<span>  <span class="va">si_sd</span>,</span>
<span>  <span class="va">si_dist</span>,</span>
<span>  <span class="va">smoothing</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-incidence">incidence<a class="anchor" aria-label="anchor" href="#arg-incidence"></a></dt>
<dd><p>numeric vector; daily case counts. Must be non-negative integers.
Days with zero cases will have R estimates of NA</p></dd>


<dt id="arg-si-prob">si_prob<a class="anchor" aria-label="anchor" href="#arg-si-prob"></a></dt>
<dd><p>numeric matrix; serial interval probability matrix from
<code><a href="calculate_si_probability_matrix.html">calculate_si_probability_matrix</a></code>. Element <code>[i,j]</code>
represents the probability that case j infected case i</p></dd>


<dt id="arg-dates">dates<a class="anchor" aria-label="anchor" href="#arg-dates"></a></dt>
<dd><p>vector; dates corresponding to incidence data. Used for
right-truncation correction calculations</p></dd>


<dt id="arg-si-mean">si_mean<a class="anchor" aria-label="anchor" href="#arg-si-mean"></a></dt>
<dd><p>numeric; mean of the serial interval distribution in days</p></dd>


<dt id="arg-si-sd">si_sd<a class="anchor" aria-label="anchor" href="#arg-si-sd"></a></dt>
<dd><p>numeric; standard deviation of the serial interval distribution in days</p></dd>


<dt id="arg-si-dist">si_dist<a class="anchor" aria-label="anchor" href="#arg-si-dist"></a></dt>
<dd><p>character; distribution type for serial interval, either "gamma"
or "normal"</p></dd>


<dt id="arg-smoothing">smoothing<a class="anchor" aria-label="anchor" href="#arg-smoothing"></a></dt>
<dd><p>integer; window size for temporal smoothing (0 = no smoothing).
When &gt; 1, applies centered moving average to reduce noise</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>named list with two numeric vectors of the same length as <code>incidence</code>:</p><ul><li><p><code>r</code>: Raw case reproduction number estimates. Returns NA for days
with zero cases or single-case epidemics</p></li>
<li><p><code>r_corrected</code>: Estimates with right-truncation correction applied.
Values &gt; 10 are capped at NA to avoid unrealistic estimates</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The algorithm calculates the probability that each earlier case infected each
later case based on their time difference and the serial interval distribution.
These probabilities are then aggregated to estimate the expected number of
secondary cases generated by cases on each day.</p>
<p>The Wallinga-Lipsitch method works by:</p><ol><li><p>Computing transmission likelihoods from earlier to later cases</p></li>
<li><p>Normalizing these likelihoods to create proper probabilities</p></li>
<li><p>Aggregating probabilities to estimate expected secondary cases per primary case</p></li>
<li><p>Applying right-truncation correction for cases near the observation end</p></li>
</ol><p>The right-truncation correction accounts for the fact that cases near the end
of the observation period may have generated secondary cases that occur after
data collection ended.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="wallinga_lipsitch.html">wallinga_lipsitch</a></code> for the main user interface,
<code><a href="calculate_si_probability_matrix.html">calculate_si_probability_matrix</a></code> for probability matrix creation,
<code><a href="calculate_truncation_correction.html">calculate_truncation_correction</a></code> for correction details</p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kylie Ainslie.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

