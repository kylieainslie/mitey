<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Compute Serial Interval Component Integrals for All Transmission Routes — integrate_components_wrapper • mitey</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Compute Serial Interval Component Integrals for All Transmission Routes — integrate_components_wrapper"><meta name="description" content="This wrapper function efficiently computes the likelihood contributions for all
relevant transmission route components for a given index case-to-case (ICC) interval.
It is a key component of the Vink method's Expectation-Maximization algorithm for
estimating serial interval parameters from outbreak data."><meta property="og:description" content="This wrapper function efficiently computes the likelihood contributions for all
relevant transmission route components for a given index case-to-case (ICC) interval.
It is a key component of the Vink method's Expectation-Maximization algorithm for
estimating serial interval parameters from outbreak data."><meta property="og:image" content="https://kylieainslie.github.io/mitey/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mitey</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/code_validation_for_Vink_method.html">Code validation for Vink method</a></li>
    <li><a class="dropdown-item" href="../articles/quick_start_guide.html">Quick Start Guide: Estimating Epidemiological Parameters with `mitey`</a></li>
    <li><a class="dropdown-item" href="../articles/reproduce_results_ainslie_et_al.html">Reproduce Results from Ainslie et al.</a></li>
    <li><a class="dropdown-item" href="../articles/rt_estimation_validation.html">Estimation of time-varying reproduction number</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kylieainslie/mitey/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Compute Serial Interval Component Integrals for All Transmission Routes</h1>
      <small class="dont-index">Source: <a href="https://github.com/kylieainslie/mitey/blob/main/R/integrate_components_wrapper.R" class="external-link"><code>R/integrate_components_wrapper.R</code></a></small>
      <div class="d-none name"><code>integrate_components_wrapper.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This wrapper function efficiently computes the likelihood contributions for all
relevant transmission route components for a given index case-to-case (ICC) interval.
It is a key component of the Vink method's Expectation-Maximization algorithm for
estimating serial interval parameters from outbreak data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">integrate_components_wrapper</span><span class="op">(</span><span class="va">d</span>, <span class="va">mu</span>, <span class="va">sigma</span>, dist <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-d">d<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>numeric; the index case-to-case (ICC) interval in days. Represents the
time difference between the symptom onset of the index case (latest case)
and the current case being evaluated. Must be non-negative</p></dd>


<dt id="arg-mu">mu<a class="anchor" aria-label="anchor" href="#arg-mu"></a></dt>
<dd><p>numeric; the mean of the serial interval distribution in days. Must be
positive for meaningful epidemiological interpretation</p></dd>


<dt id="arg-sigma">sigma<a class="anchor" aria-label="anchor" href="#arg-sigma"></a></dt>
<dd><p>numeric; the standard deviation of the serial interval distribution
in days. Must be positive</p></dd>


<dt id="arg-dist">dist<a class="anchor" aria-label="anchor" href="#arg-dist"></a></dt>
<dd><p>character; the assumed underlying distribution family for the serial
interval. Must be either "normal" or "gamma". Defaults to "normal".
Gamma distribution is often preferred for serial intervals as it
naturally restricts to positive values</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>numeric vector; integrated likelihood values for each relevant transmission
route component. The length depends on the distribution:</p><ul><li><p>Normal distribution: 7 values (components 1-7)</p></li>
<li><p>Gamma distribution: 4 values (components 1, 2, 4, 6)</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function handles different integration scenarios based on the distribution type
and ICC interval value:</p><ul><li><p>For <strong>normal distribution</strong>: Uses all 7 components representing the full
mixture of transmission routes (co-primary, primary-secondary with positive
and negative components, primary-tertiary, and primary-quaternary routes)</p></li>
<li><p>For <strong>gamma distribution</strong>: Uses components 1, 2, 4, and 6 only, as
the gamma distribution naturally handles only positive serial intervals,
eliminating the need for negative component pairs</p></li>
<li><p>For <strong>ICC interval = 0</strong>: Uses upper integration (<code>lower = FALSE</code>)
representing the special case of simultaneous symptom onset</p></li>
<li><p>For <strong>ICC interval &gt; 0</strong>: Uses lower integration (<code>lower = TRUE</code>)
representing the standard transmission likelihood calculation</p></li>
</ul><p>This function is primarily used internally by <code><a href="si_estim.html">si_estim()</a></code> as part of the
E-step in the EM algorithm. Each component represents a different hypothesis
about the transmission route:</p><ul><li><p>Component 1: Co-primary transmission (simultaneous exposure)</p></li>
<li><p>Components 2-3: Primary-secondary transmission (direct transmission)</p></li>
<li><p>Components 4-5: Primary-tertiary transmission (second generation)</p></li>
<li><p>Components 6-7: Primary-quaternary transmission (third generation)</p></li>
</ul><p>For gamma distributions, components 3, 5, and 7 are omitted because the gamma
distribution naturally handles the asymmetry that these components would otherwise
model in the normal distribution case.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Vink MA, Bootsma MCJ, Wallinga J (2014). Serial intervals of respiratory infectious
diseases: A systematic review and analysis. American Journal of Epidemiology,
180(9), 865-875.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="integrate_component.html">integrate_component</a></code>, <code><a href="si_estim.html">si_estim</a></code>, <code><a href="flower.html">flower</a></code>,
<code><a href="fupper.html">fupper</a></code>, <code><a href="f0.html">f0</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Basic example with normal distribution</span></span></span>
<span class="r-in"><span><span class="co"># Returns 7 component values for ICC interval of 10 days</span></span></span>
<span class="r-in"><span><span class="fu">integrate_components_wrapper</span><span class="op">(</span>d <span class="op">=</span> <span class="fl">10</span>, mu <span class="op">=</span> <span class="fl">15</span>, sigma <span class="op">=</span> <span class="fl">3</span>, dist <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.193978e-02 3.369814e-02 1.997254e-16 1.547844e-06 6.921256e-21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] 1.234742e-11 5.012834e-26</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same parameters with gamma distribution</span></span></span>
<span class="r-in"><span><span class="co"># Returns 4 component values (components 1, 2, 4, 6)</span></span></span>
<span class="r-in"><span><span class="fu">integrate_components_wrapper</span><span class="op">(</span>d <span class="op">=</span> <span class="fl">10</span>, mu <span class="op">=</span> <span class="fl">15</span>, sigma <span class="op">=</span> <span class="fl">3</span>, dist <span class="op">=</span> <span class="st">"gamma"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.196761e-02 3.355068e-02 2.444605e-10 6.004790e-24</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Special case: ICC interval of 0 (simultaneous onset)</span></span></span>
<span class="r-in"><span><span class="fu">integrate_components_wrapper</span><span class="op">(</span>d <span class="op">=</span> <span class="fl">0</span>, mu <span class="op">=</span> <span class="fl">12</span>, sigma <span class="op">=</span> <span class="fl">2</span>, dist <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.791926e-01 1.042142e-08 1.371410e-09 1.145498e-16 1.483522e-17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] 1.434277e-24 1.847568e-25</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kylie Ainslie.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

