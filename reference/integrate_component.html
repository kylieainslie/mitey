<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Integrate Serial Interval Component Functions for Likelihood Calculation — integrate_component • mitey</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Integrate Serial Interval Component Functions for Likelihood Calculation — integrate_component"><meta name="description" content="This function performs numerical integration of serial interval component functions
used in the Vink method for estimating serial interval distributions. It integrates
the probability density functions for different transmission routes over specified
intervals as part of the Expectation-Maximization algorithm."><meta property="og:description" content="This function performs numerical integration of serial interval component functions
used in the Vink method for estimating serial interval distributions. It integrates
the probability density functions for different transmission routes over specified
intervals as part of the Expectation-Maximization algorithm."><meta property="og:image" content="https://kylieainslie.github.io/mitey/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mitey</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/code_validation_for_Vink_method.html">Code validation for Vink method</a></li>
    <li><a class="dropdown-item" href="../articles/quick_start_guide.html">Quick Start Guide: Estimating Epidemiological Parameters with `mitey`</a></li>
    <li><a class="dropdown-item" href="../articles/reproduce_results_ainslie_et_al.html">Reproduce Results from Ainslie et al.</a></li>
    <li><a class="dropdown-item" href="../articles/rt_estimation_validation.html">Estimation of time-varying reproduction number</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kylieainslie/mitey/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Integrate Serial Interval Component Functions for Likelihood Calculation</h1>
      <small class="dont-index">Source: <a href="https://github.com/kylieainslie/mitey/blob/main/R/integrate_component.R" class="external-link"><code>R/integrate_component.R</code></a></small>
      <div class="d-none name"><code>integrate_component.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function performs numerical integration of serial interval component functions
used in the Vink method for estimating serial interval distributions. It integrates
the probability density functions for different transmission routes over specified
intervals as part of the Expectation-Maximization algorithm.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">integrate_component</span><span class="op">(</span></span>
<span>  <span class="va">d</span>,</span>
<span>  <span class="va">mu</span>,</span>
<span>  <span class="va">sigma</span>,</span>
<span>  <span class="va">comp</span>,</span>
<span>  dist <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"normal"</span>, <span class="st">"gamma"</span><span class="op">)</span>,</span>
<span>  lower <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-d">d<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>numeric; the index case-to-case (ICC) interval in days for which to calculate the likelihood contribution</p></dd>


<dt id="arg-mu">mu<a class="anchor" aria-label="anchor" href="#arg-mu"></a></dt>
<dd><p>numeric; the mean of the serial interval distribution in days</p></dd>


<dt id="arg-sigma">sigma<a class="anchor" aria-label="anchor" href="#arg-sigma"></a></dt>
<dd><p>numeric; the standard deviation of the serial interval distribution in days</p></dd>


<dt id="arg-comp">comp<a class="anchor" aria-label="anchor" href="#arg-comp"></a></dt>
<dd><p>integer; the transmission route component number (1 to 7). See Details for component definitions</p></dd>


<dt id="arg-dist">dist<a class="anchor" aria-label="anchor" href="#arg-dist"></a></dt>
<dd><p>character; the assumed underlying distribution of the serial interval.
Must be either "normal" or "gamma". Defaults to "normal"</p></dd>


<dt id="arg-lower">lower<a class="anchor" aria-label="anchor" href="#arg-lower"></a></dt>
<dd><p>logical; if <code>TRUE</code> (default), performs integration using <code>flower</code> and <code>fupper</code> functions. If <code>FALSE</code>, uses <code>f0</code> function</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>numeric; the integrated likelihood value for the specified component and data point. Used in the EM algorithm for serial interval estimation</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function supports two integration modes:</p><ul><li><p><code>lower = TRUE</code>: Integrates using <code>flower</code> and <code>fupper</code> functions
over intervals <code>[d-1, d]</code> and <code>[d, d+1]</code> respectively, representing the likelihood
contribution when case occurs at day d</p></li>
<li><p><code>lower = FALSE</code>: Integrates using <code>f0</code> function over interval <code>[d, d+1]</code>,
representing an alternative likelihood formulation</p></li>
</ul><p>The components represent different transmission routes in outbreak analysis:</p><ul><li><p>Component 1: Co-Primary (CP) transmission</p></li>
<li><p>Components 2+3: Primary-Secondary (PS) transmission</p></li>
<li><p>Components 4+5: Primary-Tertiary (PT) transmission</p></li>
<li><p>Components 6+7: Primary-Quaternary (PQ) transmission</p></li>
</ul><p>This function is primarily used internally by <code><a href="si_estim.html">si_estim()</a></code> as part of the Vink method for estimating serial interval parameters from outbreak data.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Vink MA, Bootsma MCJ, Wallinga J (2014). Serial intervals of respiratory infectious
diseases: A systematic review and analysis. American Journal of Epidemiology,
180(9), 865-875.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="flower.html">flower</a></code>, <code><a href="fupper.html">fupper</a></code>, <code><a href="f0.html">f0</a></code>, <code><a href="si_estim.html">si_estim</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Basic example with lower integration (default)</span></span></span>
<span class="r-in"><span><span class="co"># Component 2 represents primary-secondary transmission</span></span></span>
<span class="r-in"><span><span class="fu">integrate_component</span><span class="op">(</span>d <span class="op">=</span> <span class="fl">15</span>, mu <span class="op">=</span> <span class="fl">12</span>, sigma <span class="op">=</span> <span class="fl">3</span>, comp <span class="op">=</span> <span class="fl">2</span>, dist <span class="op">=</span> <span class="st">"normal"</span>, lower <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.08065146</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Upper integration example</span></span></span>
<span class="r-in"><span><span class="fu">integrate_component</span><span class="op">(</span>d <span class="op">=</span> <span class="fl">15</span>, mu <span class="op">=</span> <span class="fl">12</span>, sigma <span class="op">=</span> <span class="fl">3</span>, comp <span class="op">=</span> <span class="fl">2</span>, dist <span class="op">=</span> <span class="st">"normal"</span>, lower <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1.951533</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using gamma distribution</span></span></span>
<span class="r-in"><span><span class="fu">integrate_component</span><span class="op">(</span>d <span class="op">=</span> <span class="fl">10</span>, mu <span class="op">=</span> <span class="fl">8</span>, sigma <span class="op">=</span> <span class="fl">2</span>, comp <span class="op">=</span> <span class="fl">1</span>, dist <span class="op">=</span> <span class="st">"gamma"</span>, lower <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0009500035</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Component 1 (co-primary transmission) with normal distribution</span></span></span>
<span class="r-in"><span><span class="fu">integrate_component</span><span class="op">(</span>d <span class="op">=</span> <span class="fl">5</span>, mu <span class="op">=</span> <span class="fl">10</span>, sigma <span class="op">=</span> <span class="fl">3</span>, comp <span class="op">=</span> <span class="fl">1</span>, dist <span class="op">=</span> <span class="st">"normal"</span>, lower <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.09407604</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare different components for the same data point</span></span></span>
<span class="r-in"><span><span class="va">d_val</span> <span class="op">&lt;-</span> <span class="fl">20</span></span></span>
<span class="r-in"><span><span class="va">mu_val</span> <span class="op">&lt;-</span> <span class="fl">15</span></span></span>
<span class="r-in"><span><span class="va">sigma_val</span> <span class="op">&lt;-</span> <span class="fl">4</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate for components 1, 2, and 4 (different transmission routes)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">comp</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">integrate_component</span><span class="op">(</span><span class="va">d_val</span>, <span class="va">mu_val</span>, <span class="va">sigma_val</span>, <span class="va">comp</span>, <span class="st">"normal"</span>, lower <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0002805022 0.0457941110 0.0148641350</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kylie Ainslie.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

