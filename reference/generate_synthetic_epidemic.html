<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generate Synthetic Epidemic Data Using the Renewal Equation — generate_synthetic_epidemic • mitey</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate Synthetic Epidemic Data Using the Renewal Equation — generate_synthetic_epidemic"><meta name="description" content="Simulates epidemic incidence data with known reproduction numbers using the renewal
equation framework. This function is useful for testing and validating reproduction
number estimation methods, as it generates synthetic outbreaks with ground truth
R values that can be compared against estimated values."><meta property="og:description" content="Simulates epidemic incidence data with known reproduction numbers using the renewal
equation framework. This function is useful for testing and validating reproduction
number estimation methods, as it generates synthetic outbreaks with ground truth
R values that can be compared against estimated values."><meta property="og:image" content="https://kylieainslie.github.io/mitey/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mitey</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/code_validation_for_Vink_method.html">Code validation for Vink method</a></li>
    <li><a class="dropdown-item" href="../articles/quick_start_guide.html">Quick Start Guide: Estimating Epidemiological Parameters with `mitey`</a></li>
    <li><a class="dropdown-item" href="../articles/reproduce_results_ainslie_et_al.html">Reproduce Results from Ainslie et al.</a></li>
    <li><a class="dropdown-item" href="../articles/rt_estimation_validation.html">Estimation of time-varying reproduction number</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kylieainslie/mitey/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generate Synthetic Epidemic Data Using the Renewal Equation</h1>
      <small class="dont-index">Source: <a href="https://github.com/kylieainslie/mitey/blob/main/R/generate_synthetic_epidemic.R" class="external-link"><code>R/generate_synthetic_epidemic.R</code></a></small>
      <div class="d-none name"><code>generate_synthetic_epidemic.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Simulates epidemic incidence data with known reproduction numbers using the renewal
equation framework. This function is useful for testing and validating reproduction
number estimation methods, as it generates synthetic outbreaks with ground truth
R values that can be compared against estimated values.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">generate_synthetic_epidemic</span><span class="op">(</span></span>
<span>  <span class="va">true_r</span>,</span>
<span>  <span class="va">si_mean</span>,</span>
<span>  <span class="va">si_sd</span>,</span>
<span>  si_dist <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>  initial_cases <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-true-r">true_r<a class="anchor" aria-label="anchor" href="#arg-true-r"></a></dt>
<dd><p>numeric vector; the true time-varying reproduction numbers. The length
of this vector determines the number of days in the simulated epidemic</p></dd>


<dt id="arg-si-mean">si_mean<a class="anchor" aria-label="anchor" href="#arg-si-mean"></a></dt>
<dd><p>numeric; the mean of the serial interval distribution in days</p></dd>


<dt id="arg-si-sd">si_sd<a class="anchor" aria-label="anchor" href="#arg-si-sd"></a></dt>
<dd><p>numeric; the standard deviation of the serial interval distribution in days</p></dd>


<dt id="arg-si-dist">si_dist<a class="anchor" aria-label="anchor" href="#arg-si-dist"></a></dt>
<dd><p>character; the distribution family for the serial interval. Must be
either "gamma" (default) or "normal". Gamma is recommended as it
naturally restricts to positive values</p></dd>


<dt id="arg-initial-cases">initial_cases<a class="anchor" aria-label="anchor" href="#arg-initial-cases"></a></dt>
<dd><p>integer; the number of cases on the first day of the epidemic.
Defaults to 10</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with three columns:</p><ul><li><p><code>date</code>: Date sequence starting from "2023-01-01"</p></li>
<li><p><code>true_r</code>: The input reproduction number values</p></li>
<li><p><code>incidence</code>: Simulated daily case counts</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function implements the discrete renewal equation:
$$\lambda_t = \sum_{s=1}^{t-1} I_s \cdot R_s \cdot w(t-s)$$</p>
<p>where \(\lambda_t\) is the expected number of new infections at time \(t\),
\(I_s\) is the incidence at time \(s\), \(R_s\) is the reproduction number
at time \(s\), and \(w(t-s)\) is the probability mass function of the serial
interval distribution for interval \(t-s\).</p>
<p>New cases at each time point are drawn from a Poisson distribution with mean
\(\lambda_t\), introducing realistic stochastic variation while maintaining
the specified reproduction number trajectory.</p>
<p>The serial interval distribution is truncated at the 99th percentile to avoid
computationally expensive calculations for very long tails. For the normal
distribution, the probability mass function is normalized to ensure proper
probability weights.</p>
<p>This function is particularly useful for:</p><ul><li><p>Validating reproduction number estimation methods</p></li>
<li><p>Testing the performance of epidemiological models</p></li>
<li><p>Generating realistic epidemic scenarios for research</p></li>
<li><p>Creating training data for machine learning approaches</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Fraser C (2007). Estimating individual and household reproduction numbers in an
emerging epidemic. PLoS One, 2(8), e758.</p>
<p>Cori A, Ferguson NM, Fraser C, Cauchemez S (2013). A new framework and software
to estimate time-varying reproduction numbers during epidemics. American Journal
of Epidemiology, 178(9), 1505-1512.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="wallinga_lipsitch.html">wallinga_lipsitch</a></code> for reproduction
number estimation methods that can be applied to the generated data</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Simple epidemic with constant R = 1.5</span></span></span>
<span class="r-in"><span><span class="va">constant_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">epidemic1</span> <span class="op">&lt;-</span> <span class="fu">generate_synthetic_epidemic</span><span class="op">(</span></span></span>
<span class="r-in"><span>  true_r <span class="op">=</span> <span class="va">constant_r</span>,</span></span>
<span class="r-in"><span>  si_mean <span class="op">=</span> <span class="fl">7</span>,</span></span>
<span class="r-in"><span>  si_sd <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>  si_dist <span class="op">=</span> <span class="st">"gamma"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">epidemic1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         date true_r incidence</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2023-01-01    1.5        10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2023-01-02    1.5         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2023-01-03    1.5         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2023-01-04    1.5         2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 2023-01-05    1.5         1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 2023-01-06    1.5         6</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Epidemic with declining R (e.g., intervention effect)</span></span></span>
<span class="r-in"><span><span class="va">declining_r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2.0</span>, <span class="fl">0.5</span>, length.out <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">epidemic2</span> <span class="op">&lt;-</span> <span class="fu">generate_synthetic_epidemic</span><span class="op">(</span></span></span>
<span class="r-in"><span>  true_r <span class="op">=</span> <span class="va">declining_r</span>,</span></span>
<span class="r-in"><span>  si_mean <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  si_sd <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  si_dist <span class="op">=</span> <span class="st">"gamma"</span>,</span></span>
<span class="r-in"><span>  initial_cases <span class="op">=</span> <span class="fl">5</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Epidemic with seasonal pattern</span></span></span>
<span class="r-in"><span><span class="va">days</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">seasonal_r</span> <span class="op">&lt;-</span> <span class="fl">1.2</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">days</span><span class="op">)</span> <span class="op">/</span> <span class="fl">365</span> <span class="op">*</span> <span class="fl">7</span><span class="op">)</span> <span class="co"># Weekly seasonality</span></span></span>
<span class="r-in"><span><span class="va">epidemic3</span> <span class="op">&lt;-</span> <span class="fu">generate_synthetic_epidemic</span><span class="op">(</span></span></span>
<span class="r-in"><span>  true_r <span class="op">=</span> <span class="va">seasonal_r</span>,</span></span>
<span class="r-in"><span>  si_mean <span class="op">=</span> <span class="fl">6</span>,</span></span>
<span class="r-in"><span>  si_sd <span class="op">=</span> <span class="fl">2.5</span>,</span></span>
<span class="r-in"><span>  si_dist <span class="op">=</span> <span class="st">"normal"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot the results</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">epidemic1</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">incidence</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">true_r</span> <span class="op">*</span> <span class="fl">10</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Synthetic Epidemic"</span>,</span></span>
<span class="r-in"><span>         y <span class="op">=</span> <span class="st">"Daily Incidence"</span>,</span></span>
<span class="r-in"><span>         subtitle <span class="op">=</span> <span class="st">"Red line: True R × 10"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: ggplot2</span>
<span class="r-plt img"><img src="generate_synthetic_epidemic-1.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kylie Ainslie.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

