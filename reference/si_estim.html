<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Estimate Serial Interval Distribution Using the Vink Method — si_estim • mitey</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate Serial Interval Distribution Using the Vink Method — si_estim"><meta name="description" content="Estimates the mean and standard deviation of the serial interval distribution from
outbreak data using the Expectation-Maximization (EM) algorithm developed by Vink
et al. (2014). The serial interval is defined as the time between symptom onset
in a primary case and symptom onset in a secondary case infected by that primary case."><meta property="og:description" content="Estimates the mean and standard deviation of the serial interval distribution from
outbreak data using the Expectation-Maximization (EM) algorithm developed by Vink
et al. (2014). The serial interval is defined as the time between symptom onset
in a primary case and symptom onset in a secondary case infected by that primary case."><meta property="og:image" content="https://kylieainslie.github.io/mitey/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mitey</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/code_validation_for_Vink_method.html">Code validation for Vink method</a></li>
    <li><a class="dropdown-item" href="../articles/quick_start_guide.html">Quick Start Guide: Estimating Epidemiological Parameters with `mitey`</a></li>
    <li><a class="dropdown-item" href="../articles/reproduce_results_ainslie_et_al.html">Reproduce Results from Ainslie et al.</a></li>
    <li><a class="dropdown-item" href="../articles/rt_estimation_validation.html">Estimation of time-varying reproduction number</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kylieainslie/mitey/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Estimate Serial Interval Distribution Using the Vink Method</h1>
      <small class="dont-index">Source: <a href="https://github.com/kylieainslie/mitey/blob/main/R/si_estim.R" class="external-link"><code>R/si_estim.R</code></a></small>
      <div class="d-none name"><code>si_estim.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Estimates the mean and standard deviation of the serial interval distribution from
outbreak data using the Expectation-Maximization (EM) algorithm developed by Vink
et al. (2014). The serial interval is defined as the time between symptom onset
in a primary case and symptom onset in a secondary case infected by that primary case.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">si_estim</span><span class="op">(</span><span class="va">dat</span>, n <span class="op">=</span> <span class="fl">50</span>, dist <span class="op">=</span> <span class="st">"normal"</span>, init <span class="op">=</span> <span class="cn">NULL</span>, tol <span class="op">=</span> <span class="fl">1e-06</span>, n_starts <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dat">dat<a class="anchor" aria-label="anchor" href="#arg-dat"></a></dt>
<dd><p>numeric vector; index case-to-case (ICC) intervals in days. These are
calculated as the time difference between symptom onset in each case and
symptom onset in the index case (case with earliest onset). Must contain
at least 2 values. Values should be non-negative in most epidemiological
contexts, though negative values are allowed for normal distribution</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>integer; number of EM algorithm iterations to perform. More iterations
generally improve convergence but increase computation time. Defaults to 50,
which is typically sufficient for convergence</p></dd>


<dt id="arg-dist">dist<a class="anchor" aria-label="anchor" href="#arg-dist"></a></dt>
<dd><p>character; the assumed parametric family for the serial interval distribution. Must be either:</p><ul><li><p><code>"normal"</code> (default): Allows negative serial intervals, uses 7 mixture components</p></li>
<li><p><code>"gamma"</code>: Restricts to positive serial intervals, uses 4 mixture components</p></li>
</ul></dd>


<dt id="arg-init">init<a class="anchor" aria-label="anchor" href="#arg-init"></a></dt>
<dd><p>numeric vector of length 2; initial values for the mean and standard
deviation to start the EM algorithm. If <code>NULL</code> (default), uses the
sample mean and sample standard deviation of the input data. Providing
good initial values can improve convergence, especially for challenging datasets</p></dd>


<dt id="arg-tol">tol<a class="anchor" aria-label="anchor" href="#arg-tol"></a></dt>
<dd><p>numeric; convergence tolerance for the EM algorithm. The algorithm stops
early if the relative change in both mean and standard deviation between
iterations is less than this value. Set to 0 to disable early stopping
and always run all <code>n</code> iterations. Defaults to 1e-6</p></dd>


<dt id="arg-n-starts">n_starts<a class="anchor" aria-label="anchor" href="#arg-n-starts"></a></dt>
<dd><p>integer; number of random restarts for the EM algorithm. The algorithm
can converge to local optima, especially when initial values are far from
the true parameters. Using multiple restarts with different starting points
helps find the global optimum. The first restart uses the provided <code>init</code>
values (or data-derived values if <code>init = NULL</code>), and subsequent restarts
use random starting points sampled from the data range. The result with the
highest log-likelihood is returned. Defaults to 1 (no additional restarts)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A named list containing:</p><ul><li><p><code>mean</code>: Estimated mean of the serial interval distribution (days)</p></li>
<li><p><code>sd</code>: Estimated standard deviation of the serial interval distribution (days)</p></li>
<li><p><code>wts</code>: Numeric vector of estimated component weights representing the
probability that cases belong to each transmission route. Length depends
on distribution choice (7 for normal, 4 for gamma)</p></li>
<li><p><code>converged</code>: Logical indicating whether the algorithm converged before
reaching the maximum number of iterations</p></li>
<li><p><code>iterations</code>: Integer indicating the number of iterations performed</p></li>
<li><p><code>loglik</code>: Log-likelihood of the fitted model (used for model comparison)</p></li>
<li><p><code>n_restarts</code>: Number of restarts performed</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The Vink method addresses the challenge that individual transmission pairs are
typically unknown in outbreak investigations. Instead, it uses index case-to-case
(ICC) intervals - the time differences between the case with earliest symptom onset
(index case) and all other cases - to infer the underlying serial interval
distribution through a mixture modeling approach.</p>
<p><strong>Methodological Approach:</strong></p>
<p>The method models ICC intervals as arising from a mixture of four transmission routes:</p><ul><li><p><strong>Co-Primary (CP)</strong>: Cases infected simultaneously from the same source</p></li>
<li><p><strong>Primary-Secondary (PS)</strong>: Direct transmission from index case</p></li>
<li><p><strong>Primary-Tertiary (PT)</strong>: Second-generation transmission</p></li>
<li><p><strong>Primary-Quaternary (PQ)</strong>: Third-generation transmission</p></li>
</ul><p>The EM algorithm iteratively:</p><ol><li><p><strong>E-step</strong>: Calculates the probability that each ICC interval belongs
to each transmission route component</p></li>
<li><p><strong>M-step</strong>: Updates the serial interval parameters (mean, standard deviation)
and component weights based on these probabilities</p></li>
</ol><p><strong>Distribution Choice:</strong></p>
<ul><li><p><strong>Normal distribution</strong>: Allows negative serial intervals (useful for
modeling co-primary infections) and uses 7 components (positive and negative
pairs for PS, PT, PQ routes plus CP)</p></li>
<li><p><strong>Gamma distribution</strong>: Restricts to positive values only, uses 4 components
(CP, PS, PT, PQ without negative pairs). Recommended when negative serial
intervals are epidemiologically implausible</p></li>
</ul><p><strong>Key Assumptions:</strong></p>
<ul><li><p>The case with earliest symptom onset is the index case</p></li>
<li><p>Transmission occurs through at most 4 generations</p></li>
<li><p>Serial intervals follow the specified parametric distribution</p></li>
<li><p>Cases represent a single, homogeneously-mixing outbreak</p></li>
</ul><p><strong>Input Data Preparation:</strong></p>
<p>To prepare ICC intervals from outbreak data:</p><ol><li><p>Identify the case with the earliest symptom onset date (index case)</p></li>
<li><p>Calculate the time difference (in days) between each case's onset
date and the index case onset date</p></li>
<li><p>The resulting values are the ICC intervals for input to this function</p></li>
</ol><p><strong>Convergence and Diagnostics:</strong></p>
<p>The EM algorithm typically converges within 20-50 iterations. Users should:</p><ul><li><p>Examine the fitted distribution using <code><a href="plot_si_fit.html">plot_si_fit</a></code></p></li>
<li><p>Consider alternative distribution choices if fit is poor</p></li>
<li><p>Try different initial values if results seem unreasonable</p></li>
<li><p>Ensure adequate sample size (generally &gt;20 cases recommended)</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Vink MA, Bootsma MCJ, Wallinga J (2014). Serial intervals of respiratory infectious
diseases: A systematic review and analysis. American Journal of Epidemiology,
180(9), 865-875. <a href="https://doi.org/10.1093/aje/kwu209" class="external-link">doi:10.1093/aje/kwu209</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="plot_si_fit.html">plot_si_fit</a></code> for diagnostic visualization,
<code><a href="integrate_component.html">integrate_component</a></code> for the underlying likelihood calculations</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example 1:Basic usage with simulated data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">simulated_icc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">20</span><span class="op">)</span>,   <span class="co"># Short intervals (co-primary cases)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">25</span><span class="op">)</span>,   <span class="co"># Medium intervals (primary-secondary)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">15</span><span class="op">)</span>,   <span class="co"># Longer intervals (higher generation)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">si_estim</span><span class="op">(</span><span class="va">simulated_icc</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Larger simulated outbreak, specifying distribution</span></span></span>
<span class="r-in"><span><span class="va">large_icc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">38</span><span class="op">)</span>,   <span class="co"># Short intervals (co-primary cases)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">39</span><span class="op">)</span>,   <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">30</span><span class="op">)</span>,   <span class="co"># Medium intervals (primary-secondary)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">17</span><span class="op">)</span>,   <span class="co">#</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">7</span><span class="op">)</span>,    <span class="co"># Longer intervals (higher generation)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">result_normal</span> <span class="op">&lt;-</span> <span class="fu">si_estim</span><span class="op">(</span><span class="va">large_icc</span>, dist <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">result_gamma</span> <span class="op">&lt;-</span> <span class="fu">si_estim</span><span class="op">(</span><span class="va">large_icc</span>, dist <span class="op">=</span> <span class="st">"gamma"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 3: Using custom initial values</span></span></span>
<span class="r-in"><span><span class="va">result_custom</span> <span class="op">&lt;-</span> <span class="fu">si_estim</span><span class="op">(</span><span class="va">large_icc</span>, dist <span class="op">=</span> <span class="st">"normal"</span>, init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.0</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 4: Specify iterations</span></span></span>
<span class="r-in"><span><span class="va">result_iter</span> <span class="op">&lt;-</span> <span class="fu">si_estim</span><span class="op">(</span><span class="va">large_icc</span>, n<span class="op">=</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 5: Check convergence status</span></span></span>
<span class="r-in"><span><span class="va">result_conv</span> <span class="op">&lt;-</span> <span class="fu">si_estim</span><span class="op">(</span><span class="va">large_icc</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="va">result_conv</span><span class="op">$</span><span class="va">converged</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Converged in "</span>, <span class="va">result_conv</span><span class="op">$</span><span class="va">iterations</span>, <span class="st">" iterations"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Converged in 32 iterations</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 6: Use multiple restarts to avoid local optima</span></span></span>
<span class="r-in"><span><span class="co"># Useful when initial values might be far from true parameters</span></span></span>
<span class="r-in"><span><span class="va">result_restarts</span> <span class="op">&lt;-</span> <span class="fu">si_estim</span><span class="op">(</span><span class="va">large_icc</span>, n_starts <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Best result from "</span>, <span class="va">result_restarts</span><span class="op">$</span><span class="va">n_restarts</span>, <span class="st">" restarts"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Best result from 5 restarts</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kylie Ainslie.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

