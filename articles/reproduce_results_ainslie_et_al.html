<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Reproduce Results from Ainslie et al. • mitey</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Reproduce Results from Ainslie et al.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mitey</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/code_validation_for_Vink_method.html">Code validation for Vink method</a></li>
    <li><a class="dropdown-item" href="../articles/quick_start_guide.html">Quick Start Guide: Estimating Epidemiological Parameters with `mitey`</a></li>
    <li><a class="dropdown-item" href="../articles/reproduce_results_ainslie_et_al.html">Reproduce Results from Ainslie et al.</a></li>
    <li><a class="dropdown-item" href="../articles/rt_estimation_validation.html">Estimation of time-varying reproduction number</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kylieainslie/mitey/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="reproduce_results_ainslie_et_al_files/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="reproduce_results_ainslie_et_al_files/tabwid-1.1.3/tabwid.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Reproduce Results from Ainslie et al.</h1>
                        <h4 data-toc-skip class="author">Kylie
Ainslie</h4>
            
            <h4 data-toc-skip class="date">2025-09-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/kylieainslie/mitey/blob/main/vignettes/articles/reproduce_results_ainslie_et_al.Rmd" class="external-link"><code>vignettes/articles/reproduce_results_ainslie_et_al.Rmd</code></a></small>
      <div class="d-none name"><code>reproduce_results_ainslie_et_al.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This article provides the code necessary to reproduce the results
from <a href="https://kylieainslie.github.io/mitey/articles/epidemiology_of_scabies.html">Ainslie
et al. 2025</a>. Briefly, the article demonstrates how key
epidemiological characteristics of scabies were estimated. Specifically,
the article shows how to estimate 1) the serial interval using a method
developed by <a href="https://doi.org/10.1093/aje/kwu209" class="external-link">Vink et
al.</a> by applying <code><a href="../reference/si_estim.html">mitey::si_estim()</a></code> to time series of
symptom onset date data from scabies outbreaks; 2) the growth rate from
annual scabies incidence from 2011 to 2023 in the Netherlands; 3) the
basic reproduction number; and 4) time-varying reproduction number using
a method developed by <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC1766383/" class="external-link">Wallinga and
Lipsitch</a> by applying <code><a href="../reference/wallinga_lipsitch.html">mitey::wallinga_lipsitch()</a></code> to data
on the number of scabies consultations each week in the Netherlands from
2011 to 2023. To our knowledge, this is the first study to estimate
these quantities for scabies; however, the methods demonstrated here can
be applied data sources describing the spread of other infectious
diseases.</p>
<p>Scabies is a neglected tropical disease caused by the mite Sarcoptes
scabiei that affects approximately 400 million people worldwide
annually. While historically a common affliction in Europe in the late
1800s and early 1900s, incidence declined significantly after World War
II. However, recent years have witnessed a concerning resurgence of
scabies across Western Europe, potentially increasing the burden on
healthcare systems. Despite its considerable impact, fundamental aspects
of scabies transmission dynamics remain poorly understood, making
epidemiological analyses like those presented in this vignette
critically important for informing public health responses.</p>
<p>This article is divided into Methods and Results. In the Methods
section, the code to perform the analyses is demonstrated. In the
Results section, we will show how to produce the figures and tables seen
in the manuscript.</p>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
</div>
<div class="section level2">
<h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h2>
<div class="section level3">
<h3 id="serial-interval">Serial Interval<a class="anchor" aria-label="anchor" href="#serial-interval"></a>
</h3>
<p>The following code estimates the serial interval distribution for
scabies from outbreak data<span class="citation"><sup>18–21</sup></span>. First, we load the dataset
containing index case-to-case (ICC) intervals from four studies
(<code>vignettes/data/si_data.rds</code>). We then apply the method
developed by Vink et al.<span class="citation"><sup>22</sup></span> to
estimate the mean and standard deviation of the serial interval,
assuming a Normal distribution. Finally, we restructure the results for
easier analysis and visualization.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read in data</span></span>
<span><span class="va">si_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"../data/si_data.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use method from Vink et al. to estimate SI for each study</span></span>
<span><span class="co"># assume a Normal distribution, then do some wrangling</span></span>
<span><span class="va">result_norm</span> <span class="op">&lt;-</span> <span class="va">si_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">icc_interval</span>, <span class="va">study</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">study</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>result <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/si_estim.html">si_estim</a></span><span class="op">(</span><span class="va">icc_interval</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"mean"</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"sd"</span><span class="op">)</span>,</span>
<span>    wts <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"wts"</span><span class="op">)</span>  <span class="co"># Store wts as a list-column</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">result</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">wts</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Unnest the wts column if needed %&gt;%</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mean</span>, <span class="va">sd</span>, <span class="va">wts</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"statistic"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"value"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">study</span>, <span class="va">statistic</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    occurrence <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    statistic <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">statistic</span> <span class="op">==</span> <span class="st">"wts"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"weight_"</span>, <span class="va">occurrence</span><span class="op">)</span>, <span class="va">statistic</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">statistic</span> <span class="op">!=</span> <span class="st">"mean"</span> <span class="op">|</span> <span class="va">occurrence</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">statistic</span> <span class="op">!=</span> <span class="st">"sd"</span> <span class="op">|</span> <span class="va">occurrence</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">occurrence</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Reshape results from long to wide format</span></span>
<span><span class="va">result_norm_wide</span> <span class="op">&lt;-</span> <span class="va">result_norm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">statistic</span>,</span>
<span>    values_from <span class="op">=</span> <span class="va">value</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>The code above groups the data by study, applies the si_estim()
function to each group, and extracts the estimated mean, standard
deviation, and weights. These weights represent the probabilities of
different transmission routes (co-primary, primary-secondary, etc.). The
resulting data frame contains all necessary parameters for plotting the
serial interval distributions in the Results section.</p>
<div class="section level4">
<h4 id="meta-analysis">Meta-analysis<a class="anchor" aria-label="anchor" href="#meta-analysis"></a>
</h4>
<p>To combine estimates from multiple studies, we perform a Bayesian
meta-analysis using the following steps: First, we merge the estimated
parameters with the original data. Then, we prepare a data frame with
means, standard deviations, and standard errors for each study. Finally,
we fit a Bayesian random effects model using the <code>brms</code>
package<span class="citation"><sup>23</sup></span> with appropriate
priors.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># merge si_data and result_norm_wide for plotting</span></span>
<span><span class="va">df_merged</span> <span class="op">&lt;-</span> <span class="va">si_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">study</span>, <span class="va">icc_interval</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">result_norm_wide</span>, by <span class="op">=</span> <span class="st">"study"</span>, relationship <span class="op">=</span> <span class="st">"many-to-many"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform a Bayesian meta-analysis</span></span>
<span><span class="va">df_ma</span> <span class="op">&lt;-</span> <span class="va">df_merged</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">study</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>se <span class="op">=</span> <span class="va">sd</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">study</span>, <span class="va">n</span>, <span class="va">mean</span>, <span class="va">sd</span>, <span class="va">se</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># we will perform a Bayesian meta-analysis using the {brms} package</span></span>
<span><span class="co"># specify priors</span></span>
<span><span class="va">priors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">prior</span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">100</span>,<span class="fl">50</span><span class="op">)</span>, class <span class="op">=</span> <span class="va">Intercept</span><span class="op">)</span>,</span>
<span>            <span class="fu">prior</span><span class="op">(</span><span class="fu">cauchy</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, class <span class="op">=</span> <span class="va">sd</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit a random effects model</span></span>
<span><span class="va">m.brm</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  <span class="va">mean</span> <span class="op">|</span> <span class="fu">se</span><span class="op">(</span><span class="va">se</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">study</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df_ma</span>,</span>
<span>  prior <span class="op">=</span> <span class="va">priors</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">8000</span>, </span>
<span>  warmup <span class="op">=</span> <span class="fl">4000</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.999</span>, max_treedepth <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> </span>
<span><span class="op">)</span></span></code></pre></div>
<p>This code creates a hierarchical model where study-specific means are
treated as random effects around a global mean. The <code>prior()</code>
function specifies our prior beliefs about the pooled mean (normal
distribution centered at 100 days) and between-study heterogeneity
(Cauchy distribution). The model is fitted with 8,000 iterations (4,000
for warmup) and adjusted control parameters to ensure stable MCMC
sampling.</p>
</div>
</div>
<div class="section level3">
<h3 id="growth-rate-and-basic-reproduction-number-r_0">Growth Rate and Basic Reproduction Number
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>)<a class="anchor" aria-label="anchor" href="#growth-rate-and-basic-reproduction-number-r_0"></a>
</h3>
<div class="section level4">
<h4 id="growth-rate">Growth Rate<a class="anchor" aria-label="anchor" href="#growth-rate"></a>
</h4>
<p>To estimate the growth rate of scabies cases, we fit a generalized
linear model (GLM) with a log link and quasipoisson error structure to
account for overdispersion in the count data. The following code loads
annual incidence data, prepares it for modeling, fits the exponential
growth model, and calculates confidence intervals for both the model
parameters and fitted values.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># read in data set</span></span>
<span><span class="va">file_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"data/scabies_data_incidence_yearly.xlsx"</span>, </span>
<span>                         package <span class="op">=</span> <span class="st">"mitey"</span><span class="op">)</span></span>
<span><span class="va">scabies_inc_total</span> <span class="op">&lt;-</span> <span class="fu">read.xlsx</span><span class="op">(</span><span class="va">file_path</span>, sheet <span class="op">=</span> <span class="st">"total"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># some data wrangling to make the column names nicer</span></span>
<span><span class="va">scabies_inc_total</span> <span class="op">&lt;-</span> <span class="va">scabies_inc_total</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>inc <span class="op">=</span> <span class="va">`Inc.per.1.000`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cases <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">inc</span><span class="op">)</span>,</span>
<span>         time <span class="op">=</span> <span class="va">Year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"cases"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">scabies_inc_total</span> <span class="op">&lt;-</span> <span class="va">scabies_inc_total</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">cases</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.infinite</a></span><span class="op">(</span><span class="va">cases</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.infinite</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit an exponential model with Poisson errors</span></span>
<span><span class="va">poisson_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">cases</span> <span class="op">~</span> <span class="va">time</span>, </span>
<span>                     family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">quasipoisson</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span>, </span>
<span>                     data <span class="op">=</span> <span class="va">scabies_inc_total</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate 95% confidence intervals for the model parameters</span></span>
<span><span class="va">ci_coeff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">poisson_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Fit to the original data ##</span></span>
<span></span>
<span><span class="co"># Calculate the fitted values on the linear scale (log scale)</span></span>
<span><span class="va">fitted_values_log</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">poisson_model</span>, newdata <span class="op">=</span> <span class="va">scabies_inc_total</span>, type <span class="op">=</span> <span class="st">"link"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get the standard errors of the fitted values</span></span>
<span><span class="va">se_fitted_log</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">poisson_model</span>, newdata <span class="op">=</span> <span class="va">scabies_inc_total</span>, type <span class="op">=</span> <span class="st">"link"</span>, se.fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">se.fit</span></span>
<span></span>
<span><span class="co"># Get the dispersion parameter (phi) from the quasipoisson model</span></span>
<span><span class="va">phi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">poisson_model</span><span class="op">)</span><span class="op">$</span><span class="va">dispersion</span></span>
<span></span>
<span><span class="co"># Adjust the standard errors by the dispersion parameter</span></span>
<span><span class="va">se_fitted_log_adjusted</span> <span class="op">&lt;-</span> <span class="va">se_fitted_log</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">phi</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate the confidence intervals for the fitted values on the log scale</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span><span class="va">z_value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>  <span class="co"># Z-value for 95% CI</span></span>
<span></span>
<span><span class="va">lower_log</span> <span class="op">&lt;-</span> <span class="va">fitted_values_log</span> <span class="op">-</span> <span class="va">z_value</span> <span class="op">*</span> <span class="va">se_fitted_log_adjusted</span></span>
<span><span class="va">upper_log</span> <span class="op">&lt;-</span> <span class="va">fitted_values_log</span> <span class="op">+</span> <span class="va">z_value</span> <span class="op">*</span> <span class="va">se_fitted_log_adjusted</span></span>
<span></span>
<span><span class="co"># Add these confidence intervals to the data frame</span></span>
<span><span class="va">scabies_inc_total</span><span class="op">$</span><span class="va">fitted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">fitted_values_log</span><span class="op">)</span></span>
<span><span class="va">scabies_inc_total</span><span class="op">$</span><span class="va">lower_fitted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lower_log</span><span class="op">)</span></span>
<span><span class="va">scabies_inc_total</span><span class="op">$</span><span class="va">upper_fitted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">upper_log</span><span class="op">)</span></span></code></pre></div>
<p>The code first extracts fitted values on the log scale, then
calculates standard errors adjusted by the dispersion parameter to
account for overdispersion. We then compute confidence intervals on the
log scale and transform back to the original scale using the exponential
function. This approach ensures appropriate uncertainty representation
in our incidence projections.</p>
<!-- To project future scabies incidence, we extend our fitted model to predict incidence for the next 10 years. The code below creates a sequence of future time points, applies our model to generate predictions, and calculates prediction intervals that incorporate both parameter uncertainty and the overdispersion observed in the data. -->
<!-- The resulting data frame combines observed data (labeled as 'Original Data') with extrapolated predictions (labeled as 'Extrapolated Data'), including upper and lower confidence bounds for both. This structure allows for seamless visualization of historical trends and future projections in a single plot. -->
</div>
<div class="section level4">
<h4 id="basic-reproduction-number-r_0">Basic Reproduction Number
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>)<a class="anchor" aria-label="anchor" href="#basic-reproduction-number-r_0"></a>
</h4>
<p>Using the estimated annual growth rate, we can estimate the basic
reproduction number as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>0</mn></msub><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><mo>*</mo><mi>T</mi><mi>–</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mi>/</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>r</mi><mn>2</mn></msup><msup><mi>s</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">R_0 = \exp(r*T – (1/2) r^2 s^2)</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>
is the annual growth rate,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>
is the mean generation time (in years), and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>s</mi><mn>2</mn></msup><annotation encoding="application/x-tex">s^2</annotation></semantics></math>
is the variance of the generation time distribution<span class="citation"><sup>24</sup></span>. We assume that nearly everyone
exposed has not been previously infected.</p>
</div>
</div>
<div class="section level3">
<h3 id="time-varying-reproduction-number">Time-varying Reproduction Number<a class="anchor" aria-label="anchor" href="#time-varying-reproduction-number"></a>
</h3>
<p>Estimating the time-varying reproduction number begins with preparing
the daily incidence data. Since the available data consists of weekly
consultation counts, we distribute these counts across the days of each
week using random assignment. This approach creates a daily time series
while preserving the weekly totals. Since scabies is very hard to
diagnose prior to symptom onset<span class="citation"><sup>25</sup></span>, and scabies consultations are
captured as part of sentinel surveillance based on GP consultations<span class="citation"><sup>26</sup></span>, we use the date of consultation
rather than the date of symptom onset.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># read in consultations data </span></span>
<span><span class="va">file_path2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"data/scabies_data_consultations_weekly.xlsx"</span>, </span>
<span>                          package <span class="op">=</span> <span class="st">"mitey"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nivel_wkly_data</span> <span class="op">&lt;-</span> <span class="fu">read.xlsx</span><span class="op">(</span><span class="va">file_path2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># fix/translate variable names</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>diagnosis_code <span class="op">=</span> <span class="va">`Diagnose.(ICPC)`</span>,</span>
<span>         year <span class="op">=</span> <span class="va">`ISO-jaar`</span>,</span>
<span>         week_num <span class="op">=</span> <span class="va">`ISO-weeknr.(ma-zo)`</span>,</span>
<span>         pop_size <span class="op">=</span> <span class="va">`Aantal.populatie`</span>,</span>
<span>         cases <span class="op">=</span> <span class="va">`Aantal.prevalente.cases`</span>,</span>
<span>         prev_per_100000 <span class="op">=</span> <span class="va">`Prevalentie.per.100.000`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># drop diagnosis var</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">diagnosis_code</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># create new var that combines year and week</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>yr_wk <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">week_num</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span>,</span>
<span>         year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nivel_daily_data</span> <span class="op">&lt;-</span> <span class="va">nivel_wkly_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/uncount.html" class="external-link">uncount</a></span><span class="op">(</span><span class="va">cases</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Repeat rows based on the number of cases</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    iso_week <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">year</span>, <span class="st">"-W"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%02d"</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">week_num</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    first_day <span class="op">=</span> <span class="fu">ISOweek2date</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">iso_week</span>, <span class="st">"-1"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    random_day <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">6</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    onset_date <span class="op">=</span> <span class="va">first_day</span> <span class="op">+</span> <span class="fu">days</span><span class="op">(</span><span class="va">random_day</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">iso_week</span>, <span class="op">-</span><span class="va">first_day</span>, <span class="op">-</span><span class="va">random_day</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Group data by onset_date and calculate the daily incidence</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">nivel_daily_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">onset_date</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>count <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="va">onset_date</span>, <span class="va">count</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">onset_date</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>num_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">onset_date</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>inc <span class="op">=</span> <span class="va">count</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">onset_date</span>, <span class="va">inc</span><span class="op">)</span></span></code></pre></div>
<p>The code above transforms weekly data into daily incidence by: (1)
duplicating each row based on the number of cases, (2) converting ISO
week numbers to calendar dates, (3) randomly assigning cases to days
within their respective weeks, and (4) aggregating by date to obtain
daily case counts. This daily time series serves as input for the
Wallinga-Lipsitch method<span class="citation"><sup>24</sup></span>.</p>
<p>The following code applies the Wallinga-Lipsitch method to estimate
the time-varying reproduction number. We specify the serial interval
distribution (mean = 123 days, SD = 31 days) based on our meta-analysis,
and generate bootstrap samples to quantify uncertainty. The results
include both raw estimates and values adjusted for right truncation.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Parameters for scabies serial interval</span></span>
<span><span class="va">scabies_si_mean</span> <span class="op">&lt;-</span> <span class="fl">123</span>  <span class="co"># days</span></span>
<span><span class="va">scabies_si_sd</span> <span class="op">&lt;-</span> <span class="fl">31</span>     <span class="co"># days</span></span>
<span></span>
<span><span class="co"># Estimate Rt with appropriate smoothing for weekly data</span></span>
<span><span class="va">rt_scabies</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wallinga_lipsitch.html">wallinga_lipsitch</a></span><span class="op">(</span></span>
<span>  incidence <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">inc</span>,</span>
<span>  dates <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">onset_date</span>,</span>
<span>  si_mean <span class="op">=</span> <span class="va">scabies_si_mean</span>,</span>
<span>  si_sd <span class="op">=</span> <span class="va">scabies_si_sd</span>,</span>
<span>  si_dist <span class="op">=</span> <span class="st">"normal"</span>, </span>
<span>  smoothing <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  bootstrap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_bootstrap <span class="op">=</span> <span class="fl">500</span> </span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#saveRDS(rt_scabies, "vignettes/data/rt_estimates_WL.rds")</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="software-implementation-and-validation">Software Implementation and Validation<a class="anchor" aria-label="anchor" href="#software-implementation-and-validation"></a>
</h3>
<p>To ensure the reproducibility and reliability of our epidemiological
analyses, we developed the R package {mitey}, which implements the
methods described in this manuscript. Rigorous validation of both the
serial interval estimation and reproduction number calculation functions
was performed using simulated data with known parameters and historical
datasets from other infectious diseases.</p>
<div class="section level4">
<h4 id="serial-interval-1">Serial Interval<a class="anchor" aria-label="anchor" href="#serial-interval-1"></a>
</h4>
<pre><code><span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt; [1] 15.16373</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sd</span></span>
<span><span class="co">#&gt; [1] 2.823293</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $wts</span></span>
<span><span class="co">#&gt; [1] 2.113966e-01 4.841131e-01 7.836824e-09 2.021913e-01 3.062666e-15</span></span>
<span><span class="co">#&gt; [6] 1.022991e-01 1.368660e-21</span></span></code></pre>
<pre><code><span><span class="co">#&gt; `summarise()` has grouped output by 'Author', 'Pathogen'. You can override</span></span>
<span><span class="co">#&gt; using the `.groups` argument.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 13</span></span></span>
<span><span class="co">#&gt;   Author Pathogen Country ICC_interval  mean    sd weight_1 weight_2  weight_3</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Aaby   Measles  Kenya              0  9.93  2.40    0.364    0.512 0.000<span style="text-decoration: underline;">010</span>6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Aaby   Measles  Kenya              0  9.93  2.40    0.364    0.512 0.000<span style="text-decoration: underline;">010</span>6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Aaby   Measles  Kenya              0  9.93  2.40    0.364    0.512 0.000<span style="text-decoration: underline;">010</span>6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Aaby   Measles  Kenya              0  9.93  2.40    0.364    0.512 0.000<span style="text-decoration: underline;">010</span>6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Aaby   Measles  Kenya              0  9.93  2.40    0.364    0.512 0.000<span style="text-decoration: underline;">010</span>6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Aaby   Measles  Kenya              0  9.93  2.40    0.364    0.512 0.000<span style="text-decoration: underline;">010</span>6</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 4 more variables: weight_4 &lt;dbl&gt;, weight_5 &lt;dbl&gt;, weight_6 &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   weight_7 &lt;dbl&gt;</span></span></span></code></pre>
</div>
<div class="section level4">
<h4 id="time-varying-reproduction-number-1">Time-varying Reproduction Number<a class="anchor" aria-label="anchor" href="#time-varying-reproduction-number-1"></a>
</h4>
<div class="section level5">
<h5 id="simulated-data">Simulated Data<a class="anchor" aria-label="anchor" href="#simulated-data"></a>
</h5>
<pre><code><span><span class="co">#&gt;         date incidence        R R_corrected  R_lower  R_upper R_corrected_lower</span></span>
<span><span class="co">#&gt; 1 2023-01-01       500 1.513819    1.513819 1.400246 1.640943          1.400246</span></span>
<span><span class="co">#&gt; 2 2023-01-02         3 1.507403    1.507403 1.402781 1.620427          1.402781</span></span>
<span><span class="co">#&gt; 3 2023-01-03        56 1.510453    1.510453 1.409458 1.624172          1.409458</span></span>
<span><span class="co">#&gt; 4 2023-01-04       137 1.502045    1.502045 1.410784 1.606036          1.410784</span></span>
<span><span class="co">#&gt; 5 2023-01-05       145 1.478686    1.478686 1.394027 1.575553          1.394027</span></span>
<span><span class="co">#&gt; 6 2023-01-06       179 1.474034    1.474034 1.391377 1.566991          1.391377</span></span>
<span><span class="co">#&gt;   R_corrected_upper true_r</span></span>
<span><span class="co">#&gt; 1          1.640943    1.5</span></span>
<span><span class="co">#&gt; 2          1.620427    1.5</span></span>
<span><span class="co">#&gt; 3          1.624172    1.5</span></span>
<span><span class="co">#&gt; 4          1.606036    1.5</span></span>
<span><span class="co">#&gt; 5          1.575553    1.5</span></span>
<span><span class="co">#&gt; 6          1.566991    1.5</span></span></code></pre>
</div>
<div class="section level5">
<h5 id="zika">Zika<a class="anchor" aria-label="anchor" href="#zika"></a>
</h5>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res_zika</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wallinga_lipsitch.html">wallinga_lipsitch</a></span><span class="op">(</span></span>
<span>  incidence <span class="op">=</span> <span class="va">zika2015</span><span class="op">$</span><span class="va">incidence</span>,</span>
<span>  dates <span class="op">=</span> <span class="va">zika2015</span><span class="op">$</span><span class="va">date</span>,</span>
<span>  si_mean <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  si_sd <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  si_dist <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>  smoothing <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  bootstrap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_bootstrap <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  conf_level <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">si_zika</span> <span class="op">&lt;-</span> <span class="fu">Idist</span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">7</span>, sd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="va">epifit_zika</span> <span class="op">&lt;-</span> <span class="fu">estimR</span><span class="op">(</span><span class="va">zika2015</span><span class="op">$</span><span class="va">incidence</span>, dates <span class="op">=</span> <span class="va">zika2015</span><span class="op">$</span><span class="va">dates</span>, si <span class="op">=</span> <span class="va">si_zika</span><span class="op">$</span><span class="va">pvec</span>, WTR <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="influenza-h7n9">Influenza H7N9<a class="anchor" aria-label="anchor" href="#influenza-h7n9"></a>
</h5>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">h7n9_data</span> <span class="op">&lt;-</span> <span class="va">fluH7N9_china_2013</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>date_onset <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="va">date_of_onset</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">date_onset</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  <span class="co"># Remove cases with missing onset date</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">date_onset</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>cases <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">date_onset</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a complete time series with zeros for days with no cases</span></span>
<span><span class="va">date_range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">h7n9_data</span><span class="op">$</span><span class="va">date_onset</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">h7n9_data</span><span class="op">$</span><span class="va">date_onset</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"day"</span><span class="op">)</span></span>
<span><span class="va">h7n9_complete</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>date_onset <span class="op">=</span> <span class="va">date_range</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">h7n9_data</span>, by <span class="op">=</span> <span class="st">"date_onset"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>cases <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">cases</span><span class="op">)</span>, <span class="fl">0</span>, <span class="va">cases</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Estimate Rt</span></span>
<span><span class="va">res_h7n9</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wallinga_lipsitch.html">wallinga_lipsitch</a></span><span class="op">(</span></span>
<span>  incidence <span class="op">=</span> <span class="va">h7n9_complete</span><span class="op">$</span><span class="va">cases</span>,</span>
<span>  dates <span class="op">=</span> <span class="va">h7n9_complete</span><span class="op">$</span><span class="va">date_onset</span>,</span>
<span>  si_mean <span class="op">=</span> <span class="fl">8.1</span>,</span>
<span>  si_sd <span class="op">=</span> <span class="fl">3.4</span>,</span>
<span>  si_dist <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>  smoothing <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  bootstrap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_bootstrap <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  conf_level <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">si_h7n9</span> <span class="op">&lt;-</span> <span class="fu">Idist</span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">8.1</span>, sd <span class="op">=</span> <span class="fl">3.4</span><span class="op">)</span></span>
<span><span class="va">epifit_h7n9</span> <span class="op">&lt;-</span> <span class="fu">estimR</span><span class="op">(</span><span class="va">h7n9_complete</span><span class="op">$</span><span class="va">cases</span>, dates <span class="op">=</span> <span class="va">h7n9_complete</span><span class="op">$</span><span class="va">date_onset</span>, si <span class="op">=</span> <span class="va">si_h7n9</span><span class="op">$</span><span class="va">pvec</span>, WTR <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<p>This section presents the code to reproduce the figures and tables.
First, we’ll define a common theme to make figure more uniform.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set a consistent theme for all plots</span></span>
<span><span class="va">theme_scabies</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>      panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>      panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"gray95"</span><span class="op">)</span>,</span>
<span>      plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span>, face <span class="op">=</span> <span class="st">"bold"</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>      axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>      axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,</span>
<span>      legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>      legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,</span>
<span>      legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>      legend.key.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="st">"lines"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level3">
<h3 id="serial-interval-2">Serial Interval<a class="anchor" aria-label="anchor" href="#serial-interval-2"></a>
</h3>
<p>Table 1 shows the estimates of the mean and standard deviation of the
serial interval for each study.</p>
<div id="fqwrvlkvws" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#fqwrvlkvws table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#fqwrvlkvws thead, #fqwrvlkvws tbody, #fqwrvlkvws tfoot, #fqwrvlkvws tr, #fqwrvlkvws td, #fqwrvlkvws th {
  border-style: none;
}

#fqwrvlkvws p {
  margin: 0;
  padding: 0;
}

#fqwrvlkvws .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 100%;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#fqwrvlkvws .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#fqwrvlkvws .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#fqwrvlkvws .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#fqwrvlkvws .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fqwrvlkvws .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fqwrvlkvws .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#fqwrvlkvws .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#fqwrvlkvws .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#fqwrvlkvws .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#fqwrvlkvws .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#fqwrvlkvws .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#fqwrvlkvws .gt_spanner_row {
  border-bottom-style: hidden;
}

#fqwrvlkvws .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#fqwrvlkvws .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#fqwrvlkvws .gt_from_md > :first-child {
  margin-top: 0;
}

#fqwrvlkvws .gt_from_md > :last-child {
  margin-bottom: 0;
}

#fqwrvlkvws .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#fqwrvlkvws .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#fqwrvlkvws .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#fqwrvlkvws .gt_row_group_first td {
  border-top-width: 2px;
}

#fqwrvlkvws .gt_row_group_first th {
  border-top-width: 2px;
}

#fqwrvlkvws .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fqwrvlkvws .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#fqwrvlkvws .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#fqwrvlkvws .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fqwrvlkvws .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#fqwrvlkvws .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#fqwrvlkvws .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#fqwrvlkvws .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#fqwrvlkvws .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#fqwrvlkvws .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fqwrvlkvws .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fqwrvlkvws .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#fqwrvlkvws .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#fqwrvlkvws .gt_left {
  text-align: left;
}

#fqwrvlkvws .gt_center {
  text-align: center;
}

#fqwrvlkvws .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#fqwrvlkvws .gt_font_normal {
  font-weight: normal;
}

#fqwrvlkvws .gt_font_bold {
  font-weight: bold;
}

#fqwrvlkvws .gt_font_italic {
  font-style: italic;
}

#fqwrvlkvws .gt_super {
  font-size: 65%;
}

#fqwrvlkvws .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#fqwrvlkvws .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#fqwrvlkvws .gt_indent_1 {
  text-indent: 5px;
}

#fqwrvlkvws .gt_indent_2 {
  text-indent: 10px;
}

#fqwrvlkvws .gt_indent_3 {
  text-indent: 15px;
}

#fqwrvlkvws .gt_indent_4 {
  text-indent: 20px;
}

#fqwrvlkvws .gt_indent_5 {
  text-indent: 25px;
}

#fqwrvlkvws .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#fqwrvlkvws div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-top-width: 1px; border-top-style: solid; border-top-color: #000000; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;" scope="col" id="study">Study</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 1px; border-top-style: solid; border-top-color: #000000; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;" scope="col" id="mean">Mean</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 1px; border-top-style: solid; border-top-color: #000000; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;" scope="col" id="sd">Standard Deviation</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="study" class="gt_row gt_left">Akunzirwe et al.</td>
<td headers="mean" class="gt_row gt_right">122.92</td>
<td headers="sd" class="gt_row gt_right">26.92</td>
</tr>
<tr>
<td headers="study" class="gt_row gt_left">Ariza et al.</td>
<td headers="mean" class="gt_row gt_right">98.40</td>
<td headers="sd" class="gt_row gt_right">8.54</td>
</tr>
<tr>
<td headers="study" class="gt_row gt_left">Kaburi et al.</td>
<td headers="mean" class="gt_row gt_right">167.34</td>
<td headers="sd" class="gt_row gt_right">9.72</td>
</tr>
<tr>
<td headers="study" class="gt_row gt_left" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">Tjon-Kon-Fat et al</td>
<td headers="mean" class="gt_row gt_right" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">110.72</td>
<td headers="sd" class="gt_row gt_right" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">16.14</td>
</tr>
</tbody>
</table>
</div>
<p>To visualize the serial interval distributions, we use the
<code><a href="../reference/plot_si_fit.html">plot_si_fit()</a></code> function from the <code>mitey</code> package.
This creates histograms of the observed ICC intervals with overlaid
mixture density curves.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># merge si_data and result_norm_wide for plotting</span></span>
<span><span class="va">df_merged</span> <span class="op">&lt;-</span> <span class="va">si_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">study</span>, <span class="va">icc_interval</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">result_norm_wide</span>, by <span class="op">=</span> <span class="st">"study"</span>, relationship <span class="op">=</span> <span class="st">"many-to-many"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply the plot_si_fit function by study</span></span>
<span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="va">df_merged</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">study</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_map.html" class="external-link">group_map</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="../reference/plot_si_fit.html">plot_si_fit</a></span><span class="op">(</span></span>
<span>    dat <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">icc_interval</span>,</span>
<span>    mean <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    sd <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">sd</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">.x</span><span class="op">$</span><span class="va">weight_1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">.x</span><span class="op">$</span><span class="va">weight_2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">.x</span><span class="op">$</span><span class="va">weight_3</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                <span class="va">.x</span><span class="op">$</span><span class="va">weight_4</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">.x</span><span class="op">$</span><span class="va">weight_5</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">.x</span><span class="op">$</span><span class="va">weight_6</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">.x</span><span class="op">$</span><span class="va">weight_7</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    dist <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>    scaling_factor <span class="op">=</span> <span class="fl">0.25</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Annotate plots with study names and labels</span></span>
<span><span class="co"># Find the order of the groups</span></span>
<span><span class="va">group_order</span> <span class="op">&lt;-</span> <span class="va">df_merged</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">study</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_data.html" class="external-link">group_keys</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">labeled_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">plots</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">plots</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="va">group_order</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">theme_scabies</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"ICC Interval (days)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine plots into a multi-pane figure</span></span>
<span><span class="va">final_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span></span>
<span>  plotlist <span class="op">=</span> <span class="va">labeled_plots</span>,</span>
<span>  labels <span class="op">=</span> <span class="st">"AUTO"</span>,      <span class="co"># Automatically adds labels (A, B, C, etc.)</span></span>
<span>  label_size <span class="op">=</span> <span class="fl">14</span>,      <span class="co"># Size of the labels</span></span>
<span>  ncol <span class="op">=</span> <span class="fl">2</span>              <span class="co"># Number of columns; adjust as needed</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>We also want to plot the posterior distributions from our
meta-analysis and combine it with the fitted mixture density plots
above. We’ll plot the posterior distributions in a forest plot. The
forest plot displays posterior distributions from our meta-analysis. We
first extract posterior draws for study-specific and pooled effects
using <code><a href="https://mjskay.github.io/tidybayes/reference/spread_draws.html" class="external-link">tidybayes::spread_draws()</a></code>. Then we create density
ridges showing the full posterior distributions alongside point
estimates and credible intervals.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># get posterior draws from each study</span></span>
<span><span class="va">study.draws</span> <span class="op">&lt;-</span> <span class="fu">spread_draws</span><span class="op">(</span><span class="va">m.brm</span>, <span class="va">r_study</span><span class="op">[</span><span class="va">study</span>,<span class="op">]</span>, <span class="va">b_Intercept</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>b_Intercept <span class="op">=</span> <span class="va">r_study</span> <span class="op">+</span> <span class="va">b_Intercept</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get pooled posterior draws</span></span>
<span><span class="va">pooled.effect.draws</span> <span class="op">&lt;-</span> <span class="fu">spread_draws</span><span class="op">(</span><span class="va">m.brm</span>, <span class="va">b_Intercept</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>study <span class="op">=</span> <span class="st">"Pooled Effect"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># combine posterior draws from each study and pooled</span></span>
<span><span class="va">forest.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">study.draws</span>,</span>
<span>                         <span class="va">pooled.effect.draws</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>study <span class="op">=</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">study</span>, <span class="st">"[.]"</span>, <span class="st">" "</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>study <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">study</span>, <span class="va">b_Intercept</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate mean and credible intervals</span></span>
<span><span class="va">forest.data.summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">forest.data</span>, <span class="va">study</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">mean_qi</span><span class="op">(</span><span class="va">b_Intercept</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot</span></span>
<span><span class="va">forest_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">b_Intercept</span>, </span>
<span>                          <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html" class="external-link">relevel</a></span><span class="op">(</span><span class="va">study</span>, <span class="st">"Pooled Effect"</span>, after <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>                          fill <span class="op">=</span> <span class="va">study</span><span class="op">)</span>,</span>
<span>                      data <span class="op">=</span> <span class="va">forest.data</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu">fixef</span><span class="op">(</span><span class="va">m.brm</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"gray"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu">fixef</span><span class="op">(</span><span class="va">m.brm</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"gray"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Use geom_density_ridges without stat="identity"</span></span>
<span>  <span class="fu">geom_density_ridges</span><span class="op">(</span>rel_min_height <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>                     col <span class="op">=</span> <span class="cn">NA</span>, scale <span class="op">=</span> <span class="fl">1.2</span>,</span>
<span>                     alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_pointinterval</span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">study</span>,</span>
<span>                       x <span class="op">=</span> <span class="va">b_Intercept</span>,</span>
<span>                       xmin <span class="op">=</span> <span class="va">.lower</span>,</span>
<span>                       xmax <span class="op">=</span> <span class="va">.upper</span><span class="op">)</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">forest.data.summary</span>,</span>
<span>                   size <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>                   orientation <span class="op">=</span> <span class="st">"horizontal"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Mean Serial Interval (days)"</span>, y <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Hide the y-axis text</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_y_discrete</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">forest.data</span><span class="op">$</span><span class="va">study</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>                   <span class="st">"#E69F00"</span>, <span class="co"># Orange</span></span>
<span>                   <span class="st">"#9932CC"</span>, <span class="co"># Dark Orchid (purple)</span></span>
<span>                   <span class="st">"#009E73"</span>, <span class="co"># Bluish Green  </span></span>
<span>                   <span class="st">"#DC143C"</span>, <span class="co"># Crimson (red)</span></span>
<span>                   <span class="st">"#0072B2"</span>  <span class="co"># Blue</span></span>
<span>                 <span class="op">)</span>,</span>
<span>                 name <span class="op">=</span> <span class="st">"Study"</span>,</span>
<span>                 guide <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html" class="external-link">guide_legend</a></span><span class="op">(</span></span>
<span>                   title.position <span class="op">=</span> <span class="st">"top"</span>, </span>
<span>                   direction <span class="op">=</span> <span class="st">"vertical"</span>,</span>
<span>                   keyheight <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>                   keywidth <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>                   title.hjust <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>                   label.hjust <span class="op">=</span> <span class="fl">0</span></span>
<span>                 <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_scabies</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    panel.grid.major.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.41</span>, <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>    legend.justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"right"</span>, <span class="st">"top"</span><span class="op">)</span>,</span>
<span>    legend.box.just <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>    legend.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">6</span>, <span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>,</span>
<span>    legend.key.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="st">"lines"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> </span></code></pre></div>
<p>Now let’s combine the two plots.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">fig1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">final_plot</span>, <span class="va">forest_plot</span>, </span>
<span>                  ncol <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                  rel_widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="fl">0.9</span><span class="op">)</span>,</span>
<span>                  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"E"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Picking joint bandwidth of 0.591</span></span>
<span><span class="va">fig1</span></span></code></pre></div>
<div class="figure">
<img src="reproduce_results_ainslie_et_al_files/figure-html/fig1-1.png" alt="Figure 1. A-D) Model fits of the serial interval to index case–to–case (ICC) interval data. Each histogram shows the distribution of observed ICC intervals for scabies outbreaks described in A) Akunzirwe et al., B) Ariza et al., C) Kaburi et al., D) Tjon-Kon-Fat et al. The overlayed red line shows the estimated mixture density for each infection. The dashed vertical line indicates the mean serial interval. The value of the mean serial interval is shown to the right of the dashed line along the x-axis. E) Forest plot of the estimated mean serial interval (in days) for individual studies and the pooled effect. The posterior distributions for each study are shown as density ridges, with the pooled effect displayed at the bottom. Black points and horizontal lines represent the posterior mean and corresponding 95% credible intervals for each study and the pooled estimate. The solid vertical gray line indicates the pooled effect estimate, while the dashed gray lines represent its 95% credible interval." width="700" id="fig-fig1-1"><p class="caption">
Figure 1. A-D) Model fits of the serial interval to index case–to–case
(ICC) interval data. Each histogram shows the distribution of observed
ICC intervals for scabies outbreaks described in A) Akunzirwe et al., B)
Ariza et al., C) Kaburi et al., D) Tjon-Kon-Fat et al. The overlayed red
line shows the estimated mixture density for each infection. The dashed
vertical line indicates the mean serial interval. The value of the mean
serial interval is shown to the right of the dashed line along the
x-axis. E) Forest plot of the estimated mean serial interval (in days)
for individual studies and the pooled effect. The posterior
distributions for each study are shown as density ridges, with the
pooled effect displayed at the bottom. Black points and horizontal lines
represent the posterior mean and corresponding 95% credible intervals
for each study and the pooled estimate. The solid vertical gray line
indicates the pooled effect estimate, while the dashed gray lines
represent its 95% credible interval.
</p>
</div>
<!-- ## Growth Rate -->
<!-- Our growth rate visualization shows both observed data points and model projections on a logarithmic scale. Different colors distinguish historical data from extrapolated predictions, and shaded regions represent confidence intervals. -->
</div>
<div class="section level3">
<h3 id="time-varying-reproduction-number-2">Time-varying Reproduction Number<a class="anchor" aria-label="anchor" href="#time-varying-reproduction-number-2"></a>
</h3>
<p>First, we visualised the number of GP consultations over time for
scabies.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scabies_epicurve</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">onset_date</span>, y <span class="op">=</span> <span class="va">inc</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#geom_smooth(method = "loess", color = "red", se = FALSE) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 year"</span>, date_labels <span class="op">=</span> <span class="st">"%Y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Date of Consultation"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Consultations"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_scabies</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Next, we estimated the time-varying reproduction number using number
of consultations over time.
<img src="reproduce_results_ainslie_et_al_files/figure-html/plot_rt_simple-1.png" width="100%"></p>
<p>Finally, we examined the timing of the peaks in transmission relative
to season of the year (in the Northern Hemisphere).</p>
<pre><code><span><span class="co">#&gt; Warning: Removed 124 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_line()`).</span></span></code></pre>
<p><img src="reproduce_results_ainslie_et_al_files/figure-html/rt_plot_w_seasons-1.png" width="700"></p>
<p>Now we’ll combine the plots to recreate the manuscript figure.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fig3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">scabies_epicurve</span>, <span class="va">rt_seasonal</span>, </span>
<span>                  nrow <span class="op">=</span> <span class="fl">2</span>, rel_heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>                  labels <span class="op">=</span> <span class="st">"AUTO"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 124 rows containing missing values or values outside the scale range</span></span>
<span><span class="co">#&gt; (`geom_line()`).</span></span>
<span><span class="va">fig3</span></span></code></pre></div>
<div class="figure">
<img src="reproduce_results_ainslie_et_al_files/figure-html/fig3-1.png" alt="Figure 3. A) Number of general practitioner (GP) consultations for scabies per week per 100,000 people in the Netherlands by date of consultation. B) Time-varying case reproduction number of scabies transmission. Colored bands denote season. Winter = December 1 – February 28 (or 29 on leap year); Spring = March 1 – May 31; Summer = June 1 – August 31; Autumn = September 1 – November 31. Shaded region represents the 95% confidence envelope. Red horizontal dashed line indicates R = 1." width="700"><p class="caption">
Figure 3. A) Number of general practitioner (GP) consultations for
scabies per week per 100,000 people in the Netherlands by date of
consultation. B) Time-varying case reproduction number of scabies
transmission. Colored bands denote season. Winter = December 1 –
February 28 (or 29 on leap year); Spring = March 1 – May 31; Summer =
June 1 – August 31; Autumn = September 1 – November 31. Shaded region
represents the 95% confidence envelope. Red horizontal dashed line
indicates R = 1.
</p>
</div>
</div>
<div class="section level3">
<h3 id="software-implementation-and-validation-1">Software Implementation and Validation<a class="anchor" aria-label="anchor" href="#software-implementation-and-validation-1"></a>
</h3>
<p>The reliability of our analytical methods is demonstrated through
validation against synthetic data with known parameters and comparison
with established packages. The following code creates visualizations
showing how our implementations compare to true values and alternative
estimation approaches. These validation plots confirm the accuracy of
our <code>mitey</code> package functions.</p>
<div class="section level4">
<h4 id="serial-interval-3">Serial Interval<a class="anchor" aria-label="anchor" href="#serial-interval-3"></a>
</h4>
<p>Plot the results using synthetic data</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fig4A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_si_fit.html">plot_si_fit</a></span><span class="op">(</span></span>
<span>    dat <span class="op">=</span> <span class="va">sim_data</span>,</span>
<span>    mean <span class="op">=</span> <span class="va">res_si_sim</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    sd <span class="op">=</span> <span class="va">res_si_sim</span><span class="op">$</span><span class="va">sd</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">res_si_sim</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">res_si_sim</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">res_si_sim</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>                <span class="va">res_si_sim</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">+</span> <span class="va">res_si_sim</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, <span class="va">res_si_sim</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span> <span class="op">+</span> <span class="va">res_si_sim</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    dist <span class="op">=</span> <span class="st">"normal"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">hmu</span>, color <span class="op">=</span> <span class="st">"blue"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, linewidth <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Synthetic data"</span><span class="op">)</span> <span class="op">+</span>          </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>        axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span> </span></code></pre></div>
<p>Plot the results using historical data</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="va">res_si_hist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Author</span>, <span class="va">Pathogen</span>, <span class="va">Country</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_map.html" class="external-link">group_map</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="../reference/plot_si_fit.html">plot_si_fit</a></span><span class="op">(</span></span>
<span>    dat <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">ICC_interval</span>,</span>
<span>    mean <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    sd <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">sd</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">.x</span><span class="op">$</span><span class="va">weight_1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">.x</span><span class="op">$</span><span class="va">weight_2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">.x</span><span class="op">$</span><span class="va">weight_3</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                <span class="va">.x</span><span class="op">$</span><span class="va">weight_4</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">.x</span><span class="op">$</span><span class="va">weight_5</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">.x</span><span class="op">$</span><span class="va">weight_6</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">.x</span><span class="op">$</span><span class="va">weight_7</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    dist <span class="op">=</span> <span class="st">"normal"</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Annotate plots with study names and labels</span></span>
<span><span class="co"># Find the order of the groups</span></span>
<span><span class="va">group_order</span> <span class="op">&lt;-</span> <span class="va">res_si_hist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Author</span>, <span class="va">Pathogen</span>, <span class="va">Country</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_data.html" class="external-link">group_keys</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">labeled_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">plots</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">plots</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">group_order</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">group_order</span><span class="op">[</span><span class="va">i</span>,<span class="fl">2</span><span class="op">]</span>, <span class="va">group_order</span><span class="op">[</span><span class="va">i</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>          </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span>, hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>          axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,</span>
<span>          axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span>  </span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
Now we’ll plot the figures together to create manuscript figure 4.
<div class="figure">
<img src="reproduce_results_ainslie_et_al_files/figure-html/fig4-1.png" alt="Figure 4. Distribution of index-case to case (ICC) intervals with fitted mixture density models across different infectious diseases. (A) Synthetic data showing a multi-modal distribution of ICC intervals with the fitted mixture density (red line) and estimated mean serial interval (dashed vertical line, 15.2 days). (B) ICC intervals from measles cases in England (Fine dataset) with fitted mixture density and estimated mean serial interval (13.7 days). (C) ICC intervals from pertussis cases in the Netherlands (de Greeff dataset) showing a right-skewed distribution with estimated mean serial interval (22.8 days). (D) ICC intervals from pandemic influenza A(H1N1)pdm09 in Canada (Savage dataset) with shorter intervals and estimated mean serial interval (2.8 days). The histograms show the observed distribution of ICC intervals, red curves represent the fitted mixture densities, and vertical dashed lines indicate the estimated mean serial interval for each dataset." width="700"><p class="caption">
Figure 4. Distribution of index-case to case (ICC) intervals with fitted
mixture density models across different infectious diseases. (A)
Synthetic data showing a multi-modal distribution of ICC intervals with
the fitted mixture density (red line) and estimated mean serial interval
(dashed vertical line, 15.2 days). (B) ICC intervals from measles cases
in England (Fine dataset) with fitted mixture density and estimated mean
serial interval (13.7 days). (C) ICC intervals from pertussis cases in
the Netherlands (de Greeff dataset) showing a right-skewed distribution
with estimated mean serial interval (22.8 days). (D) ICC intervals from
pandemic influenza A(H1N1)pdm09 in Canada (Savage dataset) with shorter
intervals and estimated mean serial interval (2.8 days). The histograms
show the observed distribution of ICC intervals, red curves represent
the fitted mixture densities, and vertical dashed lines indicate the
estimated mean serial interval for each dataset.
</p>
</div>
</div>
<div class="section level4">
<h4 id="time-varying-reproduction-number-3">Time-varying Reproduction Number<a class="anchor" aria-label="anchor" href="#time-varying-reproduction-number-3"></a>
</h4>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Plot</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">synthetic_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">incidence</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkgreen"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Incidence"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_scabies</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">results_rt</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"gray50"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">true_r</span>, color <span class="op">=</span> <span class="st">"True"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">R</span>, color <span class="op">=</span> <span class="st">"Estimated (WL)"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#geom_line(aes(y = R_shifted, color = "Shifted R"), linewidth = 1, linetype = "dotted") +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Customize colors</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"R Values"</span>, </span>
<span>                    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True"</span> <span class="op">=</span> <span class="st">"black"</span>, </span>
<span>                               <span class="st">"Estimated (WL)"</span> <span class="op">=</span> <span class="st">"#21908C"</span><span class="co">#, </span></span>
<span>                              <span class="co">#"Shifted R" = "#21908C"</span></span>
<span>                              <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"R"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_scabies</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">0.95</span><span class="op">)</span>,        </span>
<span>    legend.justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,          </span>
<span>    legend.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>,     </span>
<span>    legend.key.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"lines"</span><span class="op">)</span>,   </span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,   </span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,  </span>
<span>    legend.spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="st">"cm"</span><span class="op">)</span>,        </span>
<span>    legend.box.spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0</span>, <span class="st">"cm"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">fig5A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, </span>
<span>                   ncol <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                   rel_heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>                   labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create the plot</span></span>
<span><span class="va">zika_epicurve</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">zika_girardot_2015</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">cases</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Incidence"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_scabies</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">r_plot_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">res_zika</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>         <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">date</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">+</span> <span class="fl">7</span><span class="op">)</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">R_lower</span>, ymax <span class="op">=</span> <span class="va">R_upper</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"#21908C"</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"WL"</span><span class="op">)</span>, y <span class="op">=</span> <span class="va">res_zika</span><span class="op">$</span><span class="va">R</span><span class="op">[</span><span class="va">res_zika</span><span class="op">$</span><span class="va">date</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">res_zika</span><span class="op">$</span><span class="va">date</span><span class="op">)</span> <span class="op">+</span> <span class="fl">7</span><span class="op">]</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"gray50"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">epifit_zika</span><span class="op">$</span><span class="va">RLPS</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span>,<span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">R</span>, color <span class="op">=</span> <span class="st">"EpiLPS"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">epifit_zika</span><span class="op">$</span><span class="va">RWT</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">t_end</span> <span class="op">+</span> <span class="va">zika2015</span><span class="op">$</span><span class="va">dates</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">`Mean(R)`</span>, color <span class="op">=</span> <span class="st">"WT (EpiEstim)"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 month"</span>, date_labels <span class="op">=</span> <span class="st">"%b"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WL"</span> <span class="op">=</span> <span class="st">"#21908C"</span>, <span class="st">"EpiLPS"</span> <span class="op">=</span> <span class="st">"#FDE725"</span>, <span class="st">"WT (EpiEstim)"</span> <span class="op">=</span> <span class="st">"#440154"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"R"</span>, color <span class="op">=</span> <span class="st">"Method"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_scabies</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">0.95</span><span class="op">)</span>,        </span>
<span>    legend.justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,          </span>
<span>    legend.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>,     </span>
<span>    legend.key.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"lines"</span><span class="op">)</span>,   </span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,   </span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,  </span>
<span>    legend.spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="st">"cm"</span><span class="op">)</span>,        </span>
<span>    legend.box.spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0</span>, <span class="st">"cm"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="co"># combine plots</span></span>
<span><span class="va">fig5B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">zika_epicurve</span>, <span class="va">r_plot_comparison</span>, </span>
<span>                   ncol <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                   rel_heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>                   labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"D"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot incidence and Rt</span></span>
<span><span class="va">p1c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">h7n9_complete</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date_onset</span>, y <span class="op">=</span> <span class="va">cases</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"darkorange"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Incidence"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_scabies</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2c</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">res_h7n9</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>                <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">R</span><span class="op">)</span>,</span>
<span>                       <span class="va">date</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">+</span> <span class="fl">8</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">R_lower</span>, ymax <span class="op">=</span> <span class="va">R_upper</span><span class="op">)</span>, fill <span class="op">=</span> <span class="st">"#21908C"</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">R</span>, color <span class="op">=</span> <span class="st">"WL"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"gray50"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">epifit_h7n9</span><span class="op">$</span><span class="va">RLPS</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span>,<span class="op">]</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Time</span>, y <span class="op">=</span> <span class="va">R</span>, color <span class="op">=</span> <span class="st">"EpiLPS"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">epifit_h7n9</span><span class="op">$</span><span class="va">RWT</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">t_end</span> <span class="op">+</span> <span class="va">h7n9_complete</span><span class="op">$</span><span class="va">date_onset</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">`Mean(R)`</span>, color <span class="op">=</span> <span class="st">"WT (EpiEstim)"</span><span class="op">)</span>,</span>
<span>            linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 month"</span>, date_labels <span class="op">=</span> <span class="st">"%b"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WL"</span> <span class="op">=</span> <span class="st">"#21908C"</span>, <span class="st">"EpiLPS"</span> <span class="op">=</span> <span class="st">"#FDE725"</span>, <span class="st">"WT (EpiEstim)"</span> <span class="op">=</span> <span class="st">"#440154"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"R"</span>, color <span class="op">=</span> <span class="st">"Method"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_scabies</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="fl">0.95</span><span class="op">)</span>,        </span>
<span>    legend.justification <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,          </span>
<span>    legend.margin <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>,     </span>
<span>    legend.key.size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="st">"lines"</span><span class="op">)</span>,   </span>
<span>    legend.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>,   </span>
<span>    legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span>,  </span>
<span>    legend.spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="st">"cm"</span><span class="op">)</span>,        </span>
<span>    legend.box.spacing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0</span>, <span class="st">"cm"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine the plots</span></span>
<span><span class="va">fig5C</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">p1c</span>, <span class="va">p2c</span>, </span>
<span>                   nrow <span class="op">=</span> <span class="fl">2</span>, </span>
<span>                   rel_heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.5</span><span class="op">)</span>,</span>
<span>                   labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"E"</span>, <span class="st">"F"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reproduce_results_ainslie_et_al_files/figure-html/fig5-1.png" alt="Figure 5. Comparison of different methods for estimating reproduction numbers (R) across simulated and real infectious disease outbreaks. (A) Simulated epidemic curve showing daily incidence. (B) Comparison between true R values (black) and those estimated using the Wallinga-Lipsitch method (teal) for the simulated outbreak, with confidence interval (shaded region). (C) Daily case incidence of the 2015 Zika outbreak in Colombia. (D) Time-varying reproduction number estimates for the Zika outbreak using three methods: Wallinga-Lipsitch (WL, teal), EpiLPS (yellow), and Wallinga-Teunis from EpiEstim package (WT, purple). (E) Daily case incidence of the H7N9 influenza outbreak in China in 2013. (F) Reproduction number estimates for the H7N9 outbreak using the same three methods as in panel D, with confidence interval shown for the WL method (shaded region). Horizontal dashed lines indicate R=1, the threshold for epidemic growth." width="700"><p class="caption">
Figure 5. Comparison of different methods for estimating reproduction
numbers (R) across simulated and real infectious disease outbreaks. (A)
Simulated epidemic curve showing daily incidence. (B) Comparison between
true R values (black) and those estimated using the Wallinga-Lipsitch
method (teal) for the simulated outbreak, with confidence interval
(shaded region). (C) Daily case incidence of the 2015 Zika outbreak in
Colombia. (D) Time-varying reproduction number estimates for the Zika
outbreak using three methods: Wallinga-Lipsitch (WL, teal), EpiLPS
(yellow), and Wallinga-Teunis from EpiEstim package (WT, purple). (E)
Daily case incidence of the H7N9 influenza outbreak in China in 2013.
(F) Reproduction number estimates for the H7N9 outbreak using the same
three methods as in panel D, with confidence interval shown for the WL
method (shaded region). Horizontal dashed lines indicate R=1, the
threshold for epidemic growth.
</p>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body" line-spacing="2">
<div id="ref-hahne2009" class="csl-entry">
<div class="csl-left-margin">1. </div>
<div class="csl-right-inline">Hahné, S. <em>et al.</em> Epidemiology and
control of influenza a(<span>H1N1</span>)v in the netherlands: The first
115 cases. <em>Euro Surveill.</em> <strong>14</strong>, (2009).</div>
</div>
<div id="ref-cauchemez2009" class="csl-entry">
<div class="csl-left-margin">2. </div>
<div class="csl-right-inline">Cauchemez, S. <em>et al.</em> Household
transmission of 2009 pandemic influenza a (<span>H1N1</span>) virus in
the united states. <em>N. Engl. J. Med.</em> <strong>361</strong>,
2619–2627 (2009).</div>
</div>
<div id="ref-savage2011" class="csl-entry">
<div class="csl-left-margin">3. </div>
<div class="csl-right-inline">Savage, R. <em>et al.</em> Assessing secondary
attack rates among household contacts at the beginning of the influenza
a (<span>H1N1</span>) pandemic in ontario, canada, april-june 2009: A
prospective, observational study. <em>BMC Public Health</em>
<strong>11</strong>, 234 (2011).</div>
</div>
<div id="ref-papenburg2010" class="csl-entry">
<div class="csl-left-margin">4. </div>
<div class="csl-right-inline">Papenburg, J. <em>et al.</em> Household
transmission of the 2009 pandemic a/<span>H1N1</span> influenza virus:
Elevated laboratory‐confirmed secondary attack rates and evidence of
asymptomatic infections. <em>Clin. Infect. Dis.</em>
<strong>51</strong>, 1033–1041 (2010).</div>
</div>
<div id="ref-france2010" class="csl-entry">
<div class="csl-left-margin">5. </div>
<div class="csl-right-inline">France, A. M. <em>et al.</em> Household
transmission of 2009 influenza a (<span>H1N1</span>) virus after a
school-based outbreak in new york city, april-may 2009. <em>J. Infect.
Dis.</em> <strong>201</strong>, 984–992 (2010).</div>
</div>
<div id="ref-morgan2010" class="csl-entry">
<div class="csl-left-margin">6. </div>
<div class="csl-right-inline">Morgan, O. W. <em>et al.</em> Household
transmission of pandemic (<span>H1N1</span>) 2009, san antonio, texas,
<span>USA</span>, april-may 2009. <em>Emerg. Infect. Dis.</em>
<strong>16</strong>, 631–637 (2010).</div>
</div>
<div id="ref-viboud2004" class="csl-entry">
<div class="csl-left-margin">7. </div>
<div class="csl-right-inline">Viboud, C. <em>et al.</em> Risk factors of
influenza transmission in households. <em>Br. J. Gen. Pract.</em>
<strong>54</strong>, 684–689 (2004).</div>
</div>
<div id="ref-aaby1990" class="csl-entry">
<div class="csl-left-margin">8. </div>
<div class="csl-right-inline">Aaby, P. &amp; Leeuwenburg, J. Patterns of
transmission and severity of measles infection: A reanalysis of data
from the machakos area, kenya. <em>J. Infect. Dis.</em>
<strong>161</strong>, 171–174 (1990).</div>
</div>
<div id="ref-bailey1954" class="csl-entry">
<div class="csl-left-margin">9. </div>
<div class="csl-right-inline">Bailey, N. T. A statistical method of
estimating the periods of incubation and infection of an infectious
disease. <em>Nature</em> <strong>174</strong>, 139–140 (1954).</div>
</div>
<div id="ref-simpson1952" class="csl-entry">
<div class="csl-left-margin">10. </div>
<div class="csl-right-inline">Simpson, R. E. H. Infectiousness of
communicable diseases in the household (measles, chickenpox, and mumps).
<em>Lancet</em> <strong>2</strong>, 549–554 (1952).</div>
</div>
<div id="ref-chapin1925" class="csl-entry">
<div class="csl-left-margin">11. </div>
<div class="csl-right-inline">Chapin, C. V. <span>MEASLES</span>
<span>IN</span> <span>PROVIDENCE</span>, <span>R</span>.
<span>I</span>., <span>1858–1923</span>. <em>Am. J. Epidemiol.</em>
<strong>5</strong>, 635–655 (1925).</div>
</div>
<div id="ref-fine2003" class="csl-entry">
<div class="csl-left-margin">12. </div>
<div class="csl-right-inline">Fine, P. E. M. The interval between successive
cases of an infectious disease. <em>Am. J. Epidemiol.</em>
<strong>158</strong>, 1039–1047 (2003).</div>
</div>
<div id="ref-greeff2010" class="csl-entry">
<div class="csl-left-margin">13. </div>
<div class="csl-right-inline">Greeff, S. C. de <em>et al.</em> Pertussis
disease burden in the household: How to protect young infants. <em>Clin.
Infect. Dis.</em> <strong>50</strong>, 1339–1345 (2010).</div>
</div>
<div id="ref-crowcroft2008" class="csl-entry">
<div class="csl-left-margin">14. </div>
<div class="csl-right-inline">Crowcroft, N. S. <em>et al.</em> Respiratory
syncytial virus infection in infants admitted to paediatric intensive
care units in london, and in their families. <em>Eur. J. Pediatr.</em>
<strong>167</strong>, 395–399 (2008).</div>
</div>
<div id="ref-aycock1946" class="csl-entry">
<div class="csl-left-margin">15. </div>
<div class="csl-right-inline">Aycock, W. L. &amp; Ingalls, T. H. Maternal
disease as a principle in the epidemiology of congenital anomalies; with
a review of rubella. <em>Am. J. Med. Sci.</em> <strong>212</strong>,
366–379 (1946).</div>
</div>
<div id="ref-vally2007" class="csl-entry">
<div class="csl-left-margin">16. </div>
<div class="csl-right-inline">Vally, H., Dowse, G. K., Eastwood, K. &amp;
Cameron, S. An outbreak of chickenpox at a child care centre in western
australia. Costs to the community and implications for vaccination
policy. <em>Aust. N. Z. J. Public Health</em> <strong>31</strong>,
113–119 (2007).</div>
</div>
<div id="ref-lai2011" class="csl-entry">
<div class="csl-left-margin">17. </div>
<div class="csl-right-inline">Lai, C.-C., Chen, S.-C. &amp; Jiang, D. D.-S.
An outbreak of varicella among schoolchildren in taipei. <em>BMC Public
Health</em> <strong>11</strong>, 226 (2011).</div>
</div>
<div id="ref-ariza2013" class="csl-entry">
<div class="csl-left-margin">18. </div>
<div class="csl-right-inline">Ariza, L. <em>et al.</em> Investigation of a
scabies outbreak in a kindergarten in constance, germany. <em>Eur. J.
Clin. Microbiol. Infect. Dis.</em> <strong>32</strong>, 373–380
(2013).</div>
</div>
<div id="ref-kaburi2019" class="csl-entry">
<div class="csl-left-margin">19. </div>
<div class="csl-right-inline">Kaburi, B. B. <em>et al.</em> Outbreak of
scabies among preschool children, accra, ghana, 2017. <em>BMC Public
Health</em> <strong>19</strong>, 746 (2019).</div>
</div>
<div id="ref-tjon-kon-fat2021" class="csl-entry">
<div class="csl-left-margin">20. </div>
<div class="csl-right-inline">Tjon-Kon-Fat, R. <em>et al.</em> Short report:
The potential of <span>PCR</span> on skin flakes from bed linens for
diagnosis of scabies in an outbreak. <em>PLoS Negl. Trop. Dis.</em>
<strong>15</strong>, e0009485 (2021).</div>
</div>
<div id="ref-akunzirwe2023" class="csl-entry">
<div class="csl-left-margin">21. </div>
<div class="csl-right-inline">Akunzirwe, R. <em>et al.</em> An outbreak of
scabies in a fishing community in hoima district, uganda,
<span>February−June</span>, 2022. <em>Research Square</em> (2023).</div>
</div>
<div id="ref-vink2014" class="csl-entry">
<div class="csl-left-margin">22. </div>
<div class="csl-right-inline">Vink, M. A., Bootsma, M. C. J. &amp; Wallinga,
J. Serial intervals of respiratory infectious diseases: A systematic
review and analysis. <em>Am. J. Epidemiol.</em> <strong>180</strong>,
865–875 (2014).</div>
</div>
<div id="ref-burkner2017" class="csl-entry">
<div class="csl-left-margin">23. </div>
<div class="csl-right-inline">Bürkner, P.-C. Brms: An <span>R</span> package
for bayesian multilevel models using stan. <em>J. Stat. Softw.</em>
<strong>80</strong>, 1–28 (2017).</div>
</div>
<div id="ref-wallinga2007" class="csl-entry">
<div class="csl-left-margin">24. </div>
<div class="csl-right-inline">Wallinga, J. &amp; Lipsitch, M. How generation
intervals shape the relationship between growth rates and reproductive
numbers. <em>Proc. Biol. Sci.</em> <strong>274</strong>, 599–604
(2007).</div>
</div>
<div id="ref-mellanby1972" class="csl-entry">
<div class="csl-left-margin">25. </div>
<div class="csl-right-inline">Mellanby, K. <em>Scabies</em>. (EW Classey,
Faringdon, England, 1972).</div>
</div>
<div id="ref-nivel" class="csl-entry">
<div class="csl-left-margin">26. </div>
<div class="csl-right-inline">NIVEL. Cijfers ziekten per week in
nederland.</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="appendix">Appendix<a class="anchor" aria-label="anchor" href="#appendix"></a>
</h2>
<div class="section level3">
<h3 id="sensitivity-analyses">Sensitivity Analyses<a class="anchor" aria-label="anchor" href="#sensitivity-analyses"></a>
</h3>
<div class="section level4">
<h4 id="serial-interval-4">Serial Interval<a class="anchor" aria-label="anchor" href="#serial-interval-4"></a>
</h4>
<p>We performed a sensitivity analysis on the underlying distribution of
serial interval. In the main analysis we assumed the serial interval was
normally distributed. In the sensitivity analysis we assumed the serial
interval was Gamma distributed. The estimated mean and standard
deviation of serial interval for each study is shown in Table S1
<!--\@ref(tab:si_sa)-->. When assuming an underlying Gamma distribution,
the standard deviations were higher than when assuming an underlying
Normal distribution. We see from Figure S1
<!--\@ref(fig:gam_si_plots)--> that the Gamma distribution does not fit
the data well. It is possible that the Gamma distribution fits scabies
data poorly due to the long incubation period of scabies and the
possibility of negative serial intervals.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># assume a gamma distribution</span></span>
<span><span class="va">result_gam</span> <span class="op">&lt;-</span> <span class="va">si_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">icc_interval</span>, <span class="va">study</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">study</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>result <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/si_estim.html">si_estim</a></span><span class="op">(</span><span class="va">icc_interval</span>, dist <span class="op">=</span> <span class="st">"gamma"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"mean"</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"sd"</span><span class="op">)</span>,</span>
<span>    wts <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"wts"</span><span class="op">)</span>  <span class="co"># Store wts as a list-column</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">result</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">wts</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># Unnest the wts column if needed %&gt;%</span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mean</span>, <span class="va">sd</span>, <span class="va">wts</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"statistic"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"value"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">study</span>, <span class="va">statistic</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    occurrence <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    statistic <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">statistic</span> <span class="op">==</span> <span class="st">"wts"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"weight_"</span>, <span class="va">occurrence</span><span class="op">)</span>, <span class="va">statistic</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">statistic</span> <span class="op">!=</span> <span class="st">"mean"</span> <span class="op">|</span> <span class="va">occurrence</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">statistic</span> <span class="op">!=</span> <span class="st">"sd"</span> <span class="op">|</span> <span class="va">occurrence</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">occurrence</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot serial interval curves</span></span>
<span><span class="co"># Reshape results from long to wide format</span></span>
<span><span class="va">result_gam_wide</span> <span class="op">&lt;-</span> <span class="va">result_gam</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">statistic</span>,</span>
<span>    values_from <span class="op">=</span> <span class="va">value</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">si_tab_sa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">result_norm_wide</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span>, <span class="va">result_gam_wide</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span>, by <span class="op">=</span> <span class="st">"study"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">study</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Kaburi et al."</span>, <span class="st">"Ariza et al."</span>, <span class="st">"Akunzirwe et al."</span>,</span>
<span>                      <span class="st">"Tjon-Kon-Fat et al"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tab_si_gam</span> <span class="op">&lt;-</span> <span class="va">si_tab_sa</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">gt</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tab_spanner</span><span class="op">(</span></span>
<span>    label <span class="op">=</span> <span class="st">"Normal"</span>,</span>
<span>    columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mean.x</span>, <span class="va">sd.x</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tab_spanner</span><span class="op">(</span></span>
<span>    label <span class="op">=</span> <span class="st">"Gamma"</span>,</span>
<span>    columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mean.y</span>, <span class="va">sd.y</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">cols_label</span><span class="op">(</span></span>
<span>    study <span class="op">=</span> <span class="st">"Study"</span>,</span>
<span>    mean.x <span class="op">=</span> <span class="st">"Mean"</span>,</span>
<span>    sd.x <span class="op">=</span> <span class="st">"SD"</span>,</span>
<span>    mean.y <span class="op">=</span> <span class="st">"Mean"</span>,</span>
<span>    sd.y <span class="op">=</span> <span class="st">"SD"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tab_style</span><span class="op">(</span></span>
<span>    style <span class="op">=</span> <span class="fu">cell_borders</span><span class="op">(</span>sides <span class="op">=</span> <span class="st">"top"</span>, weight <span class="op">=</span> <span class="fu">px</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    locations <span class="op">=</span> <span class="fu">cells_column_labels</span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tab_style</span><span class="op">(</span></span>
<span>    style <span class="op">=</span> <span class="fu">cell_borders</span><span class="op">(</span>sides <span class="op">=</span> <span class="st">"bottom"</span>, weight <span class="op">=</span> <span class="fu">px</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    locations <span class="op">=</span> <span class="fu">cells_column_labels</span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tab_style</span><span class="op">(</span></span>
<span>    style <span class="op">=</span> <span class="fu">cell_borders</span><span class="op">(</span>sides <span class="op">=</span> <span class="st">"bottom"</span>, weight <span class="op">=</span> <span class="fu">px</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    locations <span class="op">=</span> <span class="fu">cells_body</span><span class="op">(</span>rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">si_tab_sa</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tab_footnote</span><span class="op">(</span></span>
<span>    footnote <span class="op">=</span> <span class="st">"SD = standard deviation"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tab_options</span><span class="op">(</span></span>
<span>    table.width <span class="op">=</span> <span class="fu">pct</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">tab_si_gam</span>, <span class="st">"caption"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Table S1. Estimated mean and standard deviation of serial interval from different studies assuming a Normal distribution or Gamma distribution."</span></span></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># merge si_data and result_norm_wide for plotting</span></span>
<span><span class="va">df_merged_gam</span> <span class="op">&lt;-</span> <span class="va">si_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">study</span>, <span class="va">icc_interval</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">result_gam_wide</span>, by <span class="op">=</span> <span class="st">"study"</span>, relationship <span class="op">=</span> <span class="st">"many-to-many"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply the plot_si_fit function by study</span></span>
<span><span class="va">plots_gam</span> <span class="op">&lt;-</span> <span class="va">df_merged_gam</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">study</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_map.html" class="external-link">group_map</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="../reference/plot_si_fit.html">plot_si_fit</a></span><span class="op">(</span></span>
<span>    dat <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">icc_interval</span>,</span>
<span>    mean <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    sd <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">sd</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">.x</span><span class="op">$</span><span class="va">weight_1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">.x</span><span class="op">$</span><span class="va">weight_2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">.x</span><span class="op">$</span><span class="va">weight_4</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    dist <span class="op">=</span> <span class="st">"gamma"</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Annotate plots with study names and labels</span></span>
<span><span class="va">group_order_gam</span> <span class="op">&lt;-</span> <span class="va">df_merged_gam</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">study</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_data.html" class="external-link">group_keys</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">labeled_plots_gam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">plots_gam</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">plots_gam</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="va">group_order_gam</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span>            <span class="co"># Add study names as titles</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Center the title</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine plots into a multi-pane figure</span></span>
<span><span class="va">final_plot_gam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span></span>
<span>  plotlist <span class="op">=</span> <span class="va">labeled_plots_gam</span>,</span>
<span>  labels <span class="op">=</span> <span class="st">"AUTO"</span>,      <span class="co"># Automatically adds labels (A, B, C, etc.)</span></span>
<span>  ncol <span class="op">=</span> <span class="fl">2</span>              <span class="co"># Number of columns; adjust as needed</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the final combined plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">final_plot_gam</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="reproduce_results_ainslie_et_al_files/figure-html/gam_si_plots-1.png" alt="Figure S1. Epidemic curves and estimated serial interval distributions from four scabies outbreaks. Red line indicates estimated serial interval density assuming an underlying gamma distribution." width="700" id="fig-gam-si-plots-1"><p class="caption">
Figure S1. Epidemic curves and estimated serial interval distributions
from four scabies outbreaks. Red line indicates estimated serial
interval density assuming an underlying gamma distribution.
</p>
</div>
<p>We performed a sensitivity analysis in which we altered our choice of
prior distribution for mean serial interval. In the main analysis we
assumed a prior distribution of N(100,50). In the sensitivity analysis
we assumed a prior distribution of N(50, 75) and N(150, 50). We obtained
similar estimates of the pooled mean serial interval under the
alternative prior distributions (Table
S2<!--\@ref(tab:prior_sa_tab)-->).</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># specify alternative priors</span></span>
<span><span class="va">priors2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">prior</span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">50</span>,<span class="fl">75</span><span class="op">)</span>, class <span class="op">=</span> <span class="va">Intercept</span><span class="op">)</span>,</span>
<span>            <span class="fu">prior</span><span class="op">(</span><span class="fu">cauchy</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, class <span class="op">=</span> <span class="va">sd</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fit a random effects model</span></span>
<span><span class="co"># Fit the random effects model with adjusted control parameters</span></span>
<span><span class="va">m.brm2</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  <span class="va">mean</span> <span class="op">|</span> <span class="fu">se</span><span class="op">(</span><span class="va">se</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">study</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df_ma</span>,</span>
<span>  prior <span class="op">=</span> <span class="va">priors2</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">8000</span>,  <span class="co"># Increased number of iterations</span></span>
<span>  warmup <span class="op">=</span> <span class="fl">4000</span>,  <span class="co"># Increased warmup</span></span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.999</span>, max_treedepth <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>  <span class="co"># Increased adapt_delta and max_treedepth</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># specify alternative priors</span></span>
<span><span class="va">priors3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">prior</span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">150</span>,<span class="fl">75</span><span class="op">)</span>, class <span class="op">=</span> <span class="va">Intercept</span><span class="op">)</span>,</span>
<span>            <span class="fu">prior</span><span class="op">(</span><span class="fu">cauchy</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, class <span class="op">=</span> <span class="va">sd</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fit a random effects model</span></span>
<span><span class="co"># Fit the random effects model with adjusted control parameters</span></span>
<span><span class="va">m.brm3</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  <span class="va">mean</span> <span class="op">|</span> <span class="fu">se</span><span class="op">(</span><span class="va">se</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">study</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df_ma</span>,</span>
<span>  prior <span class="op">=</span> <span class="va">priors3</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">8000</span>,  <span class="co"># Increased number of iterations</span></span>
<span>  warmup <span class="op">=</span> <span class="fl">4000</span>,  <span class="co"># Increased warmup</span></span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.999</span>, max_treedepth <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>  <span class="co"># Increased adapt_delta and max_treedepth</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results_tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"N(100, 50)"</span>, <span class="st">"N(50, 75)"</span>, <span class="st">"N(150, 50)"</span><span class="op">)</span>,</span>
<span>  Mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">123.24</span>, <span class="fl">120.87</span>, <span class="fl">127.15</span><span class="op">)</span>,</span>
<span>  SD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">31.55</span>, <span class="fl">32.22</span>, <span class="fl">31.73</span><span class="op">)</span></span>
<span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># convert to gt table</span></span>
<span><span class="va">results_gt</span> <span class="op">&lt;-</span> <span class="va">results_tab</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">gt</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">cols_label</span><span class="op">(</span></span>
<span>    Prior <span class="op">=</span> <span class="st">"Prior"</span>,</span>
<span>    Mean <span class="op">=</span> <span class="st">"Mean"</span>,</span>
<span>    SD <span class="op">=</span> <span class="st">"SD"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tab_style</span><span class="op">(</span></span>
<span>    style <span class="op">=</span> <span class="fu">cell_borders</span><span class="op">(</span>sides <span class="op">=</span> <span class="st">"top"</span>, weight <span class="op">=</span> <span class="fu">px</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    locations <span class="op">=</span> <span class="fu">cells_column_labels</span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tab_style</span><span class="op">(</span></span>
<span>    style <span class="op">=</span> <span class="fu">cell_borders</span><span class="op">(</span>sides <span class="op">=</span> <span class="st">"bottom"</span>, weight <span class="op">=</span> <span class="fu">px</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    locations <span class="op">=</span> <span class="fu">cells_column_labels</span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tab_style</span><span class="op">(</span></span>
<span>    style <span class="op">=</span> <span class="fu">cell_borders</span><span class="op">(</span>sides <span class="op">=</span> <span class="st">"bottom"</span>, weight <span class="op">=</span> <span class="fu">px</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    locations <span class="op">=</span> <span class="fu">cells_body</span><span class="op">(</span>rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">results_tab</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">tab_options</span><span class="op">(</span></span>
<span>    table.width <span class="op">=</span> <span class="fu">pct</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">results_tab</span></span>
<span><span class="co">#&gt;        Prior   Mean    SD</span></span>
<span><span class="co">#&gt; 1 N(100, 50) 123.24 31.55</span></span>
<span><span class="co">#&gt; 2  N(50, 75) 120.87 32.22</span></span>
<span><span class="co">#&gt; 3 N(150, 50) 127.15 31.73</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="time-varying-reproduction-number-4">Time-varying Reproduction Number<a class="anchor" aria-label="anchor" href="#time-varying-reproduction-number-4"></a>
</h4>
<div class="section level5">
<h5 id="serial-interval-distribution">Serial interval distribution<a class="anchor" aria-label="anchor" href="#serial-interval-distribution"></a>
</h5>
<p>In the main analysis, when we estimate the time-varying reproduction
number, we assume an underlying Normal distriubtion. However, because we
are using the serial interval distribution as an approximation of the
generation interval, which is strictly positive, we performed a
sensitivity analysis in which we assumed the serial interval
distribution is Gamma distributed with the same mean and variance
(Figure S3).</p>
<p>Below, we provide the code to generate the estimates assuming a gamma
distributed serial interval. However, this code takes a long time to run
due to the bootstrapping, so the estimates are stored in
<code>vignettes/data/rt_estimates_WL_gamma.rds</code>.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rt_scabies_gam</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wallinga_lipsitch.html">wallinga_lipsitch</a></span><span class="op">(</span></span>
<span>  incidence <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">inc</span>,</span>
<span>  dates <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">onset_date</span>,</span>
<span>  si_mean <span class="op">=</span> <span class="va">scabies_si_mean</span>,</span>
<span>  si_sd <span class="op">=</span> <span class="va">scabies_si_sd</span>,</span>
<span>  si_dist <span class="op">=</span> <span class="st">"gamma"</span>, </span>
<span>  smoothing <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  bootstrap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_bootstrap <span class="op">=</span> <span class="fl">100</span> </span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#saveRDS(rt_scabies_gam, "vignettes/data/rt_estimates_WL_gamma.rds")</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># # read in stored Rt estimates</span></span>
<span><span class="va">file_path3</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes"</span>, <span class="st">"data"</span>, <span class="st">"rt_estimates_WL_gamma.rds"</span><span class="op">)</span></span>
<span><span class="va">rt_scabies_gam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="va">file_path3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Basic Rt plot</span></span>
<span><span class="va">rt_basic_gam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rt_scabies_gam</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>                     <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">R_corrected</span><span class="op">)</span>,</span>
<span>                            <span class="va">date</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">+</span> <span class="fl">123</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">R_corrected</span>, color <span class="op">=</span> <span class="st">"Gamma"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rt_scabies</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>                     <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">R_corrected</span><span class="op">)</span>,</span>
<span>                            <span class="va">date</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">+</span> <span class="fl">123</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">R_corrected</span>, color <span class="op">=</span> <span class="st">"Normal"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">R_corrected_lower</span>, ymax <span class="op">=</span> <span class="va">R_corrected_upper</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"darkblue"</span>, alpha <span class="op">=</span> <span class="fl">0.2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Normal"</span> <span class="op">=</span> <span class="st">"#21908C"</span>, <span class="st">"Gamma"</span> <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 year"</span>, date_labels <span class="op">=</span> <span class="st">"%Y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"R"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Distribution Assumption"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_scabies</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rt_basic_gam</span></span></code></pre></div>
<div class="figure">
<img src="reproduce_results_ainslie_et_al_files/figure-html/rt_gamma_sa-1.png" alt="Figure S3. Time-varying reproduction number of scabies transmission assuming a Gamma distributed serial interval distribution (dark blue line). The time-varying reproduction number estimates assuming an underlying Normal serial interval distribution are shown as the teal line." width="100%"><p class="caption">
Figure S3. Time-varying reproduction number of scabies transmission
assuming a Gamma distributed serial interval distribution (dark blue
line). The time-varying reproduction number estimates assuming an
underlying Normal serial interval distribution are shown as the teal
line.
</p>
</div>
</div>
<div class="section level5">
<h5 id="serial-interval-parameters">Serial interval parameters<a class="anchor" aria-label="anchor" href="#serial-interval-parameters"></a>
</h5>
<p>Here, we perform a sensitivity analysis to investigate the impact of
the mean serial interval on our estimates of the time-varying
reproduction number. We’ll estimate Rt using the mean and standard
deviation of the serial interval estimated from Ariza et al. and Kaburi
et al. and then plot them with the results using the pooled mean.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Rt estimates using SI from Ariza et al.</span></span>
<span><span class="va">rt_scabies_ariza</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wallinga_lipsitch.html">wallinga_lipsitch</a></span><span class="op">(</span></span>
<span>  incidence <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">inc</span>,</span>
<span>  dates <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">onset_date</span>,</span>
<span>  si_mean <span class="op">=</span> <span class="fl">98</span>,</span>
<span>  si_sd <span class="op">=</span> <span class="fl">9.7</span>,</span>
<span>  si_dist <span class="op">=</span> <span class="st">"normal"</span>, </span>
<span>  smoothing <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  bootstrap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_bootstrap <span class="op">=</span> <span class="fl">500</span> </span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># saveRDS(rt_scabies_ariza, "vignettes/data/rt_estimates_ariza.rds")</span></span>
<span></span>
<span><span class="co"># Rt estimates using SI from Ariza et al.</span></span>
<span><span class="va">rt_scabies_kaburi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wallinga_lipsitch.html">wallinga_lipsitch</a></span><span class="op">(</span></span>
<span>  incidence <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">inc</span>,</span>
<span>  dates <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">onset_date</span>,</span>
<span>  si_mean <span class="op">=</span> <span class="fl">167</span>,</span>
<span>  si_sd <span class="op">=</span> <span class="fl">8.4</span>,</span>
<span>  si_dist <span class="op">=</span> <span class="st">"normal"</span>, </span>
<span>  smoothing <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  bootstrap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_bootstrap <span class="op">=</span> <span class="fl">500</span> </span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co">#saveRDS(rt_scabies_kaburi, "vignettes/data/rt_estimates_kaburi.rds")</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># # read in stored Rt estimates</span></span>
<span><span class="va">file_pathA</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes"</span>, <span class="st">"data"</span>, <span class="st">"rt_estimates_ariza.rds"</span><span class="op">)</span></span>
<span><span class="va">file_pathK</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes"</span>, <span class="st">"data"</span>, <span class="st">"rt_estimates_kaburi.rds"</span><span class="op">)</span></span>
<span><span class="va">rt_scabies_ariza</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="va">file_pathA</span><span class="op">)</span></span>
<span><span class="va">rt_scabies_kaburi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="va">file_pathK</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Rt plot</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">seasons_data</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">start_date</span>, xmax <span class="op">=</span> <span class="va">end_date</span>, </span>
<span>        ymin <span class="op">=</span> <span class="fl">0</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>, fill <span class="op">=</span> <span class="va">season</span><span class="op">)</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="co"># Add your Rt lines</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rt_scabies_ariza</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>                     <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">R_corrected</span><span class="op">)</span>, <span class="va">date</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">+</span> <span class="fl">167</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">R_corrected</span>, color <span class="op">=</span> <span class="st">"98 days"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rt_scabies_kaburi</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>                     <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">R_corrected</span><span class="op">)</span>, <span class="va">date</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">+</span> <span class="fl">167</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">R_corrected</span>, color <span class="op">=</span> <span class="st">"167 days"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rt_scabies</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>                     <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">R_corrected</span><span class="op">)</span>, <span class="va">date</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">+</span> <span class="fl">167</span><span class="op">)</span>, </span>
<span>            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">R_corrected</span>, color <span class="op">=</span> <span class="st">"123 days"</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="co"># R=1 threshold</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"gray70"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="co"># Scales</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"123 days"</span> <span class="op">=</span> <span class="st">"#21908C"</span>,   </span>
<span>  <span class="st">"98 days"</span> <span class="op">=</span> <span class="st">"#E85D75"</span>,     </span>
<span>  <span class="st">"167 days"</span> <span class="op">=</span> <span class="st">"#440154"</span>     </span>
<span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">season_colors</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 year"</span>, date_labels <span class="op">=</span> <span class="st">"%Y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_cartesian.html" class="external-link">coord_cartesian</a></span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="co"># Labels  </span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Rt"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Serial Interval"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Season"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_scabies</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># guides(</span></span>
<span>  <span class="co">#   color = guide_legend(nrow = 2, byrow = TRUE),</span></span>
<span>  <span class="co">#   fill = guide_legend(nrow = 2, byrow = TRUE)</span></span>
<span>  <span class="co"># ) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reproduce_results_ainslie_et_al_files/figure-html/rt_si_sa_plot-1.png" width="700"></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Panel B: Calculate peak transmission month</span></span>
<span><span class="co"># Colors matching your scheme</span></span>
<span><span class="va">si_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"123 days"</span> <span class="op">=</span> <span class="st">"#21908C"</span>, <span class="st">"98 days"</span> <span class="op">=</span> <span class="st">"#E85D75"</span>, <span class="st">"167 days"</span> <span class="op">=</span> <span class="st">"#440154"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Function to find peak month per year</span></span>
<span><span class="va">find_peak_month</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">si_label</span>, <span class="va">si_value</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">R_corrected</span><span class="op">)</span>, <span class="va">date</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">date</span><span class="op">)</span> <span class="op">+</span> <span class="va">si_value</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      year <span class="op">=</span> <span class="fu">year</span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,</span>
<span>      month <span class="op">=</span> <span class="fu">month</span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,</span>
<span>      rt_smooth <span class="op">=</span> <span class="fu">rollmean</span><span class="op">(</span><span class="va">R_corrected</span>, k <span class="op">=</span> <span class="fl">21</span>, fill <span class="op">=</span> <span class="cn">NA</span>, align <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span>,</span>
<span>      serial_interval <span class="op">=</span> <span class="va">si_label</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">rt_smooth</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">month</span>, <span class="va">serial_interval</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>avg_rt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">rt_smooth</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_max</a></span><span class="op">(</span><span class="va">avg_rt</span>, n <span class="op">=</span> <span class="fl">1</span>, with_ties <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">month</span>, <span class="va">avg_rt</span>, <span class="va">serial_interval</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Get peak months for each serial interval</span></span>
<span><span class="va">peaks_98</span> <span class="op">&lt;-</span> <span class="fu">find_peak_month</span><span class="op">(</span><span class="va">rt_scabies_ariza</span>, <span class="st">"98 days"</span>, <span class="fl">98</span><span class="op">)</span></span>
<span><span class="va">peaks_123</span> <span class="op">&lt;-</span> <span class="fu">find_peak_month</span><span class="op">(</span><span class="va">rt_scabies</span>, <span class="st">"123 days"</span>, <span class="fl">123</span><span class="op">)</span> </span>
<span><span class="va">peaks_167</span> <span class="op">&lt;-</span> <span class="fu">find_peak_month</span><span class="op">(</span><span class="va">rt_scabies_kaburi</span>, <span class="st">"167 days"</span>, <span class="fl">167</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine all peaks</span></span>
<span><span class="va">all_peak_months</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">peaks_98</span>, <span class="va">peaks_123</span>, <span class="va">peaks_167</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>serial_interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">serial_interval</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"98 days"</span>, <span class="st">"123 days"</span>, <span class="st">"167 days"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate summary statistics</span></span>
<span><span class="va">peak_summary</span> <span class="op">&lt;-</span> <span class="va">all_peak_months</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">serial_interval</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    mean_month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">month</span><span class="op">)</span>,</span>
<span>    median_month <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">month</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Density curves with mean lines showing the shift</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">all_peak_months</span>, </span>
<span>       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">month</span>, fill <span class="op">=</span> <span class="va">serial_interval</span>, color <span class="op">=</span> <span class="va">serial_interval</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="external-link">geom_density</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.1</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">peak_summary</span>, </span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="va">mean_month</span>, color <span class="op">=</span> <span class="va">serial_interval</span><span class="op">)</span>,</span>
<span>             size <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span></span>
<span>    breaks <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span>,</span>
<span>    labels <span class="op">=</span> <span class="va">month.abb</span>,</span>
<span>    limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">12</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">si_colors</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="va">si_colors</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Month of Peak Transmission"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Density"</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"Serial Interval"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Serial Interval"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_scabies</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span></span>
<span>    legend.position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>    panel.grid.major.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"gray90"</span>, size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    panel.grid.minor.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use `linewidth` instead.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span>
<span><span class="co">#&gt; Warning: The `size` argument of `element_line()` is deprecated as of ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use the `linewidth` argument instead.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span></code></pre></div>
<p><img src="reproduce_results_ainslie_et_al_files/figure-html/avg_rt_per_month-1.png" width="700"></p>
</div>
</div>
<div class="section level4">
<h4 id="annual-incidence-by-age-group">Annual Incidence by Age Group<a class="anchor" aria-label="anchor" href="#annual-incidence-by-age-group"></a>
</h4>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scabies_inc_age</span> <span class="op">&lt;-</span> <span class="fu">read.xlsx</span><span class="op">(</span><span class="va">file_path</span>, sheet <span class="op">=</span> <span class="st">"Scabies inc per 1.000 by age gr"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">df_inc_age</span> <span class="op">&lt;-</span> <span class="va">scabies_inc_age</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span><span class="op">-</span><span class="va">Year</span>, names_to <span class="op">=</span> <span class="st">"Age Group"</span>, names_pattern <span class="op">=</span> <span class="st">"(.*)\\.year"</span>, values_to <span class="op">=</span> <span class="st">"Incidence"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>Incidence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Incidence</span><span class="op">)</span>,</span>
<span>         `Age Group` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">`Age Group`</span>, </span>
<span>                              levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0-4"</span>, <span class="st">"5-9"</span>, <span class="st">"10-14"</span>, <span class="st">"15-19"</span>, <span class="st">"20-24"</span>, </span>
<span>                                         <span class="st">"25-29"</span>, <span class="st">"30-34"</span>, <span class="st">"35-39"</span>, <span class="st">"40-44"</span>, <span class="st">"45-49"</span>, </span>
<span>                                         <span class="st">"50-54"</span>, <span class="st">"55-59"</span>, <span class="st">"60-64"</span>, <span class="st">"65+"</span><span class="op">)</span><span class="op">)</span></span>
<span>         <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_inc_age</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">Incidence</span>, color <span class="op">=</span> <span class="va">`Age Group`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Line plot</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Optional: Add points</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_d</a></span><span class="op">(</span>option <span class="op">=</span> <span class="st">"turbo"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Use a viridis color palette</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">df_inc_age</span><span class="op">$</span><span class="va">Year</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">df_inc_age</span><span class="op">$</span><span class="va">Year</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Incidence per 1,000"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Age Group"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_scabies</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span> </span></code></pre></div>
<div class="figure">
<img src="reproduce_results_ainslie_et_al_files/figure-html/annual_inc_by_age-1.png" alt="Figure S4. Annual scabies incidence per 1,000 people by age group in the Netherlands from 2011 to 2022." width="100%"><p class="caption">
Figure S4. Annual scabies incidence per 1,000 people by age group in the
Netherlands from 2011 to 2022.
</p>
</div>
</div>
<div class="section level4">
<h4 id="software-implemenation-and-validation">Software Implemenation and Validation<a class="anchor" aria-label="anchor" href="#software-implemenation-and-validation"></a>
</h4>
<p>In the main text, we show 3 examples of using the method of Vink et
al<span class="citation"><sup>22</sup></span> on historical data sets.
Below are the visualisations of the remaining 19 studies.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># studies used in main text figure 7, 12, 17</span></span>
<span></span>
<span><span class="va">remaining_plots</span> <span class="op">&lt;-</span> <span class="va">labeled_plots</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">12</span>, <span class="fl">17</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">fig_remaining</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span></span>
<span>  plotlist <span class="op">=</span> <span class="va">remaining_plots</span>,</span>
<span>  labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AUTO"</span><span class="op">)</span>, </span>
<span>  ncol <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/save_plot.html" class="external-link">save_plot</a></span><span class="op">(</span><span class="st">"figS5.tiff"</span>, <span class="va">fig_remaining</span>,</span>
<span>          base_width <span class="op">=</span> <span class="fl">8.5</span>,      </span>
<span>          base_height <span class="op">=</span> <span class="fl">11</span>,      </span>
<span>          dpi <span class="op">=</span> <span class="fl">600</span>,            </span>
<span>          compression <span class="op">=</span> <span class="st">"lzw"</span><span class="op">)</span></span></code></pre></div>
<p>When comparing the estimates produced by <code>si_estim</code> and
the estimates presented in Vink et al., we see that si_estim
successfully recaptures the estimates of the original study (Table
1).</p>
<pre><code><span><span class="co">#&gt; Registered S3 method overwritten by 'ftExtra':</span></span>
<span><span class="co">#&gt;   method                  from     </span></span>
<span><span class="co">#&gt;   as_flextable.data.frame flextable</span></span></code></pre>
<div class="tabwid">
<style>.cl-189213d0{}.cl-188a6518{font-family:'DejaVu Sans';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-188a6522{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-188a6523{font-family:'DejaVu Sans';font-size:6.6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.3pt;}.cl-188d6448{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-188d645c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-188d645d{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-188d855e{width:1.329in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d8572{width:0.774in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d8573{width:2.318in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d857c{width:1.42in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d857d{width:0.801in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d8586{width:0.628in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d8587{width:1.329in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d8590{width:0.774in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d859a{width:2.318in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d859b{width:1.42in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d85a4{width:0.801in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d85a5{width:0.628in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d85ae{width:1.329in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d85af{width:0.774in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d85b8{width:2.318in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d85b9{width:1.42in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d85ba{width:0.801in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d85c2{width:0.628in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d85cc{width:1.329in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d85cd{width:0.774in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d85ce{width:2.318in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d85d6{width:1.42in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d85d7{width:0.801in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d85e0{width:0.628in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d85ea{width:1.329in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d85eb{width:0.774in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d85f4{width:2.318in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d85f5{width:1.42in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d85fe{width:0.801in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d8608{width:0.628in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d8612{width:1.329in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d8613{width:0.774in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d8614{width:2.318in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d8615{width:1.42in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d861c{width:0.801in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-188d8626{width:0.628in;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="table cl-189213d0">
<caption style="display:table-caption;"><span>Table 1. Estimates of mean and standard deviation (SD) of the serial interval distribution from Vink et al. and from `si_estim` for different historical data sets.</span></caption>
<thead>
<tr style="overflow-wrap:break-word;">
<th colspan="4" class="cl-188d855e"><p class="cl-188d6448"><span class="cl-188a6518"></span></p></th>
<th colspan="2" class="cl-188d857d"><p class="cl-188d6448"><span class="cl-188a6518">Vink et al. Estimates</span></p></th>
<th colspan="2" class="cl-188d857d"><p class="cl-188d6448"><span class="cl-188a6518">{mitey} Estimates</span></p></th>
</tr>
<tr style="overflow-wrap:break-word;">
<th class="cl-188d8587"><p class="cl-188d6448"><span class="cl-188a6518">Author</span></p></th>
<th class="cl-188d8590"><p class="cl-188d6448"><span class="cl-188a6518">Year</span></p></th>
<th class="cl-188d859a"><p class="cl-188d6448"><span class="cl-188a6518">Pathogen</span></p></th>
<th class="cl-188d859b"><p class="cl-188d6448"><span class="cl-188a6518">Country</span></p></th>
<th class="cl-188d85a4"><p class="cl-188d6448"><span class="cl-188a6518">Mean</span></p></th>
<th class="cl-188d85a5"><p class="cl-188d6448"><span class="cl-188a6518">SD</span></p></th>
<th class="cl-188d85a4"><p class="cl-188d6448"><span class="cl-188a6518">Mean</span></p></th>
<th class="cl-188d85a5"><p class="cl-188d6448"><span class="cl-188a6518">SD</span></p></th>
</tr>
</thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-188d85ae"><p class="cl-188d645c"><span class="cl-188a6522">Hahne</span><span class="cl-188a6523">1</span></p></td>
<td class="cl-188d85af"><p class="cl-188d645d"><span class="cl-188a6522">2009</span></p></td>
<td class="cl-188d85b8"><p class="cl-188d645c"><span class="cl-188a6522">Influenza</span><span class="cl-188a6522"> </span><span class="cl-188a6522">A(H1N1)pdm09</span></p></td>
<td class="cl-188d85b9"><p class="cl-188d645c"><span class="cl-188a6522">Netherlands</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">1.7</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">1.2</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">1.7</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">1.2</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-188d85ae"><p class="cl-188d645c"><span class="cl-188a6522">Cauchemez</span><span class="cl-188a6523">2</span></p></td>
<td class="cl-188d85af"><p class="cl-188d645d"><span class="cl-188a6522">2009</span></p></td>
<td class="cl-188d85b8"><p class="cl-188d645c"><span class="cl-188a6522">Influenza</span><span class="cl-188a6522"> </span><span class="cl-188a6522">A(H1N1)pdm09</span></p></td>
<td class="cl-188d85b9"><p class="cl-188d645c"><span class="cl-188a6522">United</span><span class="cl-188a6522"> </span><span class="cl-188a6522">States</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">2.1</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">1.2</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">2.1</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">1.2</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-188d85ae"><p class="cl-188d645c"><span class="cl-188a6522">Savage</span><span class="cl-188a6523">3</span></p></td>
<td class="cl-188d85af"><p class="cl-188d645d"><span class="cl-188a6522">2011</span></p></td>
<td class="cl-188d85b8"><p class="cl-188d645c"><span class="cl-188a6522">Influenza</span><span class="cl-188a6522"> </span><span class="cl-188a6522">A(H1N1)pdm09</span></p></td>
<td class="cl-188d85b9"><p class="cl-188d645c"><span class="cl-188a6522">Canada</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">2.8</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">0.8</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">2.8</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">0.8</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-188d85ae"><p class="cl-188d645c"><span class="cl-188a6522">Papenburg</span><span class="cl-188a6523">4</span></p></td>
<td class="cl-188d85af"><p class="cl-188d645d"><span class="cl-188a6522">2010</span></p></td>
<td class="cl-188d85b8"><p class="cl-188d645c"><span class="cl-188a6522">Influenza</span><span class="cl-188a6522"> </span><span class="cl-188a6522">A(H1N1)pdm09</span></p></td>
<td class="cl-188d85b9"><p class="cl-188d645c"><span class="cl-188a6522">Canada</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">2.9</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">1.2</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">2.9</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">1.2</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-188d85ae"><p class="cl-188d645c"><span class="cl-188a6522">France</span><span class="cl-188a6523">5</span></p></td>
<td class="cl-188d85af"><p class="cl-188d645d"><span class="cl-188a6522">2010</span></p></td>
<td class="cl-188d85b8"><p class="cl-188d645c"><span class="cl-188a6522">Influenza</span><span class="cl-188a6522"> </span><span class="cl-188a6522">A(H1N1)pdm09</span></p></td>
<td class="cl-188d85b9"><p class="cl-188d645c"><span class="cl-188a6522">United</span><span class="cl-188a6522"> </span><span class="cl-188a6522">States</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">3.0</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">0.9</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">3.0</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">0.9</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-188d85ae"><p class="cl-188d645c"><span class="cl-188a6522">Morgan</span><span class="cl-188a6523">6</span></p></td>
<td class="cl-188d85af"><p class="cl-188d645d"><span class="cl-188a6522">2010</span></p></td>
<td class="cl-188d85b8"><p class="cl-188d645c"><span class="cl-188a6522">Influenza</span><span class="cl-188a6522"> </span><span class="cl-188a6522">A(H1N1)pdm09</span></p></td>
<td class="cl-188d85b9"><p class="cl-188d645c"><span class="cl-188a6522">United</span><span class="cl-188a6522"> </span><span class="cl-188a6522">States</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">3.7</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">1.1</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">3.7</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">1.1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-188d85cc"><p class="cl-188d645c"><span class="cl-188a6522">Viboud</span><span class="cl-188a6523">7</span></p></td>
<td class="cl-188d85cd"><p class="cl-188d645d"><span class="cl-188a6522">2004</span></p></td>
<td class="cl-188d85ce"><p class="cl-188d645c"><span class="cl-188a6522">Influenza</span><span class="cl-188a6522"> </span><span class="cl-188a6522">A(H3N2)</span></p></td>
<td class="cl-188d85d6"><p class="cl-188d645c"><span class="cl-188a6522">France</span></p></td>
<td class="cl-188d85d7"><p class="cl-188d645d"><span class="cl-188a6522">2.2</span></p></td>
<td class="cl-188d85e0"><p class="cl-188d645d"><span class="cl-188a6522">0.8</span></p></td>
<td class="cl-188d85d7"><p class="cl-188d645d"><span class="cl-188a6522">2.2</span></p></td>
<td class="cl-188d85e0"><p class="cl-188d645d"><span class="cl-188a6522">0.8</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-188d85ae"><p class="cl-188d645c"><span class="cl-188a6522">Aaby</span><span class="cl-188a6523">8</span></p></td>
<td class="cl-188d85af"><p class="cl-188d645d"><span class="cl-188a6522">1990</span></p></td>
<td class="cl-188d85b8"><p class="cl-188d645c"><span class="cl-188a6522">Measles</span></p></td>
<td class="cl-188d85b9"><p class="cl-188d645c"><span class="cl-188a6522">Kenya</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">9.9</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">2.4</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">9.9</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">2.4</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-188d85ae"><p class="cl-188d645c"><span class="cl-188a6522">Bailey</span><span class="cl-188a6523">9</span></p></td>
<td class="cl-188d85af"><p class="cl-188d645d"><span class="cl-188a6522">1954</span></p></td>
<td class="cl-188d85b8"><p class="cl-188d645c"><span class="cl-188a6522">Measles</span></p></td>
<td class="cl-188d85b9"><p class="cl-188d645c"><span class="cl-188a6522">England</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">10.9</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">1.9</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">10.9</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">1.9</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-188d85ae"><p class="cl-188d645c"><span class="cl-188a6522">Simpson</span><span class="cl-188a6523">10</span></p></td>
<td class="cl-188d85af"><p class="cl-188d645d"><span class="cl-188a6522">1952</span></p></td>
<td class="cl-188d85b8"><p class="cl-188d645c"><span class="cl-188a6522">Measles</span></p></td>
<td class="cl-188d85b9"><p class="cl-188d645c"><span class="cl-188a6522">England</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">10.9</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">2.0</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">10.9</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">2.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-188d85ae"><p class="cl-188d645c"><span class="cl-188a6522">Chapin</span><span class="cl-188a6523">11</span></p></td>
<td class="cl-188d85af"><p class="cl-188d645d"><span class="cl-188a6522">1925</span></p></td>
<td class="cl-188d85b8"><p class="cl-188d645c"><span class="cl-188a6522">Measles</span></p></td>
<td class="cl-188d85b9"><p class="cl-188d645c"><span class="cl-188a6522">United</span><span class="cl-188a6522"> </span><span class="cl-188a6522">States</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">11.9</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">2.6</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">11.9</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">2.6</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-188d85ae"><p class="cl-188d645c"><span class="cl-188a6522">Fine</span><span class="cl-188a6523">12</span></p></td>
<td class="cl-188d85af"><p class="cl-188d645d"><span class="cl-188a6522">2003</span></p></td>
<td class="cl-188d85b8"><p class="cl-188d645c"><span class="cl-188a6522">Measles</span></p></td>
<td class="cl-188d85b9"><p class="cl-188d645c"><span class="cl-188a6522">England</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">13.7</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">1.5</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">13.7</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">1.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-188d85ea"><p class="cl-188d645c"><span class="cl-188a6522">Fine</span><span class="cl-188a6523">12</span></p></td>
<td class="cl-188d85eb"><p class="cl-188d645d"><span class="cl-188a6522">2003</span></p></td>
<td class="cl-188d85f4"><p class="cl-188d645c"><span class="cl-188a6522">Measles</span></p></td>
<td class="cl-188d85f5"><p class="cl-188d645c"><span class="cl-188a6522">United</span><span class="cl-188a6522"> </span><span class="cl-188a6522">States</span></p></td>
<td class="cl-188d85fe"><p class="cl-188d645d"><span class="cl-188a6522">13.8</span></p></td>
<td class="cl-188d8608"><p class="cl-188d645d"><span class="cl-188a6522">2.5</span></p></td>
<td class="cl-188d85fe"><p class="cl-188d645d"><span class="cl-188a6522">13.8</span></p></td>
<td class="cl-188d8608"><p class="cl-188d645d"><span class="cl-188a6522">2.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-188d85ae"><p class="cl-188d645c"><span class="cl-188a6522">Simpson</span><span class="cl-188a6523">10</span></p></td>
<td class="cl-188d85af"><p class="cl-188d645d"><span class="cl-188a6522">1952</span></p></td>
<td class="cl-188d85b8"><p class="cl-188d645c"><span class="cl-188a6522">Mumps</span></p></td>
<td class="cl-188d85b9"><p class="cl-188d645c"><span class="cl-188a6522">England</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">18.0</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">3.5</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">18.0</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">3.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-188d85ea"><p class="cl-188d645c"><span class="cl-188a6522">de</span><span class="cl-188a6522"> </span><span class="cl-188a6522">Greeff</span><span class="cl-188a6523">13</span></p></td>
<td class="cl-188d85eb"><p class="cl-188d645d"><span class="cl-188a6522">2010</span></p></td>
<td class="cl-188d85f4"><p class="cl-188d645c"><span class="cl-188a6522">Pertussis</span></p></td>
<td class="cl-188d85f5"><p class="cl-188d645c"><span class="cl-188a6522">Netherlands</span></p></td>
<td class="cl-188d85fe"><p class="cl-188d645d"><span class="cl-188a6522">22.8</span></p></td>
<td class="cl-188d8608"><p class="cl-188d645d"><span class="cl-188a6522">6.5</span></p></td>
<td class="cl-188d85fe"><p class="cl-188d645d"><span class="cl-188a6522">22.8</span></p></td>
<td class="cl-188d8608"><p class="cl-188d645d"><span class="cl-188a6522">6.5</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-188d85ae"><p class="cl-188d645c"><span class="cl-188a6522">Crowcroft</span><span class="cl-188a6523">14</span></p></td>
<td class="cl-188d85af"><p class="cl-188d645d"><span class="cl-188a6522">2008</span></p></td>
<td class="cl-188d85b8"><p class="cl-188d645c"><span class="cl-188a6522">RSV</span></p></td>
<td class="cl-188d85b9"><p class="cl-188d645c"><span class="cl-188a6522">England</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">7.5</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">2.1</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">7.5</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">2.1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-188d85ae"><p class="cl-188d645c"><span class="cl-188a6522">Aycock</span><span class="cl-188a6523">15</span></p></td>
<td class="cl-188d85af"><p class="cl-188d645d"><span class="cl-188a6522">1946</span></p></td>
<td class="cl-188d85b8"><p class="cl-188d645c"><span class="cl-188a6522">Rubella</span></p></td>
<td class="cl-188d85b9"><p class="cl-188d645c"><span class="cl-188a6522">Unknown</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">18.3</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">2.0</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">18.3</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">2.0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-188d85ae"><p class="cl-188d645c"><span class="cl-188a6522">Fine</span><span class="cl-188a6523">12</span></p></td>
<td class="cl-188d85af"><p class="cl-188d645d"><span class="cl-188a6522">2003</span></p></td>
<td class="cl-188d85b8"><p class="cl-188d645c"><span class="cl-188a6522">Smallpox</span></p></td>
<td class="cl-188d85b9"><p class="cl-188d645c"><span class="cl-188a6522">Germany</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">16.7</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">3.3</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">16.7</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">3.3</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-188d85ae"><p class="cl-188d645c"><span class="cl-188a6522">Fine</span><span class="cl-188a6523">12</span></p></td>
<td class="cl-188d85af"><p class="cl-188d645d"><span class="cl-188a6522">2003</span></p></td>
<td class="cl-188d85b8"><p class="cl-188d645c"><span class="cl-188a6522">Smallpox</span></p></td>
<td class="cl-188d85b9"><p class="cl-188d645c"><span class="cl-188a6522">Kosovo</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">17.3</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">1.9</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">17.3</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">1.9</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-188d85ae"><p class="cl-188d645c"><span class="cl-188a6522">Vally</span><span class="cl-188a6523">16</span></p></td>
<td class="cl-188d85af"><p class="cl-188d645d"><span class="cl-188a6522">2007</span></p></td>
<td class="cl-188d85b8"><p class="cl-188d645c"><span class="cl-188a6522">Varicella</span></p></td>
<td class="cl-188d85b9"><p class="cl-188d645c"><span class="cl-188a6522">Australia</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">13.1</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">2.2</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">13.1</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">2.2</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-188d85ae"><p class="cl-188d645c"><span class="cl-188a6522">Simpson</span><span class="cl-188a6523">10</span></p></td>
<td class="cl-188d85af"><p class="cl-188d645d"><span class="cl-188a6522">1952</span></p></td>
<td class="cl-188d85b8"><p class="cl-188d645c"><span class="cl-188a6522">Varicella</span></p></td>
<td class="cl-188d85b9"><p class="cl-188d645c"><span class="cl-188a6522">England</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">14.1</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">2.4</span></p></td>
<td class="cl-188d85ba"><p class="cl-188d645d"><span class="cl-188a6522">14.1</span></p></td>
<td class="cl-188d85c2"><p class="cl-188d645d"><span class="cl-188a6522">2.4</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-188d8612"><p class="cl-188d645c"><span class="cl-188a6522">Lai</span><span class="cl-188a6523">17</span></p></td>
<td class="cl-188d8613"><p class="cl-188d645d"><span class="cl-188a6522">2011</span></p></td>
<td class="cl-188d8614"><p class="cl-188d645c"><span class="cl-188a6522">Varicella</span></p></td>
<td class="cl-188d8615"><p class="cl-188d645c"><span class="cl-188a6522">Taiwan</span></p></td>
<td class="cl-188d861c"><p class="cl-188d645d"><span class="cl-188a6522">14.2</span></p></td>
<td class="cl-188d8626"><p class="cl-188d645d"><span class="cl-188a6522">1.3</span></p></td>
<td class="cl-188d861c"><p class="cl-188d645d"><span class="cl-188a6522">14.2</span></p></td>
<td class="cl-188d8626"><p class="cl-188d645d"><span class="cl-188a6522">1.3</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kylie Ainslie.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
