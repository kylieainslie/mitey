<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Reproduce Results from Ainslie et al. • mitey</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Reproduce Results from Ainslie et al.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mitey</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/code_validation_for_Vink_method.html">Code validation for Vink method</a></li>
    <li><a class="dropdown-item" href="../articles/epidemiology_of_scabies.html">Estimation of the epidemiological characteristics of scabies</a></li>
    <li><a class="dropdown-item" href="../articles/reproduce_results_ainslie_et_al.html">Reproduce Results from Ainslie et al.</a></li>
    <li><a class="dropdown-item" href="../articles/rt_estimation_validation.html">Validation of time-varying reproduction number estimation</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kylieainslie/mitey/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Reproduce Results from Ainslie et al.</h1>
                        <h4 data-toc-skip class="author">Kylie
Ainslie</h4>
            
            <h4 data-toc-skip class="date">2025-04-02</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/kylieainslie/mitey/blob/main/vignettes/articles/reproduce_results_ainslie_et_al.Rmd" class="external-link"><code>vignettes/articles/reproduce_results_ainslie_et_al.Rmd</code></a></small>
      <div class="d-none name"><code>reproduce_results_ainslie_et_al.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This article provides the code necessary to reproduce the results
from <a href="https://kylieainslie.github.io/mitey/articles/epidemiology_of_scabies.html">Ainslie
et al. 2025</a>. Briefly, the article demonstrates how key
epidemiological characteristics of scabies were estimated. Specifically,
the article shows how to estimate 1) the serial interval using a method
developed by <a href="https://doi.org/10.1093/aje/kwu209" class="external-link">Vink et
al.</a> by applying <code><a href="../reference/si_estim.html">mitey::si_estim()</a></code> to time series of
symptom onset date data from scabies outbreaks; 2) the growth rate from
annual scabies incidence from 2011 to 2023 in the Netherlands; 3) the
basic reproduction number; and 4) time-varying reproduction number using
a method developed by <a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC1766383/" class="external-link">Wallinga and
Lipsitch</a> by applying <code><a href="../reference/rt_estim.html">mitey::rt_estim()</a></code> to data on the
number of scabies consultations each week in the Netherlands from 2011
to 2023. To our knowledge, this is the first study to estimate these
quantities for scabies; however, the methods demonstrated here can be
applied data sources describing the spread of other infectious
diseases.</p>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
</div>
<div class="section level2">
<h2 id="analyses">Analyses<a class="anchor" aria-label="anchor" href="#analyses"></a>
</h2>
<div class="section level3">
<h3 id="serial-interval">Serial Interval<a class="anchor" aria-label="anchor" href="#serial-interval"></a>
</h3>
<div class="section level4">
<h4 id="estimate-mean-and-standard-deviation">Estimate mean and standard deviation<a class="anchor" aria-label="anchor" href="#estimate-mean-and-standard-deviation"></a>
</h4>
<p>We use data on the dates of symptom onset for scabies cases from four
different studies<span class="citation"><sup>1–4</sup></span> of scabies
outbreaks which are located in <code>vignettes/data/si_data.rds</code>.
We apply the method proposed by Vink et al.<span class="citation"><sup>5</sup></span> to estimate the mean and standard
deviation of the serial interval distribution. The method requires the
specification of the underlying serial interval distribution, either
Gaussian (Normal) or Gamma. Here, we assumed that serial interval
distributions for scabies can be approximated by a Normal
distribution.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read in data</span></span>
<span><span class="va">si_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"../data/si_data.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use method from Vink et al. to estimate SI for each study</span></span>
<span><span class="co"># assume a Normal distribution, then do some wrangling</span></span>
<span><span class="va">result_norm</span> <span class="op">&lt;-</span> <span class="va">si_data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">icc_interval</span>, <span class="va">study</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">study</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>result <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/si_estim.html">si_estim</a></span><span class="op">(</span><span class="va">icc_interval</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="fu">map_dbl</span><span class="op">(</span><span class="va">result</span>, <span class="st">"mean"</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu">map_dbl</span><span class="op">(</span><span class="va">result</span>, <span class="st">"sd"</span><span class="op">)</span>,</span>
<span>    wts <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">result</span>, <span class="st">"wts"</span><span class="op">)</span>  <span class="co"># Store wts as a list-column</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">result</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">unnest</span><span class="op">(</span><span class="va">wts</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># Unnest the wts column if needed %&gt;%</span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mean</span>, <span class="va">sd</span>, <span class="va">wts</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"statistic"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"value"</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">study</span>, <span class="va">statistic</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    occurrence <span class="op">=</span> <span class="fu">row_number</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    statistic <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">statistic</span> <span class="op">==</span> <span class="st">"wts"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"weight_"</span>, <span class="va">occurrence</span><span class="op">)</span>, <span class="va">statistic</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">statistic</span> <span class="op">!=</span> <span class="st">"mean"</span> <span class="op">|</span> <span class="va">occurrence</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">statistic</span> <span class="op">!=</span> <span class="st">"sd"</span> <span class="op">|</span> <span class="va">occurrence</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">occurrence</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Reshape results from long to wide format</span></span>
<span><span class="va">result_norm_wide</span> <span class="op">&lt;-</span> <span class="va">result_norm</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">statistic</span>,</span>
<span>    values_from <span class="op">=</span> <span class="va">value</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>We summarise the results in a Table 1.</p>
<div id="mwlefoodfi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#mwlefoodfi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#mwlefoodfi thead, #mwlefoodfi tbody, #mwlefoodfi tfoot, #mwlefoodfi tr, #mwlefoodfi td, #mwlefoodfi th {
  border-style: none;
}

#mwlefoodfi p {
  margin: 0;
  padding: 0;
}

#mwlefoodfi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: 100%;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mwlefoodfi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#mwlefoodfi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mwlefoodfi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mwlefoodfi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mwlefoodfi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mwlefoodfi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mwlefoodfi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mwlefoodfi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mwlefoodfi .gt_spanner_row {
  border-bottom-style: hidden;
}

#mwlefoodfi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#mwlefoodfi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mwlefoodfi .gt_from_md > :first-child {
  margin-top: 0;
}

#mwlefoodfi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mwlefoodfi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mwlefoodfi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mwlefoodfi .gt_row_group_first td {
  border-top-width: 2px;
}

#mwlefoodfi .gt_row_group_first th {
  border-top-width: 2px;
}

#mwlefoodfi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mwlefoodfi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mwlefoodfi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mwlefoodfi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mwlefoodfi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mwlefoodfi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mwlefoodfi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mwlefoodfi .gt_left {
  text-align: left;
}

#mwlefoodfi .gt_center {
  text-align: center;
}

#mwlefoodfi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mwlefoodfi .gt_font_normal {
  font-weight: normal;
}

#mwlefoodfi .gt_font_bold {
  font-weight: bold;
}

#mwlefoodfi .gt_font_italic {
  font-style: italic;
}

#mwlefoodfi .gt_super {
  font-size: 65%;
}

#mwlefoodfi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#mwlefoodfi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mwlefoodfi .gt_indent_1 {
  text-indent: 5px;
}

#mwlefoodfi .gt_indent_2 {
  text-indent: 10px;
}

#mwlefoodfi .gt_indent_3 {
  text-indent: 15px;
}

#mwlefoodfi .gt_indent_4 {
  text-indent: 20px;
}

#mwlefoodfi .gt_indent_5 {
  text-indent: 25px;
}

#mwlefoodfi .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#mwlefoodfi div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead><tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="border-top-width: 1px; border-top-style: solid; border-top-color: #000000; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;" scope="col" id="study">Study</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 1px; border-top-style: solid; border-top-color: #000000; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;" scope="col" id="mean">Mean</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="border-top-width: 1px; border-top-style: solid; border-top-color: #000000; border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;" scope="col" id="sd">Standard Deviation</th>
    </tr></thead>
<tbody class="gt_table_body">
<tr>
<td headers="study" class="gt_row gt_left">Akunzirwe et al.</td>
<td headers="mean" class="gt_row gt_right">122.92</td>
<td headers="sd" class="gt_row gt_right">26.92</td>
</tr>
<tr>
<td headers="study" class="gt_row gt_left">Ariza et al.</td>
<td headers="mean" class="gt_row gt_right">98.40</td>
<td headers="sd" class="gt_row gt_right">8.54</td>
</tr>
<tr>
<td headers="study" class="gt_row gt_left">Kaburi et al.</td>
<td headers="mean" class="gt_row gt_right">167.34</td>
<td headers="sd" class="gt_row gt_right">9.72</td>
</tr>
<tr>
<td headers="study" class="gt_row gt_left" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">Tjon-Kon-Fat et al</td>
<td headers="mean" class="gt_row gt_right" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">110.72</td>
<td headers="sd" class="gt_row gt_right" style="border-bottom-width: 1px; border-bottom-style: solid; border-bottom-color: #000000;">16.14</td>
</tr>
</tbody>
</table>
</div>
<p>Using <code><a href="../reference/plot_si_fit.html">mitey::plot_si_fit()</a></code>, we can use the outputs of
<code>si_estim</code> to plot the fitted mixture density over the
symptom onset data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">#knitr::include_graphics("figures/epidemic_curve_density_plot.png")</span></span>
<span><span class="co"># merge si_data and result_norm_wide for plotting</span></span>
<span><span class="va">df_merged</span> <span class="op">&lt;-</span> <span class="va">si_data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">study</span>, <span class="va">icc_interval</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">result_norm_wide</span>, by <span class="op">=</span> <span class="st">"study"</span>, relationship <span class="op">=</span> <span class="st">"many-to-many"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply the plot_si_fit function by study</span></span>
<span><span class="va">plots</span> <span class="op">&lt;-</span> <span class="va">df_merged</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">study</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_map</span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="../reference/plot_si_fit.html">plot_si_fit</a></span><span class="op">(</span></span>
<span>    dat <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">icc_interval</span>,</span>
<span>    mean <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    sd <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">sd</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">.x</span><span class="op">$</span><span class="va">weight_1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">.x</span><span class="op">$</span><span class="va">weight_2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">.x</span><span class="op">$</span><span class="va">weight_3</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                <span class="va">.x</span><span class="op">$</span><span class="va">weight_4</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">.x</span><span class="op">$</span><span class="va">weight_5</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">.x</span><span class="op">$</span><span class="va">weight_6</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">.x</span><span class="op">$</span><span class="va">weight_7</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    dist <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>    scaling_factor <span class="op">=</span> <span class="fl">0.25</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Annotate plots with study names and labels</span></span>
<span><span class="co"># Find the order of the groups</span></span>
<span><span class="va">group_order</span> <span class="op">&lt;-</span> <span class="va">df_merged</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">study</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_keys</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">labeled_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">plots</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">plots</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span>    <span class="fu">ggtitle</span><span class="op">(</span><span class="va">group_order</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span>            <span class="co"># Add study names as titles</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Center the title</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine plots into a multi-pane figure</span></span>
<span><span class="va">final_plot</span> <span class="op">&lt;-</span> <span class="fu">plot_grid</span><span class="op">(</span></span>
<span>  plotlist <span class="op">=</span> <span class="va">labeled_plots</span>,</span>
<span>  labels <span class="op">=</span> <span class="st">"AUTO"</span>,      <span class="co"># Automatically adds labels (A, B, C, etc.)</span></span>
<span>  label_size <span class="op">=</span> <span class="fl">14</span>,      <span class="co"># Size of the labels</span></span>
<span>  ncol <span class="op">=</span> <span class="fl">2</span>              <span class="co"># Number of columns; adjust as needed</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the final combined plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">final_plot</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reproduce_results_ainslie_et_al_files/figure-html/si_dist_plot-1.png" alt="Figure 1. Model fit of the serial interval to index case–to–case (ICC) interval data. Each histogram shows the distribution of observed ICC intervals for scabies outbreaks described in A) Akunzirwe et al., B) Ariza et al., C) Kaburi et al., D) Tjon-Kon-Fat et al. The overlayed red line shows the estimated mixture density for each infection. The dashed vertical line indicates the mean serial interval. The value of the mean serial interval is shown to the right of the dashed line along the x-axis." width="672" id="fig-si-dist-plot-1"><p class="caption">
Figure 1. Model fit of the serial interval to index case–to–case (ICC)
interval data. Each histogram shows the distribution of observed ICC
intervals for scabies outbreaks described in A) Akunzirwe et al., B)
Ariza et al., C) Kaburi et al., D) Tjon-Kon-Fat et al. The overlayed red
line shows the estimated mixture density for each infection. The dashed
vertical line indicates the mean serial interval. The value of the mean
serial interval is shown to the right of the dashed line along the
x-axis.
</p>
</div>
</div>
<div class="section level4">
<h4 id="meta-analysis">Meta-analysis<a class="anchor" aria-label="anchor" href="#meta-analysis"></a>
</h4>
<p>We used the <code>brms</code> package in R<span class="citation"><sup>6</sup></span> to estimate the pooled mean serial
interval. We used a Bayesian hierarchical random-effects model in which
we assume that there is a typical distribution for serial intervals,
from which an outbreak-specific mean serial interval is sampled<span class="citation"><sup>7</sup></span>. We specified the prior
distribution for the pooled mean as a normal distribution with a mean of
100 days, based on Mellanby’s reports on parasite rate and a standard
deviation of 50 days to make sure the prior is not very informative. We
used a Cauchy(0,1) distribution for the between-study heterogeneity.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># merge si_data and result_norm_wide for plotting</span></span>
<span><span class="va">df_merged</span> <span class="op">&lt;-</span> <span class="va">si_data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">study</span>, <span class="va">icc_interval</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">result_norm_wide</span>, by <span class="op">=</span> <span class="st">"study"</span>, relationship <span class="op">=</span> <span class="st">"many-to-many"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Perform a Bayesian meta-analysis</span></span>
<span><span class="va">df_ma</span> <span class="op">&lt;-</span> <span class="va">df_merged</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">study</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">slice</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>se <span class="op">=</span> <span class="va">sd</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">study</span>, <span class="va">n</span>, <span class="va">mean</span>, <span class="va">sd</span>, <span class="va">se</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># we will perform a Bayesian meta-analysis using the {brms} package</span></span>
<span><span class="co"># specify priors</span></span>
<span><span class="va">priors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">prior</span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">100</span>,<span class="fl">50</span><span class="op">)</span>, class <span class="op">=</span> <span class="va">Intercept</span><span class="op">)</span>,</span>
<span>            <span class="fu">prior</span><span class="op">(</span><span class="fu">cauchy</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, class <span class="op">=</span> <span class="va">sd</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit a random effects model</span></span>
<span><span class="va">m.brm</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  <span class="va">mean</span> <span class="op">|</span> <span class="fu">se</span><span class="op">(</span><span class="va">se</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">study</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df_ma</span>,</span>
<span>  prior <span class="op">=</span> <span class="va">priors</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">8000</span>, </span>
<span>  warmup <span class="op">=</span> <span class="fl">4000</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.999</span>, max_treedepth <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> </span>
<span><span class="op">)</span></span></code></pre></div>
<p>We can visualise the results using a forest plot.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create forest plot with posteriors</span></span>
<span></span>
<span><span class="co"># get posterior draws from each study</span></span>
<span><span class="va">study.draws</span> <span class="op">&lt;-</span> <span class="fu">spread_draws</span><span class="op">(</span><span class="va">m.brm</span>, <span class="va">r_study</span><span class="op">[</span><span class="va">study</span>,<span class="op">]</span>, <span class="va">b_Intercept</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>b_Intercept <span class="op">=</span> <span class="va">r_study</span> <span class="op">+</span> <span class="va">b_Intercept</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># get pooled posterior draws</span></span>
<span><span class="va">pooled.effect.draws</span> <span class="op">&lt;-</span> <span class="fu">spread_draws</span><span class="op">(</span><span class="va">m.brm</span>, <span class="va">b_Intercept</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>study <span class="op">=</span> <span class="st">"Pooled Effect"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># combine posterior draws from each study and pooled</span></span>
<span><span class="va">forest.data</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span><span class="va">study.draws</span>,</span>
<span>                         <span class="va">pooled.effect.draws</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>study <span class="op">=</span> <span class="fu">str_replace_all</span><span class="op">(</span><span class="va">study</span>, <span class="st">"[.]"</span>, <span class="st">" "</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>study <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/reorder.factor.html" class="external-link">reorder</a></span><span class="op">(</span><span class="va">study</span>, <span class="va">b_Intercept</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate mean and credible intervals</span></span>
<span><span class="va">forest.data.summary</span> <span class="op">&lt;-</span> <span class="fu">group_by</span><span class="op">(</span><span class="va">forest.data</span>, <span class="va">study</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mean_qi</span><span class="op">(</span><span class="va">b_Intercept</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot</span></span>
<span><span class="va">forest_plot</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">b_Intercept</span>,</span>
<span>           <span class="fu"><a href="https://rdrr.io/r/stats/relevel.html" class="external-link">relevel</a></span><span class="op">(</span><span class="va">study</span>, <span class="st">"Pooled Effect"</span>,</span>
<span>                   after <span class="op">=</span> <span class="cn">Inf</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       data <span class="op">=</span> <span class="va">forest.data</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="co"># Add vertical lines for pooled effect and CI</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu">fixef</span><span class="op">(</span><span class="va">m.brm</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">]</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"grey"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu">fixef</span><span class="op">(</span><span class="va">m.brm</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>             color <span class="op">=</span> <span class="st">"grey"</span>, linetype <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#geom_vline(xintercept = 0, color = "black",</span></span>
<span>  <span class="co">#           size = 1) +</span></span>
<span></span>
<span>  <span class="co"># Add densities</span></span>
<span>  <span class="fu">geom_density_ridges</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>                      rel_min_height <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>                      col <span class="op">=</span> <span class="cn">NA</span>, scale <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                      alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="fu">geom_pointinterval</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">study</span>,</span>
<span>                         x <span class="op">=</span> <span class="va">b_Intercept</span>,</span>
<span>                         xmin <span class="op">=</span> <span class="va">.lower</span>,</span>
<span>                         xmax <span class="op">=</span> <span class="va">.upper</span><span class="op">)</span>,</span>
<span>                     data <span class="op">=</span> <span class="va">forest.data.summary</span>,</span>
<span>                     size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                     orientation <span class="op">=</span> <span class="st">"horizontal"</span><span class="op">)</span> <span class="op">+</span></span>
<span></span>
<span>  <span class="co"># Add text and labels</span></span>
<span>  <span class="co"># geom_text(data = mutate_if(forest.data.summary,</span></span>
<span>  <span class="co">#                            is.numeric, round, 2),</span></span>
<span>  <span class="co">#           aes(label = glue("{b_Intercept} [{.lower}, {.upper}]"),</span></span>
<span>  <span class="co">#               x = Inf), hjust = "inward") +</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Mean Serial Interval (days)"</span>, <span class="co"># summary measure</span></span>
<span>       y <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    panel.grid.major <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,   <span class="co"># Remove major grid lines</span></span>
<span>    panel.grid.minor <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,   <span class="co"># Remove minor grid lines</span></span>
<span>    axis.line <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, <span class="co"># Add axis lines</span></span>
<span>    axis.ticks <span class="op">=</span> <span class="fu">element_line</span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span>, <span class="co"># Add axis ticks</span></span>
<span>    axis.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">12</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>, <span class="co"># Customize axis titles</span></span>
<span>    axis.text <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span> <span class="co"># Customize axis text</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">forest_plot</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reproduce_results_ainslie_et_al_files/figure-html/forest_plot-1.png" alt="Figure 2. Forest plot of the estimated mean serial interval (in days) for individual studies and the pooled effect. The posterior distributions for each study are shown as density ridges, with the pooled effect displayed at the bottom. Black points and horizontal lines represent the posterior mean and corresponding 95% credible intervals for each study and the pooled estimate. The solid vertical gray line indicates the pooled effect estimate, while the dashed gray lines represent its 95% credible interval." width="672"><p class="caption">
Figure 2. Forest plot of the estimated mean serial interval (in days)
for individual studies and the pooled effect. The posterior
distributions for each study are shown as density ridges, with the
pooled effect displayed at the bottom. Black points and horizontal lines
represent the posterior mean and corresponding 95% credible intervals
for each study and the pooled estimate. The solid vertical gray line
indicates the pooled effect estimate, while the dashed gray lines
represent its 95% credible interval.
</p>
</div>
</div>
</div>
<div class="section level3">
<h3 id="growth-rate-and-basic-reproduction-number-r_0">Growth Rate and Basic Reproduction Number
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>)<a class="anchor" aria-label="anchor" href="#growth-rate-and-basic-reproduction-number-r_0"></a>
</h3>
<div class="section level4">
<h4 id="growth-rate">Growth Rate<a class="anchor" aria-label="anchor" href="#growth-rate"></a>
</h4>
<p>We estimated the annual growth rate of scabies cases by fitting a
generalized linear model (GLM) with a log link and a quasipoisson family
to the annual cumulative incidence of scabies diagnoses per 1000 people
from 2011 to 2023 in the Netherlands<span class="citation"><sup>8</sup></span>. This approach accounts for the
overdispersion commonly observed in count data and allows for
non-integer values in the data. The GLM with a log link assumes an
exponential growth model, where the logarithm of the expected count of
scabies cases is linearly related to time and assumes quasipoisson
distributed errors.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># read in data set</span></span>
<span><span class="va">file_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"data/scabies_data_incidence_yearly.xlsx"</span>, </span>
<span>                         package <span class="op">=</span> <span class="st">"mitey"</span><span class="op">)</span></span>
<span><span class="va">scabies_inc_total</span> <span class="op">&lt;-</span> <span class="fu">read.xlsx</span><span class="op">(</span><span class="va">file_path</span>, sheet <span class="op">=</span> <span class="st">"total"</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># some data wrangling to make the column names nicer</span></span>
<span><span class="va">scabies_inc_total</span> <span class="op">&lt;-</span> <span class="va">scabies_inc_total</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">rename</span><span class="op">(</span>inc <span class="op">=</span> <span class="va">`Inc.per.1.000`</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>cases <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">inc</span><span class="op">)</span>,</span>
<span>         time <span class="op">=</span> <span class="va">Year</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="st">"time"</span>, <span class="st">"cases"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">scabies_inc_total</span> <span class="op">&lt;-</span> <span class="va">scabies_inc_total</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">cases</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.infinite</a></span><span class="op">(</span><span class="va">cases</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.infinite</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit an exponential model with Poisson errors</span></span>
<span><span class="va">poisson_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">cases</span> <span class="op">~</span> <span class="va">time</span>, </span>
<span>                     family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">quasipoisson</a></span><span class="op">(</span>link <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span>, </span>
<span>                     data <span class="op">=</span> <span class="va">scabies_inc_total</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate 95% confidence intervals for the model parameters</span></span>
<span><span class="va">ci_coeff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">poisson_model</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Fit to the original data ##</span></span>
<span></span>
<span><span class="co"># Calculate the fitted values on the linear scale (log scale)</span></span>
<span><span class="va">fitted_values_log</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">poisson_model</span>, newdata <span class="op">=</span> <span class="va">scabies_inc_total</span>, type <span class="op">=</span> <span class="st">"link"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get the standard errors of the fitted values</span></span>
<span><span class="va">se_fitted_log</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">poisson_model</span>, newdata <span class="op">=</span> <span class="va">scabies_inc_total</span>, type <span class="op">=</span> <span class="st">"link"</span>, se.fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">se.fit</span></span>
<span></span>
<span><span class="co"># Get the dispersion parameter (phi) from the quasipoisson model</span></span>
<span><span class="va">phi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">poisson_model</span><span class="op">)</span><span class="op">$</span><span class="va">dispersion</span></span>
<span></span>
<span><span class="co"># Adjust the standard errors by the dispersion parameter</span></span>
<span><span class="va">se_fitted_log_adjusted</span> <span class="op">&lt;-</span> <span class="va">se_fitted_log</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">phi</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate the confidence intervals for the fitted values on the log scale</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span>
<span><span class="va">z_value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">alpha</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>  <span class="co"># Z-value for 95% CI</span></span>
<span></span>
<span><span class="va">lower_log</span> <span class="op">&lt;-</span> <span class="va">fitted_values_log</span> <span class="op">-</span> <span class="va">z_value</span> <span class="op">*</span> <span class="va">se_fitted_log_adjusted</span></span>
<span><span class="va">upper_log</span> <span class="op">&lt;-</span> <span class="va">fitted_values_log</span> <span class="op">+</span> <span class="va">z_value</span> <span class="op">*</span> <span class="va">se_fitted_log_adjusted</span></span>
<span></span>
<span><span class="co"># Add these confidence intervals to the data frame</span></span>
<span><span class="va">scabies_inc_total</span><span class="op">$</span><span class="va">fitted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">fitted_values_log</span><span class="op">)</span></span>
<span><span class="va">scabies_inc_total</span><span class="op">$</span><span class="va">lower_fitted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lower_log</span><span class="op">)</span></span>
<span><span class="va">scabies_inc_total</span><span class="op">$</span><span class="va">upper_fitted</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">upper_log</span><span class="op">)</span></span></code></pre></div>
<p>Using the fitted quasipoisson model, we determined the projected
incidence of scabies per 1000 people until 2033, assuming no
interventions are implemented and that the growth rate remains constant.
We calculated 95% prediction intervals for the predicted incidence using
standard error values adjusted to takes into account the dispersion
parameter derived from the model, ensuring that our estimates
appropriately reflect the uncertainty in the predictions.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Extrapolate to future time ##</span></span>
<span><span class="va">future_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">scabies_inc_total</span><span class="op">$</span><span class="va">time</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>, </span>
<span>                   <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">scabies_inc_total</span><span class="op">$</span><span class="va">time</span><span class="op">)</span> <span class="op">+</span> <span class="fl">10</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">predicted_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">poisson_model</span>, </span>
<span>                            newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>time <span class="op">=</span> <span class="va">future_time</span><span class="op">)</span>, </span>
<span>                            type <span class="op">=</span> <span class="st">"response"</span>, </span>
<span>                            se.fit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract predicted values and standard errors</span></span>
<span><span class="va">predicted_values</span> <span class="op">&lt;-</span> <span class="va">predicted_model</span><span class="op">$</span><span class="va">fit</span></span>
<span><span class="va">standard_errors</span> <span class="op">&lt;-</span> <span class="va">predicted_model</span><span class="op">$</span><span class="va">se.fit</span></span>
<span></span>
<span><span class="co"># Calculate confidence intervals using the dispersion parameter</span></span>
<span><span class="va">lower_ci</span> <span class="op">&lt;-</span> <span class="va">predicted_values</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">z_value</span> <span class="op">*</span> <span class="va">standard_errors</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">phi</span><span class="op">)</span> <span class="op">/</span> <span class="va">predicted_values</span><span class="op">)</span></span>
<span><span class="va">upper_ci</span> <span class="op">&lt;-</span> <span class="va">predicted_values</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">z_value</span> <span class="op">*</span> <span class="va">standard_errors</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">phi</span><span class="op">)</span> <span class="op">/</span> <span class="va">predicted_values</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a data frame to hold the results</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  time <span class="op">=</span> <span class="va">future_time</span>,</span>
<span>  fitted <span class="op">=</span> <span class="va">predicted_values</span>,</span>
<span>  lower <span class="op">=</span> <span class="va">lower_ci</span>,</span>
<span>  upper <span class="op">=</span> <span class="va">upper_ci</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"Extrapolated Data"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine original and extrapolated data for plotting</span></span>
<span><span class="va">scabies_plot_df</span> <span class="op">&lt;-</span> <span class="fu">bind_rows</span><span class="op">(</span></span>
<span>  <span class="va">scabies_inc_total</span> <span class="op">%&gt;%</span> </span>
<span>    <span class="fu">mutate</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"Original Data"</span>, lower <span class="op">=</span> <span class="va">lower_fitted</span>, upper <span class="op">=</span> <span class="va">upper_fitted</span><span class="op">)</span>,</span>
<span>  <span class="va">results</span></span>
<span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span> <span class="op">-</span><span class="va">lower_fitted</span>, <span class="op">-</span><span class="va">upper_fitted</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">scabies_plot_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">scabies_plot_df</span><span class="op">)</span></span>
<span><span class="co">#&gt;   time cases    fitted          type     lower     upper</span></span>
<span><span class="co">#&gt; 1 2011   0.6 0.4049279 Original Data 0.3320161 0.4938515</span></span>
<span><span class="co">#&gt; 2 2012   0.6 0.5187109 Original Data 0.4338097 0.6202281</span></span>
<span><span class="co">#&gt; 3 2013   0.9 0.6644663 Original Data 0.5666397 0.7791822</span></span>
<span><span class="co">#&gt; 4 2014   1.0 0.8511784 Original Data 0.7398216 0.9792966</span></span>
<span><span class="co">#&gt; 5 2015   1.2 1.0903558 Original Data 0.9653198 1.2315874</span></span>
<span><span class="co">#&gt; 6 2016   1.7 1.3967409 Original Data 1.2583268 1.5503805</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Define the custom palette</span></span>
<span><span class="va">custom_palette</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Original Data"</span> <span class="op">=</span> <span class="st">"#440154"</span>,</span>
<span>                    <span class="st">"Extrapolated Data"</span> <span class="op">=</span> <span class="st">"#21908C"</span><span class="op">)</span></span>
<span><span class="co">#custom_palette &lt;- c("#21908C", "#440154") # Custom colors</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span>data <span class="op">=</span> <span class="va">scabies_plot_df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">time</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">cases</span><span class="op">)</span>, color <span class="op">=</span> <span class="va">type</span>, fill <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Points for the original data</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">scabies_plot_df</span>, <span class="va">type</span> <span class="op">==</span> <span class="st">"Original Data"</span><span class="op">)</span>,</span>
<span>    <span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">cases</span><span class="op">)</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">2</span>, shape <span class="op">=</span> <span class="fl">16</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Line for both original fitted and extrapolated data</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>data <span class="op">=</span> <span class="va">scabies_plot_df</span>,<span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">fitted</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Ribbon for confidence intervals for both original and extrapolated data</span></span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span></span>
<span>    <span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">lower</span><span class="op">)</span>, ymax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">upper</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">type</span><span class="op">)</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.2</span>, color <span class="op">=</span> <span class="cn">NA</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Labels and theme</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Year"</span>, y <span class="op">=</span> <span class="st">"Incidence per 1000 people (log scale)"</span>,</span>
<span>       color <span class="op">=</span> <span class="st">"Data Type"</span>, fill <span class="op">=</span> <span class="st">"Data Type"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">custom_palette</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="va">custom_palette</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#scale_y_log10() +  # Log scale for y-axis</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>        axis.text.y <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="reproduce_results_ainslie_et_al_files/figure-html/growth_rate_fig-1.png" alt="Figure 3. Annual scabies incidence per 1000 people from 2011 to 2023 (points) and then projected scabies indcidence per 1000 people for 2024 to 2033 (line) using an exponential growth model with annual growth rate of 0.25 (95% CI: 0.20, 0.30) cases per 1000 people. Shaded regions represent 95% prediction intervals for projected scabies incidence. The y-axis is displayed on the log-scale and represents the natural log of scabies incidence per 1000 people." width="100%"><p class="caption">
Figure 3. Annual scabies incidence per 1000 people from 2011 to 2023
(points) and then projected scabies indcidence per 1000 people for 2024
to 2033 (line) using an exponential growth model with annual growth rate
of 0.25 (95% CI: 0.20, 0.30) cases per 1000 people. Shaded regions
represent 95% prediction intervals for projected scabies incidence. The
y-axis is displayed on the log-scale and represents the natural log of
scabies incidence per 1000 people.
</p>
</div>
</div>
<div class="section level4">
<h4 id="basic-reproduction-number-r_0">Basic Reproduction Number
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>R</mi><mn>0</mn></msub><annotation encoding="application/x-tex">R_0</annotation></semantics></math>)<a class="anchor" aria-label="anchor" href="#basic-reproduction-number-r_0"></a>
</h4>
<p>Using the estimated annual growth rate, we can estimate the basic
reproduction number as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>0</mn></msub><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>r</mi><mo>*</mo><mi>T</mi><mi>–</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mi>/</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>r</mi><mn>2</mn></msup><msup><mi>s</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">R_0 = \exp(r*T – (1/2) r^2 s^2)</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>
is the annual growth rate,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>
is the mean generation time (in years), and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>s</mi><mn>2</mn></msup><annotation encoding="application/x-tex">s^2</annotation></semantics></math>
is the variance of the generation time distribution<span class="citation"><sup>9</sup></span>. We assume that nearly everyone
exposed has not been previously infected.</p>
</div>
</div>
<div class="section level3">
<h3 id="time-varying-reproduction-number">Time-varying Reproduction Number<a class="anchor" aria-label="anchor" href="#time-varying-reproduction-number"></a>
</h3>
<p>To estimate time-varying case reproduction number, we first randomly
assigned each scabies consultation a date of diagnosis in the week in
which the consultation is reported. Since scabies is very hard to
diagnose prior to symptom onset<span class="citation"><sup>10</sup></span>, and scabies consultations are
captured as part of sentinel surveillance based on GP consultations<span class="citation"><sup>8</sup></span>, we use the date of consultation
rather than the date of symptom onset.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># read in consultations data </span></span>
<span><span class="va">file_path2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"data/scabies_data_consultations_weekly.xlsx"</span>, </span>
<span>                          package <span class="op">=</span> <span class="st">"mitey"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nivel_wkly_data</span> <span class="op">&lt;-</span> <span class="fu">read.xlsx</span><span class="op">(</span><span class="va">file_path2</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># fix/translate variable names</span></span>
<span>  <span class="fu">rename</span><span class="op">(</span>diagnosis_code <span class="op">=</span> <span class="va">`Diagnose.(ICPC)`</span>,</span>
<span>         year <span class="op">=</span> <span class="va">`ISO-jaar`</span>,</span>
<span>         week_num <span class="op">=</span> <span class="va">`ISO-weeknr.(ma-zo)`</span>,</span>
<span>         pop_size <span class="op">=</span> <span class="va">`Aantal.populatie`</span>,</span>
<span>         cases <span class="op">=</span> <span class="va">`Aantal.prevalente.cases`</span>,</span>
<span>         prev_per_100000 <span class="op">=</span> <span class="va">`Prevalentie.per.100.000`</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># drop diagnosis var</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">diagnosis_code</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="co"># create new var that combines year and week</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>yr_wk <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">year</span>, <span class="va">week_num</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span>,</span>
<span>         year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nivel_daily_data</span> <span class="op">&lt;-</span> <span class="va">nivel_wkly_data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">uncount</span><span class="op">(</span><span class="va">cases</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># Repeat rows based on the number of cases</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    iso_week <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">year</span>, <span class="st">"-W"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%02d"</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">week_num</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    first_day <span class="op">=</span> <span class="fu">ISOweek2date</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">iso_week</span>, <span class="st">"-1"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    random_day <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">6</span>, <span class="fu">n</span><span class="op">(</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    onset_date <span class="op">=</span> <span class="va">first_day</span> <span class="op">+</span> <span class="fu">days</span><span class="op">(</span><span class="va">random_day</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">iso_week</span>, <span class="op">-</span><span class="va">first_day</span>, <span class="op">-</span><span class="va">random_day</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Group data by onset_date and calculate the daily incidence</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="va">nivel_daily_data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">onset_date</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>count <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">distinct</span><span class="op">(</span><span class="va">onset_date</span>, <span class="va">count</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">arrange</span><span class="op">(</span><span class="va">onset_date</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>num_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">onset_date</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">rename</span><span class="op">(</span>inc <span class="op">=</span> <span class="va">count</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">onset_date</span>, <span class="va">inc</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">onset_date</span>, y <span class="op">=</span> <span class="va">inc</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_col</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#geom_smooth(method = "loess", color = "red", se = FALSE) +</span></span>
<span>  <span class="fu">scale_x_date</span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 year"</span>, date_labels <span class="op">=</span> <span class="st">"%Y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Date of Consultation"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Number of scabies consultations per 100,000 people"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="reproduce_results_ainslie_et_al_files/figure-html/epidemic_curve-1.png" alt="Figure 4. Number of scabies consultations per week per 100,000 people in the Netherlands by date of consultation." width="100%"><p class="caption">
Figure 4. Number of scabies consultations per week per 100,000 people in
the Netherlands by date of consultation.
</p>
</div>
<p>Using the constructed daily time series of date of diagnosis, we
applied the method proposed by Wallinga and Lipsitch (Eq. 4.1)<span class="citation"><sup>9</sup></span> to estimate the time-varying daily
case reproduction number. The method of Wallinga and Lipsitch estimates
the time-varying case reproduction number by determining the likelihood
of an event occurring for every pair of time points<span class="citation"><sup>9</sup></span>. The method requires the
specification of the serial interval distribution. We assumed a normal
serial interval distribution with mean 123.24 days and standard
deviation 31.55 days, as estimated above. Due to unobserved onward cases
at the end of the time series, we adjusted for right truncation by
applying a correction factor that accounts for unobserved cases with
longer serial intervals. To obtain 95% confidence intervals on the daily
case reproduction number, we generated 100 bootstrapped samples by
resampling each case with replacement and reconstructing the incidence
time series for each bootstrapped sample. Reproduction number estimates
were then smoothed using a rolling average of 6 weeks.</p>
<div class="figure">
<img src="reproduce_results_ainslie_et_al_files/figure-html/rt_plot-1.png" alt="Figure 5. Time-varying case reproduction number of scabies transmission. Colored bands denote season. Winter = December 1 – February 28 (or 29 on leap year); Spring = March 1 – May 31; Summer = June 1 – August 31; Autumn = September 1 – November 31. Shaded region represents the 95% confidence envelope. Black horizontal dashed line indicates R = 1." width="100%"><p class="caption">
Figure 5. Time-varying case reproduction number of scabies transmission.
Colored bands denote season. Winter = December 1 – February 28 (or 29 on
leap year); Spring = March 1 – May 31; Summer = June 1 – August 31;
Autumn = September 1 – November 31. Shaded region represents the 95%
confidence envelope. Black horizontal dashed line indicates R = 1.
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body" entry-spacing="0" line-spacing="2">
<div id="ref-ariza2013" class="csl-entry">
<div class="csl-left-margin">1. </div>
<div class="csl-right-inline">Ariza, L. <em>et al.</em> Investigation of a
scabies outbreak in a kindergarten in constance, germany. <em>Eur. J.
Clin. Microbiol. Infect. Dis.</em> <strong>32</strong>, 373–380
(2013).</div>
</div>
<div id="ref-kaburi2019" class="csl-entry">
<div class="csl-left-margin">2. </div>
<div class="csl-right-inline">Kaburi, B. B. <em>et al.</em> Outbreak of
scabies among preschool children, accra, ghana, 2017. <em>BMC Public
Health</em> <strong>19</strong>, 746 (2019).</div>
</div>
<div id="ref-tjon-kon-fat2021" class="csl-entry">
<div class="csl-left-margin">3. </div>
<div class="csl-right-inline">Tjon-Kon-Fat, R. <em>et al.</em> Short report:
The potential of <span>PCR</span> on skin flakes from bed linens for
diagnosis of scabies in an outbreak. <em>PLoS Negl. Trop. Dis.</em>
<strong>15</strong>, e0009485 (2021).</div>
</div>
<div id="ref-akunzirwe2023" class="csl-entry">
<div class="csl-left-margin">4. </div>
<div class="csl-right-inline">Akunzirwe, R. <em>et al.</em> An outbreak of
scabies in a fishing community in hoima district, uganda,
<span>February−June</span>, 2022. <em>Research Square</em> (2023).</div>
</div>
<div id="ref-vink2014" class="csl-entry">
<div class="csl-left-margin">5. </div>
<div class="csl-right-inline">Vink, M. A., Bootsma, M. C. J. &amp; Wallinga,
J. Serial intervals of respiratory infectious diseases: A systematic
review and analysis. <em>Am. J. Epidemiol.</em> <strong>180</strong>,
865–875 (2014).</div>
</div>
<div id="ref-burkner2017" class="csl-entry">
<div class="csl-left-margin">6. </div>
<div class="csl-right-inline">Bürkner, P.-C. Brms: An <span>R</span> package
for bayesian multilevel models using stan. <em>J. Stat. Softw.</em>
<strong>80</strong>, 1–28 (2017).</div>
</div>
<div id="ref-harrer" class="csl-entry">
<div class="csl-left-margin">7. </div>
<div class="csl-right-inline">Harrer, M., Cuijpers, P., Furukawa, T. A. &amp;
Ebert, D. D. Chapter 13 bayesian <span>Meta-Analysis</span>.</div>
</div>
<div id="ref-nivel" class="csl-entry">
<div class="csl-left-margin">8. </div>
<div class="csl-right-inline">NIVEL. Cijfers ziekten per week in
nederland.</div>
</div>
<div id="ref-wallinga2007" class="csl-entry">
<div class="csl-left-margin">9. </div>
<div class="csl-right-inline">Wallinga, J. &amp; Lipsitch, M. How generation
intervals shape the relationship between growth rates and reproductive
numbers. <em>Proc. Biol. Sci.</em> <strong>274</strong>, 599–604
(2007).</div>
</div>
<div id="ref-mellanby1972" class="csl-entry">
<div class="csl-left-margin">10. </div>
<div class="csl-right-inline">Mellanby, K. <em>Scabies</em>. (EW Classey,
Faringdon, England, 1972).</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="appendix">Appendix<a class="anchor" aria-label="anchor" href="#appendix"></a>
</h2>
<div class="section level3">
<h3 id="sensitivity-analyses">Sensitivity Analyses<a class="anchor" aria-label="anchor" href="#sensitivity-analyses"></a>
</h3>
<div class="section level4">
<h4 id="serial-interval-1">Serial Interval<a class="anchor" aria-label="anchor" href="#serial-interval-1"></a>
</h4>
<p>We performed a sensitivity analysis on the underlying distribution of
serial interval. In the main analysis we assumed the serial interval was
normally distributed. In the sensitivity analysis we assumed the serial
interval was Gamma distributed. The estimated mean and standard
deviation of serial interval for each study is shown in Table S1
<!--\@ref(tab:si_sa)-->. When assuming an underlying Gamma distribution,
the standard deviations were higher than when assuming an underlying
Normal distribution. We see from Figure S1
<!--\@ref(fig:gam_si_plots)--> that the Gamma distribution does not fit
the data well. It is possible that the Gamma distribution fits scabies
data poorly due to the long incubation period of scabies and the
possibility of negative serial intervals.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># assume a gamma distribution</span></span>
<span><span class="va">result_gam</span> <span class="op">&lt;-</span> <span class="va">si_data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">icc_interval</span>, <span class="va">study</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">study</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">summarise</span><span class="op">(</span>result <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/si_estim.html">si_estim</a></span><span class="op">(</span><span class="va">icc_interval</span>, dist <span class="op">=</span> <span class="st">"gamma"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="fu">map_dbl</span><span class="op">(</span><span class="va">result</span>, <span class="st">"mean"</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu">map_dbl</span><span class="op">(</span><span class="va">result</span>, <span class="st">"sd"</span><span class="op">)</span>,</span>
<span>    wts <span class="op">=</span> <span class="fu">map</span><span class="op">(</span><span class="va">result</span>, <span class="st">"wts"</span><span class="op">)</span>  <span class="co"># Store wts as a list-column</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">result</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">unnest</span><span class="op">(</span><span class="va">wts</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># Unnest the wts column if needed %&gt;%</span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mean</span>, <span class="va">sd</span>, <span class="va">wts</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"statistic"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"value"</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">study</span>, <span class="va">statistic</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span></span>
<span>    occurrence <span class="op">=</span> <span class="fu">row_number</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    statistic <span class="op">=</span> <span class="fu">if_else</span><span class="op">(</span><span class="va">statistic</span> <span class="op">==</span> <span class="st">"wts"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"weight_"</span>, <span class="va">occurrence</span><span class="op">)</span>, <span class="va">statistic</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">statistic</span> <span class="op">!=</span> <span class="st">"mean"</span> <span class="op">|</span> <span class="va">occurrence</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">statistic</span> <span class="op">!=</span> <span class="st">"sd"</span> <span class="op">|</span> <span class="va">occurrence</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="op">-</span><span class="va">occurrence</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">ungroup</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot serial interval curves</span></span>
<span><span class="co"># Reshape results from long to wide format</span></span>
<span><span class="va">result_gam_wide</span> <span class="op">&lt;-</span> <span class="va">result_gam</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_wider</span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">statistic</span>,</span>
<span>    values_from <span class="op">=</span> <span class="va">value</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">si_tab_sa</span> <span class="op">&lt;-</span> <span class="fu">left_join</span><span class="op">(</span><span class="va">result_norm_wide</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span>, <span class="va">result_gam_wide</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">]</span>, by <span class="op">=</span> <span class="st">"study"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">study</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Kaburi et al."</span>, <span class="st">"Ariza et al."</span>, <span class="st">"Akunzirwe et al."</span>,</span>
<span>                      <span class="st">"Tjon-Kon-Fat et al"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tab_si_gam</span> <span class="op">&lt;-</span> <span class="va">si_tab_sa</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">gt</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">tab_spanner</span><span class="op">(</span></span>
<span>    label <span class="op">=</span> <span class="st">"Normal"</span>,</span>
<span>    columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mean.x</span>, <span class="va">sd.x</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">tab_spanner</span><span class="op">(</span></span>
<span>    label <span class="op">=</span> <span class="st">"Gamma"</span>,</span>
<span>    columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mean.y</span>, <span class="va">sd.y</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">cols_label</span><span class="op">(</span></span>
<span>    study <span class="op">=</span> <span class="st">"Study"</span>,</span>
<span>    mean.x <span class="op">=</span> <span class="st">"Mean"</span>,</span>
<span>    sd.x <span class="op">=</span> <span class="st">"SD"</span>,</span>
<span>    mean.y <span class="op">=</span> <span class="st">"Mean"</span>,</span>
<span>    sd.y <span class="op">=</span> <span class="st">"SD"</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">tab_style</span><span class="op">(</span></span>
<span>    style <span class="op">=</span> <span class="fu">cell_borders</span><span class="op">(</span>sides <span class="op">=</span> <span class="st">"top"</span>, weight <span class="op">=</span> <span class="fu">px</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    locations <span class="op">=</span> <span class="fu">cells_column_labels</span><span class="op">(</span><span class="fu">everything</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">tab_style</span><span class="op">(</span></span>
<span>    style <span class="op">=</span> <span class="fu">cell_borders</span><span class="op">(</span>sides <span class="op">=</span> <span class="st">"bottom"</span>, weight <span class="op">=</span> <span class="fu">px</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    locations <span class="op">=</span> <span class="fu">cells_column_labels</span><span class="op">(</span><span class="fu">everything</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">tab_style</span><span class="op">(</span></span>
<span>    style <span class="op">=</span> <span class="fu">cell_borders</span><span class="op">(</span>sides <span class="op">=</span> <span class="st">"bottom"</span>, weight <span class="op">=</span> <span class="fu">px</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    locations <span class="op">=</span> <span class="fu">cells_body</span><span class="op">(</span>rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">si_tab_sa</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">tab_footnote</span><span class="op">(</span></span>
<span>    footnote <span class="op">=</span> <span class="st">"SD = standard deviation"</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">tab_options</span><span class="op">(</span></span>
<span>    table.width <span class="op">=</span> <span class="fu">pct</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">tab_si_gam</span>, <span class="st">"caption"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="st">"Table S1. Estimated mean and standard deviation of serial interval from different studies assuming a Normal distribution or Gamma distribution."</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># merge si_data and result_norm_wide for plotting</span></span>
<span><span class="va">df_merged_gam</span> <span class="op">&lt;-</span> <span class="va">si_data</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">study</span>, <span class="va">icc_interval</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">left_join</span><span class="op">(</span><span class="va">result_gam_wide</span>, by <span class="op">=</span> <span class="st">"study"</span>, relationship <span class="op">=</span> <span class="st">"many-to-many"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Apply the plot_si_fit function by study</span></span>
<span><span class="va">plots_gam</span> <span class="op">&lt;-</span> <span class="va">df_merged_gam</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">study</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_map</span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="../reference/plot_si_fit.html">plot_si_fit</a></span><span class="op">(</span></span>
<span>    dat <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">icc_interval</span>,</span>
<span>    mean <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    sd <span class="op">=</span> <span class="va">.x</span><span class="op">$</span><span class="va">sd</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">.x</span><span class="op">$</span><span class="va">weight_1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">.x</span><span class="op">$</span><span class="va">weight_2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">.x</span><span class="op">$</span><span class="va">weight_4</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    dist <span class="op">=</span> <span class="st">"gamma"</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Annotate plots with study names and labels</span></span>
<span><span class="va">group_order_gam</span> <span class="op">&lt;-</span> <span class="va">df_merged_gam</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">study</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">group_keys</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">labeled_plots_gam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">plots_gam</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">plots_gam</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">+</span></span>
<span>    <span class="fu">ggtitle</span><span class="op">(</span><span class="va">group_order_gam</span><span class="op">[</span><span class="va">i</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span>            <span class="co"># Add study names as titles</span></span>
<span>    <span class="fu">theme</span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Center the title</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine plots into a multi-pane figure</span></span>
<span><span class="va">final_plot_gam</span> <span class="op">&lt;-</span> <span class="fu">plot_grid</span><span class="op">(</span></span>
<span>  plotlist <span class="op">=</span> <span class="va">labeled_plots_gam</span>,</span>
<span>  labels <span class="op">=</span> <span class="st">"AUTO"</span>,      <span class="co"># Automatically adds labels (A, B, C, etc.)</span></span>
<span>  label_size <span class="op">=</span> <span class="fl">14</span>,      <span class="co"># Size of the labels</span></span>
<span>  ncol <span class="op">=</span> <span class="fl">2</span>              <span class="co"># Number of columns; adjust as needed</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the final combined plot</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">final_plot_gam</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="reproduce_results_ainslie_et_al_files/figure-html/gam_si_plots-1.png" alt="Figure S1. Epidemic curves and estimated serial interval distributions from four scabies outbreaks. Red line indicates estimated serial interval density assuming an underlying gamma distribution." width="672" id="fig-gam-si-plots-1"><p class="caption">
Figure S1. Epidemic curves and estimated serial interval distributions
from four scabies outbreaks. Red line indicates estimated serial
interval density assuming an underlying gamma distribution.
</p>
</div>
<p>We performed a sensitivity analysis in which we altered our choice of
prior distribution for mean serial interval. In the main analysis we
assumed a prior distribution of N(100,50). In the sensitivity analysis
we assumed a prior distribution of N(50, 75) and N(150, 50). We obtained
similar estimates of the pooled mean serial interval under the
alternative prior distributions (Table
S2<!--\@ref(tab:prior_sa_tab)-->).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># specify alternative priors</span></span>
<span><span class="va">priors2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">prior</span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">50</span>,<span class="fl">75</span><span class="op">)</span>, class <span class="op">=</span> <span class="va">Intercept</span><span class="op">)</span>,</span>
<span>            <span class="fu">prior</span><span class="op">(</span><span class="fu">cauchy</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, class <span class="op">=</span> <span class="va">sd</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fit a random effects model</span></span>
<span><span class="co"># Fit the random effects model with adjusted control parameters</span></span>
<span><span class="va">m.brm2</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  <span class="va">mean</span> <span class="op">|</span> <span class="fu">se</span><span class="op">(</span><span class="va">se</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">study</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df_ma</span>,</span>
<span>  prior <span class="op">=</span> <span class="va">priors2</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">8000</span>,  <span class="co"># Increased number of iterations</span></span>
<span>  warmup <span class="op">=</span> <span class="fl">4000</span>,  <span class="co"># Increased warmup</span></span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.999</span>, max_treedepth <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>  <span class="co"># Increased adapt_delta and max_treedepth</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># specify alternative priors</span></span>
<span><span class="va">priors3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">prior</span><span class="op">(</span><span class="fu">normal</span><span class="op">(</span><span class="fl">150</span>,<span class="fl">75</span><span class="op">)</span>, class <span class="op">=</span> <span class="va">Intercept</span><span class="op">)</span>,</span>
<span>            <span class="fu">prior</span><span class="op">(</span><span class="fu">cauchy</span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, class <span class="op">=</span> <span class="va">sd</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fit a random effects model</span></span>
<span><span class="co"># Fit the random effects model with adjusted control parameters</span></span>
<span><span class="va">m.brm3</span> <span class="op">&lt;-</span> <span class="fu">brm</span><span class="op">(</span></span>
<span>  <span class="va">mean</span> <span class="op">|</span> <span class="fu">se</span><span class="op">(</span><span class="va">se</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">study</span><span class="op">)</span>,</span>
<span>  data <span class="op">=</span> <span class="va">df_ma</span>,</span>
<span>  prior <span class="op">=</span> <span class="va">priors3</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">8000</span>,  <span class="co"># Increased number of iterations</span></span>
<span>  warmup <span class="op">=</span> <span class="fl">4000</span>,  <span class="co"># Increased warmup</span></span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>adapt_delta <span class="op">=</span> <span class="fl">0.999</span>, max_treedepth <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>  <span class="co"># Increased adapt_delta and max_treedepth</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results_tab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Prior <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"N(100, 50)"</span>, <span class="st">"N(50, 75)"</span>, <span class="st">"N(150, 50)"</span><span class="op">)</span>,</span>
<span>  Mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">123.24</span>, <span class="fl">120.87</span>, <span class="fl">127.15</span><span class="op">)</span>,</span>
<span>  SD <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">31.55</span>, <span class="fl">32.22</span>, <span class="fl">31.73</span><span class="op">)</span></span>
<span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># convert to gt table</span></span>
<span><span class="va">results_gt</span> <span class="op">&lt;-</span> <span class="va">results_tab</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">gt</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">cols_label</span><span class="op">(</span></span>
<span>    Prior <span class="op">=</span> <span class="st">"Prior"</span>,</span>
<span>    Mean <span class="op">=</span> <span class="st">"Mean"</span>,</span>
<span>    SD <span class="op">=</span> <span class="st">"SD"</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">tab_style</span><span class="op">(</span></span>
<span>    style <span class="op">=</span> <span class="fu">cell_borders</span><span class="op">(</span>sides <span class="op">=</span> <span class="st">"top"</span>, weight <span class="op">=</span> <span class="fu">px</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    locations <span class="op">=</span> <span class="fu">cells_column_labels</span><span class="op">(</span><span class="fu">everything</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">tab_style</span><span class="op">(</span></span>
<span>    style <span class="op">=</span> <span class="fu">cell_borders</span><span class="op">(</span>sides <span class="op">=</span> <span class="st">"bottom"</span>, weight <span class="op">=</span> <span class="fu">px</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    locations <span class="op">=</span> <span class="fu">cells_column_labels</span><span class="op">(</span><span class="fu">everything</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">tab_style</span><span class="op">(</span></span>
<span>    style <span class="op">=</span> <span class="fu">cell_borders</span><span class="op">(</span>sides <span class="op">=</span> <span class="st">"bottom"</span>, weight <span class="op">=</span> <span class="fu">px</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    locations <span class="op">=</span> <span class="fu">cells_body</span><span class="op">(</span>rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">results_tab</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">tab_options</span><span class="op">(</span></span>
<span>    table.width <span class="op">=</span> <span class="fu">pct</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">results_tab</span></span>
<span><span class="co">#&gt;        Prior   Mean    SD</span></span>
<span><span class="co">#&gt; 1 N(100, 50) 123.24 31.55</span></span>
<span><span class="co">#&gt; 2  N(50, 75) 120.87 32.22</span></span>
<span><span class="co">#&gt; 3 N(150, 50) 127.15 31.73</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="time-varying-reproduction-number-1">Time-varying Reproduction Number<a class="anchor" aria-label="anchor" href="#time-varying-reproduction-number-1"></a>
</h4>
<p>In the main analysis, when we estimate the time-varying reproduction
number, we assume an underlying Normal distriubtion. However, because we
are using the serial interval distribution as an approximation of the
generation interval, which is strictly positive, we performed a
sensitivity analysis in which we assumed the serial interval
distribution is Gamma distributed with the same mean and variance
(Figure S3).</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read in data</span></span>
<span><span class="va">file_path4</span> <span class="op">&lt;-</span>  <span class="fu">here</span><span class="op">(</span><span class="st">"vignettes"</span>, <span class="st">"data"</span>, <span class="st">"rt_df_for_plot.rds"</span><span class="op">)</span></span>
<span><span class="va">rt_df_for_plot_sa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="va">file_path4</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">rt</span><span class="op">)</span>,</span>
<span>         <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.nan</a></span><span class="op">(</span><span class="va">rt</span><span class="op">)</span></span>
<span>         <span class="op">)</span></span>
<span></span>
<span><span class="co"># SA plot -------</span></span>
<span><span class="va">start_breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2011-01-01"</span><span class="op">)</span>,</span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2011-03-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">rt_df_for_plot_sa</span><span class="op">$</span><span class="va">onset_date</span>, <span class="fl">1</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"quarter"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">end_breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">start_breaks</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">rt_df_for_plot_sa</span><span class="op">$</span><span class="va">onset_date</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rects</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>xstart <span class="op">=</span> <span class="va">start_breaks</span>,</span>
<span>                    xend <span class="op">=</span> <span class="va">end_breaks</span>,</span>
<span>                    season <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"winter"</span>, <span class="st">"spring"</span>, <span class="st">"summer"</span>, <span class="st">"autumn"</span><span class="op">)</span>,</span>
<span>                                          length.out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">start_breaks</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                    levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"winter"</span>, <span class="st">"spring"</span>, <span class="st">"summer"</span>, <span class="st">"autumn"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">roll_days</span> <span class="op">&lt;-</span> <span class="fl">42</span></span>
<span></span>
<span><span class="va">p_sa</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_rect</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rects</span>, <span class="fu">aes</span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">xstart</span>, xmax <span class="op">=</span> <span class="va">xend</span>, ymin <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, ymax <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>                              fill <span class="op">=</span> <span class="va">season</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">0.4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_fill_viridis_d</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rt_df_for_plot</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">onset_date</span>, y <span class="op">=</span> <span class="fu">rollmean</span><span class="op">(</span><span class="va">rt_adjusted</span>, <span class="va">roll_days</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>, </span>
<span>            color <span class="op">=</span> <span class="st">"blue"</span>, linetype <span class="op">=</span> <span class="st">"solid"</span>, linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rt_df_for_plot_sa</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">onset_date</span>,</span>
<span>                                       y <span class="op">=</span> <span class="fu">rollmean</span><span class="op">(</span><span class="va">rt_adjusted</span>, <span class="va">roll_days</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_ribbon</span><span class="op">(</span>data <span class="op">=</span> <span class="va">rt_df_for_plot_sa</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">onset_date</span>,</span>
<span>                                         ymin <span class="op">=</span> <span class="fu">rollmean</span><span class="op">(</span><span class="va">lower_rt_adjusted</span>, <span class="va">roll_days</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span>,</span>
<span>                                         ymax <span class="op">=</span> <span class="fu">rollmean</span><span class="op">(</span><span class="va">upper_rt_adjusted</span>, <span class="va">roll_days</span>, fill <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"black"</span>, linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">scale_x_date</span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 year"</span>, date_labels <span class="op">=</span> <span class="st">"%Y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Date of Symptom Onset"</span>, y <span class="op">=</span> <span class="st">"Reproduction Number"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">coord_cartesian</span><span class="op">(</span>ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span></span>
<span>    panel.background <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">p_sa</span></span></code></pre></div>
<div class="figure">
<img src="reproduce_results_ainslie_et_al_files/figure-html/rt_gamma_sa-1.png" alt="Figure S3. Time-varying reproduction number of scabies transmission assuming a Gamma distributed serial interval distribution (black line). The time-varying reproduction number estimates assuming an underlying normal serial interval distribution are shown as the blue line. Colored bands denote season. Winter = December 1 – February 28 (or 29 on leap year); Spring = March 1 – May 31; Summer = June 1 – August 31; Autumn = September 1 – November 31." width="100%"><p class="caption">
Figure S3. Time-varying reproduction number of scabies transmission
assuming a Gamma distributed serial interval distribution (black line).
The time-varying reproduction number estimates assuming an underlying
normal serial interval distribution are shown as the blue line. Colored
bands denote season. Winter = December 1 – February 28 (or 29 on leap
year); Spring = March 1 – May 31; Summer = June 1 – August 31; Autumn =
September 1 – November 31.
</p>
</div>
</div>
<div class="section level4">
<h4 id="annual-incidence-by-age-group">Annual Incidence by Age Group<a class="anchor" aria-label="anchor" href="#annual-incidence-by-age-group"></a>
</h4>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">scabies_inc_age</span> <span class="op">&lt;-</span> <span class="fu">read.xlsx</span><span class="op">(</span><span class="va">file_path</span>, sheet <span class="op">=</span> <span class="st">"Scabies inc per 1.000 by age gr"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">df_inc_age</span> <span class="op">&lt;-</span> <span class="va">scabies_inc_age</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">pivot_longer</span><span class="op">(</span><span class="op">-</span><span class="va">Year</span>, names_to <span class="op">=</span> <span class="st">"Age Group"</span>, names_pattern <span class="op">=</span> <span class="st">"(.*)\\.year"</span>, values_to <span class="op">=</span> <span class="st">"Incidence"</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>Incidence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">Incidence</span><span class="op">)</span>,</span>
<span>         `Age Group` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">`Age Group`</span>, </span>
<span>                              levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0-4"</span>, <span class="st">"5-9"</span>, <span class="st">"10-14"</span>, <span class="st">"15-19"</span>, <span class="st">"20-24"</span>, </span>
<span>                                         <span class="st">"25-29"</span>, <span class="st">"30-34"</span>, <span class="st">"35-39"</span>, <span class="st">"40-44"</span>, <span class="st">"45-49"</span>, </span>
<span>                                         <span class="st">"50-54"</span>, <span class="st">"55-59"</span>, <span class="st">"60-64"</span>, <span class="st">"65+"</span><span class="op">)</span><span class="op">)</span></span>
<span>         <span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot</span><span class="op">(</span><span class="va">df_inc_age</span>, <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">Year</span>, y <span class="op">=</span> <span class="va">Incidence</span>, color <span class="op">=</span> <span class="va">`Age Group`</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">geom_line</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Line plot</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Optional: Add points</span></span>
<span>  <span class="fu">scale_color_viridis_d</span><span class="op">(</span>option <span class="op">=</span> <span class="st">"turbo"</span><span class="op">)</span> <span class="op">+</span>  <span class="co"># Use a viridis color palette</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">df_inc_age</span><span class="op">$</span><span class="va">Year</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">df_inc_age</span><span class="op">$</span><span class="va">Year</span><span class="op">)</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>  </span>
<span>  <span class="fu">labs</span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Year"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Incidence per 1,000"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Age Group"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme_minimal</span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"right"</span><span class="op">)</span> </span></code></pre></div>
<div class="figure">
<img src="reproduce_results_ainslie_et_al_files/figure-html/annual_inc_by_age-1.png" alt="Figure S4. Annual scabies incidence per 1,000 people by age group in the Netherlands from 2011 to 2022." width="100%"><p class="caption">
Figure S4. Annual scabies incidence per 1,000 people by age group in the
Netherlands from 2011 to 2022.
</p>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kylie Ainslie.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
