<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Quick Start Guide: Estimating Epidemiological Parameters with `mitey` • mitey</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Quick Start Guide: Estimating Epidemiological Parameters with `mitey`">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mitey</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/code_validation_for_Vink_method.html">Code validation for Vink method</a></li>
    <li><a class="dropdown-item" href="../articles/quick_start_guide.html">Quick Start Guide: Estimating Epidemiological Parameters with `mitey`</a></li>
    <li><a class="dropdown-item" href="../articles/reproduce_results_ainslie_et_al.html">Reproduce Results from Ainslie et al.</a></li>
    <li><a class="dropdown-item" href="../articles/rt_estimation_validation.html">Estimation of time-varying reproduction number</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/kylieainslie/mitey/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Quick Start Guide: Estimating Epidemiological Parameters with `mitey`</h1>
                        <h4 data-toc-skip class="author">Kylie
Ainslie</h4>
            
            <h4 data-toc-skip class="date">2025-09-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/kylieainslie/mitey/blob/main/vignettes/quick_start_guide.Rmd" class="external-link"><code>vignettes/quick_start_guide.Rmd</code></a></small>
      <div class="d-none name"><code>quick_start_guide.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<p>First, let’s load the required packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kylieainslie/mitey" class="external-link">mitey</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://wilkelab.org/cowplot/" class="external-link">cowplot</a></span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/reconhub/outbreaks" class="external-link">outbreaks</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette demonstrates how to use the <code>mitey</code> package
to estimate two key epidemiological parameters:</p>
<ul>
<li>
<strong>Serial interval:</strong> The time between symptom onset in
an infector and symptom onset in an infectee</li>
<li>
<strong>Time-varying reproduction number (Rt):</strong> The average
number of secondary cases generated by each infected individual at time
t</li>
</ul>
<p>Understanding these parameters is crucial for characterizing disease
transmission dynamics, evaluating intervention effectiveness, and
designing control strategies. They provide the foundation for
mathematical models that inform public health decision-making.</p>
<p>We’ll use both simulated and real-world examples for each parameter,
with a focus on scabies (a skin infestation caused by the mite Sarcoptes
scabiei) for the real-world applications.</p>
</div>
<div class="section level2">
<h2 id="estimating-the-serial-interval">Estimating the Serial Interval<a class="anchor" aria-label="anchor" href="#estimating-the-serial-interval"></a>
</h2>
<p>The serial interval distribution is crucial for understanding disease
transmission dynamics. The <code>mitey</code> package implements the
method developed by Vink et al. (2014)<span class="citation"><sup>1</sup></span> to estimate the mean and standard
deviation of the serial interval from outbreak data. Accurate serial
interval estimates are essential because they directly inform how we
interpret the spread of disease over time and are key inputs for
estimating the reproduction number.</p>
<div class="section level3">
<h3 id="simulated-data-example">Simulated Data Example<a class="anchor" aria-label="anchor" href="#simulated-data-example"></a>
</h3>
<p>First, let’s generate simulated data with a known serial interval
distribution to validate our method. We’ll create Index Case-to-Case
(ICC) intervals, which represent the time in days between symptom onset
in the first identified case (index case) and symptom onset in
subsequent cases:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parameters for simulation</span></span>
<span><span class="va">N</span> <span class="op">&lt;-</span> <span class="fl">500</span>           <span class="co"># Number of observations</span></span>
<span><span class="va">true_mean</span> <span class="op">&lt;-</span> <span class="fl">15</span>    <span class="co"># True mean serial interval (days)</span></span>
<span><span class="va">true_sd</span> <span class="op">&lt;-</span> <span class="fl">3</span>       <span class="co"># True standard deviation (days)</span></span>
<span><span class="va">route_weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span><span class="op">)</span>  <span class="co"># Weights for transmission routes</span></span>
<span></span>
<span><span class="co"># Generate data for different transmission routes</span></span>
<span><span class="va">CP</span> <span class="op">&lt;-</span> <span class="fu">fdrtool</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fdrtool/man/halfnorm.html" class="external-link">rhalfnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">route_weights</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="va">N</span><span class="op">)</span>, theta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">pi</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="va">true_sd</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Co-Primary</span></span>
<span><span class="va">PS</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">route_weights</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">N</span>, mean<span class="op">=</span><span class="va">true_mean</span>, sd<span class="op">=</span><span class="va">true_sd</span><span class="op">)</span>                <span class="co"># Primary-Secondary</span></span>
<span><span class="va">PT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">route_weights</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">*</span><span class="va">N</span>, mean<span class="op">=</span><span class="fl">2</span><span class="op">*</span><span class="va">true_mean</span>, sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="va">true_sd</span><span class="op">)</span>      <span class="co"># Primary-Tertiary</span></span>
<span><span class="va">PQ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">route_weights</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">*</span><span class="va">N</span>, mean<span class="op">=</span><span class="fl">3</span><span class="op">*</span><span class="va">true_mean</span>, sd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">*</span><span class="va">true_sd</span><span class="op">)</span>      <span class="co"># Primary-Quaternary</span></span>
<span></span>
<span><span class="co"># Combine and round to days</span></span>
<span><span class="va">sim_icc_intervals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">CP</span>, <span class="va">PS</span>, <span class="va">PT</span>, <span class="va">PQ</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize the simulated data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">sim_icc_intervals</span>, </span>
<span>     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">sim_icc_intervals</span><span class="op">)</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">sim_icc_intervals</span><span class="op">)</span><span class="op">+</span><span class="fl">0.5</span>, by<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Simulated ICC Intervals"</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">"Days since index case onset"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"lightblue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="quick_start_guide_files/figure-html/simulate-si-data-1.png" width="2100"></p>
<p>In this simulation, we generate different types of transmission
routes:</p>
<ul>
<li>
<strong>Co-Primary (CP):</strong> Cases infected by the same source
around the same time</li>
<li>
<strong>Primary-Secondary (PS):</strong> Direct transmission from
index case to secondary cases</li>
<li>
<strong>Primary-Tertiary (PT):</strong> Unobserved secondary case
between two cases</li>
<li>
<strong>Primary-Quaternary (PQ):</strong> Unobserved secondary and
tertiary cases between two cases</li>
</ul>
<p>Now, let’s estimate the serial interval using the
<code><a href="../reference/si_estim.html">si_estim()</a></code> function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimate serial interval assuming Normal distribution</span></span>
<span><span class="va">si_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/si_estim.html">si_estim</a></span><span class="op">(</span><span class="va">sim_icc_intervals</span>, dist <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></span>
<span><span class="va">si_results</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt; [1] 15.27227</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sd</span></span>
<span><span class="co">#&gt; [1] 2.668236</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $wts</span></span>
<span><span class="co">#&gt; [1] 2.069240e-01 4.928008e-01 7.268046e-10 2.006243e-01 4.020051e-17</span></span>
<span><span class="co">#&gt; [6] 9.965094e-02 2.539582e-24</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; True parameters:</span></span>
<span><span class="co">#&gt; Mean: 15 days</span></span>
<span><span class="co">#&gt; SD: 3 days</span></span>
<span><span class="co">#&gt; Estimated parameters:</span></span>
<span><span class="co">#&gt; Mean: 15.27 days</span></span>
<span><span class="co">#&gt; SD: 2.67 days</span></span></code></pre>
<p>The <code><a href="../reference/si_estim.html">si_estim()</a></code> function uses a mixture model to
distinguish between different transmission routes. The output
includes:</p>
<ul>
<li>
<code>mean</code>: Estimated mean serial interval (days)</li>
<li>
<code>sd</code>: Estimated standard deviation (days)</li>
<li>
<code>wts</code>: Weights for each transmission component in the
mixture model</li>
</ul>
<p>The choice between normal and gamma distributions for the serial
interval depends on the disease characteristics. Normal distributions
can accommodate negative serial intervals (which can occur when an
infectee shows symptoms before their infector), while gamma
distributions are strictly positive and often better suited for diseases
with minimal pre-symptomatic transmission.</p>
<p>Let’s visualize how well our estimated distribution fits the
data:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract weights</span></span>
<span><span class="va">weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">si_results</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>            <span class="va">si_results</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">si_results</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>,</span>
<span>            <span class="va">si_results</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span> <span class="op">+</span> <span class="va">si_results</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span>, </span>
<span>            <span class="va">si_results</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">6</span><span class="op">]</span> <span class="op">+</span> <span class="va">si_results</span><span class="op">$</span><span class="va">wts</span><span class="op">[</span><span class="fl">7</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the fitted distribution</span></span>
<span><span class="fu"><a href="../reference/plot_si_fit.html">plot_si_fit</a></span><span class="op">(</span></span>
<span>  dat <span class="op">=</span> <span class="va">sim_icc_intervals</span>,</span>
<span>  mean <span class="op">=</span> <span class="va">si_results</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  sd <span class="op">=</span> <span class="va">si_results</span><span class="op">$</span><span class="va">sd</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  weights <span class="op">=</span> <span class="va">weights</span>,</span>
<span>  dist <span class="op">=</span> <span class="st">"normal"</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Fitted Serial Interval Distribution (Simulated Data)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="quick_start_guide_files/figure-html/plot-sim-fit-1.png" width="2100"></p>
<p>The red curve shows the fitted mixture density, with the dashed
vertical line indicating the estimated mean serial interval. Our
estimation accurately recovers the true parameters from the simulated
data.</p>
</div>
<div class="section level3">
<h3 id="real-data-example-scabies-outbreaks">Real Data Example: Scabies Outbreaks<a class="anchor" aria-label="anchor" href="#real-data-example-scabies-outbreaks"></a>
</h3>
<p>Now, let’s analyze real data from scabies outbreaks. We’ll use data
from multiple studies published in the literature:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load scabies ICC interval data</span></span>
<span><span class="va">file_path</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes"</span>, <span class="st">"data"</span>, <span class="st">"si_data.rds"</span><span class="op">)</span></span>
<span><span class="va">scabies_si_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="va">file_path</span><span class="op">)</span></span></code></pre></div>
<p>Scabies has an unusually long serial interval compared to many other
infectious diseases due to its biology and transmission dynamics. The
mite requires time to establish on a new host, reproduce, and build up
sufficient numbers to cause symptoms and become transmissible. This
contrasts sharply with respiratory viruses like influenza, which
typically have serial intervals of only 2-4 days.</p>
<p>We’ll use <code><a href="../reference/si_estim.html">si_estim()</a></code> to estimate the serial interval for
each study:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimate serial interval for each study</span></span>
<span><span class="va">result_by_study</span> <span class="op">&lt;-</span> <span class="va">scabies_si_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">study</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>result <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/si_estim.html">si_estim</a></span><span class="op">(</span><span class="va">icc_interval</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    mean <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"mean"</span><span class="op">)</span>,</span>
<span>    sd <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map_dbl</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"sd"</span><span class="op">)</span>,</span>
<span>    wts <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">result</span>, <span class="st">"wts"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">result</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display results</span></span>
<span><span class="va">result_by_study</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">study</span>, <span class="va">mean</span>, <span class="va">sd</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mean</span>, <span class="va">sd</span><span class="op">)</span>, <span class="va">round</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">mean</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span>caption <span class="op">=</span> <span class="st">"Estimated mean and standard deviation of serial interval (days) by study"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Estimated mean and standard deviation of serial interval (days)
by study</caption>
<thead><tr class="header">
<th align="left">study</th>
<th align="right">mean</th>
<th align="right">sd</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Ariza et al.</td>
<td align="right">98.40</td>
<td align="right">8.54</td>
</tr>
<tr class="even">
<td align="left">Tjon-Kon-Fat et al</td>
<td align="right">110.72</td>
<td align="right">16.14</td>
</tr>
<tr class="odd">
<td align="left">Akunzirwe et al.</td>
<td align="right">122.92</td>
<td align="right">26.92</td>
</tr>
<tr class="even">
<td align="left">Kaburi et al.</td>
<td align="right">167.34</td>
<td align="right">9.72</td>
</tr>
</tbody>
</table>
<p>The notable variation in estimated serial intervals between studies
(ranging from 98 to 167 days) likely reflects differences in study
populations, settings (schools vs. nursing homes), and data collection
methods. This heterogeneity underscores the importance of
context-specific estimates for epidemiological modeling.</p>
<p>Let’s process the results for visualization:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Process weights for plotting</span></span>
<span><span class="va">result_wide</span> <span class="op">&lt;-</span> <span class="va">result_by_study</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">wts</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mean</span>, <span class="va">sd</span>, <span class="va">wts</span><span class="op">)</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"statistic"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"value"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">study</span>, <span class="va">statistic</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    occurrence <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/row_number.html" class="external-link">row_number</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    statistic <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="va">statistic</span> <span class="op">==</span> <span class="st">"wts"</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"weight_"</span>, <span class="va">occurrence</span><span class="op">)</span>, <span class="va">statistic</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">statistic</span> <span class="op">!=</span> <span class="st">"mean"</span> <span class="op">|</span> <span class="va">occurrence</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">statistic</span> <span class="op">!=</span> <span class="st">"sd"</span> <span class="op">|</span> <span class="va">occurrence</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">occurrence</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">statistic</span>,</span>
<span>    values_from <span class="op">=</span> <span class="va">value</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Merge with original data for plotting</span></span>
<span><span class="va">df_merged</span> <span class="op">&lt;-</span> <span class="va">scabies_si_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">result_wide</span>, by <span class="op">=</span> <span class="st">"study"</span>, relationship <span class="op">=</span> <span class="st">"many-to-many"</span><span class="op">)</span></span></code></pre></div>
<p>Let’s visualize the fitted serial interval distribution for each
study:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a function to generate plot for each study</span></span>
<span><span class="va">plot_study</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">study_data</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">study_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">study_data</span><span class="op">$</span><span class="va">study</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="../reference/plot_si_fit.html">plot_si_fit</a></span><span class="op">(</span></span>
<span>    dat <span class="op">=</span> <span class="va">study_data</span><span class="op">$</span><span class="va">icc_interval</span>,</span>
<span>    mean <span class="op">=</span> <span class="va">study_data</span><span class="op">$</span><span class="va">mean</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    sd <span class="op">=</span> <span class="va">study_data</span><span class="op">$</span><span class="va">sd</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">study_data</span><span class="op">$</span><span class="va">weight_1</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>                <span class="va">study_data</span><span class="op">$</span><span class="va">weight_2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">study_data</span><span class="op">$</span><span class="va">weight_3</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>                <span class="va">study_data</span><span class="op">$</span><span class="va">weight_4</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">study_data</span><span class="op">$</span><span class="va">weight_5</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>                <span class="va">study_data</span><span class="op">$</span><span class="va">weight_6</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">study_data</span><span class="op">$</span><span class="va">weight_7</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    dist <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>    scaling_factor <span class="op">=</span> <span class="fl">0.25</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="va">study_name</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Generate plots for each study</span></span>
<span><span class="va">study_plots</span> <span class="op">&lt;-</span> <span class="va">df_merged</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">study</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_split.html" class="external-link">group_split</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">plot_study</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine plots</span></span>
<span><span class="va">combined_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span></span>
<span>  plotlist <span class="op">=</span> <span class="va">study_plots</span>,</span>
<span>  labels <span class="op">=</span> <span class="st">"AUTO"</span>,</span>
<span>  ncol <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display combined plot</span></span>
<span><span class="va">combined_plot</span></span></code></pre></div>
<p><img src="quick_start_guide_files/figure-html/plot-si-multi-1.png" width="3000"></p>
<p>These plots show considerable variation in estimated serial intervals
between studies (ranging from ~98 days to ~167 days). The differences
may be due to variations in study settings, population characteristics,
and data collection methods.</p>
</div>
</div>
<div class="section level2">
<h2 id="estimating-time-varying-reproduction-number-rt">Estimating Time-Varying Reproduction Number (Rt)<a class="anchor" aria-label="anchor" href="#estimating-time-varying-reproduction-number-rt"></a>
</h2>
<div class="section level3">
<h3 id="introduction-1">Introduction<a class="anchor" aria-label="anchor" href="#introduction-1"></a>
</h3>
<p>The time-varying reproduction number (Rt) is a key parameter in
infectious disease epidemiology that quantifies how transmission
potential changes over time. The <code>mitey</code> package implements
the Wallinga-Lipsitch method for estimating Rt from time series of case
counts. This vignette demonstrates how to use the
<code><a href="../reference/wallinga_lipsitch.html">wallinga_lipsitch()</a></code> function with both simulated and real
data.</p>
<div class="section level4">
<h4 id="method-details">Method details<a class="anchor" aria-label="anchor" href="#method-details"></a>
</h4>
<p>The Wallinga-Lipsitch method<span class="citation"><sup>2</sup></span> establishes a relationship between
the growth rate of an epidemic and the reproduction number. This
approach:</p>
<ul>
<li>Uses the serial interval distribution to connect observed cases over
time</li>
<li>Calculates relative likelihoods of transmission between cases</li>
<li>Adjusts for right-truncation (recent cases that haven’t had time to
infect others)</li>
<li>Produces estimates of the case reproduction number (Rt)</li>
</ul>
<p>The <code><a href="../reference/wallinga_lipsitch.html">wallinga_lipsitch()</a></code> function in <code>mitey</code>
takes the following parameters:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/wallinga_lipsitch.html">wallinga_lipsitch</a></span><span class="op">(</span></span>
<span>  <span class="va">incidence</span>,          <span class="co"># Vector of case counts</span></span>
<span>  <span class="va">dates</span>,              <span class="co"># Vector of dates corresponding to incidence</span></span>
<span>  <span class="va">si_mean</span>,            <span class="co"># Mean of serial interval distribution (days)</span></span>
<span>  <span class="va">si_sd</span>,              <span class="co"># Standard deviation of serial interval </span></span>
<span>  si_dist <span class="op">=</span> <span class="st">"gamma"</span>,  <span class="co"># Distribution type ("gamma" or "normal")</span></span>
<span>  smoothing <span class="op">=</span> <span class="fl">0</span>,      <span class="co"># Window size for smoothing (0 for no smoothing)</span></span>
<span>  bootstrap <span class="op">=</span> <span class="cn">FALSE</span>,  <span class="co"># Whether to compute bootstrap CIs</span></span>
<span>  n_bootstrap <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># Number of bootstrap samples</span></span>
<span>  conf_level <span class="op">=</span> <span class="fl">0.95</span>,  <span class="co"># Confidence level for intervals</span></span>
<span>  shift <span class="op">=</span> <span class="cn">FALSE</span>       <span class="co"># Whether to shift estimates by one serial interval</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="simulated-data-example-1">Simulated Data Example<a class="anchor" aria-label="anchor" href="#simulated-data-example-1"></a>
</h3>
<p>Let’s generate epidemic data with a known time-varying reproduction
number to validate our implementation:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulation parameters</span></span>
<span><span class="va">t_end</span> <span class="op">&lt;-</span> <span class="fl">100</span>        <span class="co"># Simulation duration (days)</span></span>
<span><span class="va">si_mean</span> <span class="op">&lt;-</span> <span class="fl">7</span>        <span class="co"># Mean serial interval (days)</span></span>
<span><span class="va">si_sd</span> <span class="op">&lt;-</span> <span class="fl">2</span>          <span class="co"># SD of serial interval (days)</span></span>
<span></span>
<span><span class="co"># Define a time-varying reproduction number function</span></span>
<span><span class="co"># This creates a pattern where Rt starts high, decreases below 1, then increases again</span></span>
<span><span class="va">true_rt</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">t</span> <span class="op">&lt;</span> <span class="fl">20</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">2.5</span><span class="op">)</span>                  <span class="co"># Initial high Rt</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">t</span> <span class="op">&lt;</span> <span class="fl">40</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">2.5</span> <span class="op">-</span> <span class="fl">0.075</span> <span class="op">*</span> <span class="op">(</span><span class="va">t</span> <span class="op">-</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span> <span class="co"># Linear decrease</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">t</span> <span class="op">&lt;</span> <span class="fl">60</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">1.0</span><span class="op">)</span>                  <span class="co"># Stable period at Rt=1</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">t</span> <span class="op">&lt;</span> <span class="fl">80</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">1.0</span> <span class="op">+</span> <span class="fl">0.05</span> <span class="op">*</span> <span class="op">(</span><span class="va">t</span> <span class="op">-</span> <span class="fl">60</span><span class="op">)</span><span class="op">)</span>  <span class="co"># Linear increase</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fl">2.0</span><span class="op">)</span>                             <span class="co"># Final high Rt</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Create vector of true Rt values for plotting</span></span>
<span><span class="va">true_rt_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">t_end</span>, <span class="va">true_rt</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Initialize with some seed cases</span></span>
<span><span class="va">cases</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">t_end</span><span class="op">)</span></span>
<span><span class="va">cases</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">8</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Serial interval distribution (discretized normal)</span></span>
<span><span class="va">si_pmf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">dnorm</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">30</span>, mean <span class="op">=</span> <span class="va">si_mean</span>, sd <span class="op">=</span> <span class="va">si_sd</span><span class="op">)</span></span>
<span><span class="va">si_pmf</span> <span class="op">&lt;-</span> <span class="va">si_pmf</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">si_pmf</span><span class="op">)</span>  <span class="co"># Normalize to sum to 1</span></span>
<span></span>
<span><span class="co"># Generate incidence using renewal equation model</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">6</span><span class="op">:</span><span class="va">t_end</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Calculate expected new cases</span></span>
<span>  <span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">s</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">t</span><span class="op">-</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">si_pmf</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">lambda</span> <span class="op">&lt;-</span> <span class="va">lambda</span> <span class="op">+</span> <span class="va">cases</span><span class="op">[</span><span class="va">t</span><span class="op">-</span><span class="va">s</span><span class="op">]</span> <span class="op">*</span> <span class="fu">true_rt</span><span class="op">(</span><span class="va">t</span><span class="op">-</span><span class="va">s</span><span class="op">)</span> <span class="op">*</span> <span class="va">si_pmf</span><span class="op">[</span><span class="va">s</span><span class="op">]</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># Add randomness (negative binomial distribution)</span></span>
<span>  <span class="va">cases</span><span class="op">[</span><span class="va">t</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/NegBinomial.html" class="external-link">rnbinom</a></span><span class="op">(</span><span class="fl">1</span>, mu <span class="op">=</span> <span class="va">lambda</span>, size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Create dates sequence</span></span>
<span><span class="va">sim_dates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html" class="external-link">seq.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2023-01-01"</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"day"</span>, length.out <span class="op">=</span> <span class="va">t_end</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create data frame</span></span>
<span><span class="va">sim_epidemic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  date <span class="op">=</span> <span class="va">sim_dates</span>,</span>
<span>  cases <span class="op">=</span> <span class="va">cases</span>,</span>
<span>  true_rt <span class="op">=</span> <span class="va">true_rt_values</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot the simulated epidemic curve with true Rt</span></span>
<span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sim_epidemic</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">cases</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_col</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"steelblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Daily Cases"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Simulated Epidemic Curve"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">sim_epidemic</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">true_rt</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"red"</span>, linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Reproduction Number"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"True Time-Varying Rt"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Combine plots</span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="quick_start_guide_files/figure-html/sim-rt-1.png" width="2100"></p>
<p>Note that the epidemic curve directly reflects changes in the
reproduction number:</p>
<ul>
<li>When Rt &gt; 1 (days 1-50, then after day 80), the epidemic
grows</li>
<li>When Rt = 1 (around days 50-60), the epidemic plateaus</li>
<li>When Rt &lt; 1 (days 60-80), the epidemic declines</li>
</ul>
<p>Now, let’s estimate Rt using the <code><a href="../reference/wallinga_lipsitch.html">wallinga_lipsitch()</a></code>
function:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Estimate Rt using wallinga_lipsitch</span></span>
<span><span class="va">rt_estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wallinga_lipsitch.html">wallinga_lipsitch</a></span><span class="op">(</span></span>
<span>  incidence <span class="op">=</span> <span class="va">sim_epidemic</span><span class="op">$</span><span class="va">cases</span>,</span>
<span>  dates <span class="op">=</span> <span class="va">sim_epidemic</span><span class="op">$</span><span class="va">date</span>,</span>
<span>  si_mean <span class="op">=</span> <span class="va">si_mean</span>,</span>
<span>  si_sd <span class="op">=</span> <span class="va">si_sd</span>,</span>
<span>  si_dist <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>  smoothing <span class="op">=</span> <span class="fl">7</span>,        <span class="co"># 7-day smoothing window</span></span>
<span>  bootstrap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_bootstrap <span class="op">=</span> <span class="fl">100</span>     <span class="co"># Use more in practice</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Convert to data frame for plotting</span></span>
<span><span class="va">rt_est_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">rt_estimates</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare estimated vs true Rt</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># True Rt</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">sim_epidemic</span>, </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">true_rt</span>, color <span class="op">=</span> <span class="st">"True Rt"</span><span class="op">)</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="co"># Estimated Rt (with right-truncation correction)</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">rt_est_df</span>, </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">R_corrected</span>, color <span class="op">=</span> <span class="st">"Estimated Rt"</span><span class="op">)</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="co"># Confidence intervals</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">rt_est_df</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, ymin <span class="op">=</span> <span class="va">R_corrected_lower</span>, ymax <span class="op">=</span> <span class="va">R_corrected_upper</span><span class="op">)</span>,</span>
<span>    fill <span class="op">=</span> <span class="st">"blue"</span>, alpha <span class="op">=</span> <span class="fl">0.2</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="co"># R=1 threshold</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="co"># Styling</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True Rt"</span> <span class="op">=</span> <span class="st">"red"</span>, <span class="st">"Estimated Rt"</span> <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span>,</span>
<span>    name <span class="op">=</span> <span class="st">""</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Reproduction Number (Rt)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Comparison of True vs. Estimated Rt"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Using Wallinga-Lipsitch method with 7-day smoothing"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="quick_start_guide_files/figure-html/estimate-rt-1.png" width="2100"></p>
<p>Note that the estimated Rt (blue line) seems to lag behind the true
Rt (red line). This is expected because the case reproduction number
we’re estimating is based on when cases are observed, while the
instantaneous reproduction number (our true Rt) represents current
transmission potential. The choice of smoothing window is important -
too small and the estimates will be noisy, too large and they may miss
important changes in transmission dynamics.</p>
<div class="section level4">
<h4 id="understanding-the-shift-parameter">Understanding the ‘shift’ Parameter<a class="anchor" aria-label="anchor" href="#understanding-the-shift-parameter"></a>
</h4>
<p>The <code><a href="../reference/wallinga_lipsitch.html">wallinga_lipsitch()</a></code> function includes a
<code>shift</code> parameter that can help align case reproduction
number estimates with instantaneous reproduction number estimates. When
set to <code>TRUE</code>, this parameter shifts Rt estimates forward by
one mean serial interval to better match the timing of changes in
transmission:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Re-estimate with shift=TRUE</span></span>
<span><span class="va">rt_shifted</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wallinga_lipsitch.html">wallinga_lipsitch</a></span><span class="op">(</span></span>
<span>  incidence <span class="op">=</span> <span class="va">sim_epidemic</span><span class="op">$</span><span class="va">cases</span>,</span>
<span>  dates <span class="op">=</span> <span class="va">sim_epidemic</span><span class="op">$</span><span class="va">date</span>,</span>
<span>  si_mean <span class="op">=</span> <span class="va">si_mean</span>,</span>
<span>  si_sd <span class="op">=</span> <span class="va">si_sd</span>,</span>
<span>  si_dist <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>  smoothing <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  bootstrap <span class="op">=</span> <span class="cn">FALSE</span>,  <span class="co"># Skip bootstrap for speed</span></span>
<span>  shift <span class="op">=</span> <span class="cn">TRUE</span>        <span class="co"># Use shift parameter</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare true Rt with both original and shifted estimates</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># True Rt</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">sim_epidemic</span>, </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">true_rt</span>, color <span class="op">=</span> <span class="st">"True Rt"</span><span class="op">)</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="co"># Original estimated Rt</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">rt_est_df</span>, </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span>, y <span class="op">=</span> <span class="va">R_corrected</span>, color <span class="op">=</span> <span class="st">"Estimated Rt (original)"</span><span class="op">)</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="co"># Shifted estimated Rt</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">rt_shifted</span><span class="op">)</span>, </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">shifted_date</span>, y <span class="op">=</span> <span class="va">R_corrected</span>, color <span class="op">=</span> <span class="st">"Estimated Rt (shifted)"</span><span class="op">)</span>,</span>
<span>    linewidth <span class="op">=</span> <span class="fl">1</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="co"># R=1 threshold</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  </span>
<span>  <span class="co"># Styling</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span></span>
<span>    values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"True Rt"</span> <span class="op">=</span> <span class="st">"red"</span>, </span>
<span>               <span class="st">"Estimated Rt (original)"</span> <span class="op">=</span> <span class="st">"blue"</span>,</span>
<span>               <span class="st">"Estimated Rt (shifted)"</span> <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span>,</span>
<span>    name <span class="op">=</span> <span class="st">""</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Reproduction Number (Rt)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Effect of the 'shift' parameter on Rt estimates"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Shifting forward by one serial interval (7 days)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html" class="external-link">ylim</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="quick_start_guide_files/figure-html/rt-shift-1.png" width="2100"></p>
<p>The shifted estimates align better with the true Rt values. The shift
parameter moves estimates forward by one mean serial interval, which
helps address the inherent lag in case-based Rt estimation.</p>
</div>
</div>
<div class="section level3">
<h3 id="real-data-example">Real Data Example<a class="anchor" aria-label="anchor" href="#real-data-example"></a>
</h3>
<div class="section level4">
<h4 id="zika-outbreak-in-giradot-colombia-2015">Zika outbreak in Giradot, Colombia (2015)<a class="anchor" aria-label="anchor" href="#zika-outbreak-in-giradot-colombia-2015"></a>
</h4>
<p>To illustrate how to apply the Wallinga-Lipsitch method to real data,
we’ll use data on daily incidence of Zika virus disease in Giradot,
Colombia from October 2015 to January 2016. The data is available from
the <code>outbreaks</code> package<span class="citation"><sup>3</sup></span>.</p>
<p>The Zika epidemic in Colombia was part of a larger outbreak across
the Americas in 2015-2016. Zika virus is primarily transmitted by Aedes
mosquitoes, and the outbreak in Colombia was notable for its rapid
spread and the associated health impacts, including an increase in cases
of microcephaly in newborns and Guillain-Barré syndrome<span class="citation"><sup>4</sup></span>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">zika_girardot_2015</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Examine the data structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">zika_girardot_2015</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    93 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;  $ date : Date, format: "2015-10-19" "2015-10-22" ...</span></span>
<span><span class="co">#&gt;  $ cases: int  1 2 1 4 2 5 2 4 5 4 ...</span></span></code></pre></div>
<p>Let’s have a look at the epidemic curve.
<img src="quick_start_guide_files/figure-html/zike_epicurve-1.png" width="2100"></p>
<p>Now we’ll estimate the reproduction number using the
<code><a href="../reference/wallinga_lipsitch.html">wallinga_lipsitch()</a></code> function we created. For Zika virus,
we’ll use a mean serial interval of 7 days with a standard deviation of
1.5 days, based on literature estimates for mosquito-borne diseases:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Parameters for Zika</span></span>
<span><span class="va">zika_si_mean</span> <span class="op">&lt;-</span> <span class="fl">7</span>  <span class="co"># days</span></span>
<span><span class="va">zika_si_sd</span> <span class="op">&lt;-</span> <span class="fl">1.5</span>     <span class="co"># days</span></span>
<span></span>
<span><span class="co"># Estimate Rt using the Wallinga-Lipsitch method</span></span>
<span><span class="va">rt_zika</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wallinga_lipsitch.html">wallinga_lipsitch</a></span><span class="op">(</span></span>
<span>  incidence <span class="op">=</span> <span class="va">zika_girardot_2015</span><span class="op">$</span><span class="va">cases</span>,</span>
<span>  dates <span class="op">=</span> <span class="va">zika_girardot_2015</span><span class="op">$</span><span class="va">date</span>,</span>
<span>  si_mean <span class="op">=</span> <span class="va">zika_si_mean</span>,</span>
<span>  si_sd <span class="op">=</span> <span class="va">zika_si_sd</span>,</span>
<span>  si_dist <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>  smoothing <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  bootstrap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_bootstrap <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  conf_level <span class="op">=</span> <span class="fl">0.95</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rt_zika</span><span class="op">)</span></span>
<span><span class="co">#&gt;         date incidence         R R_corrected  R_lower   R_upper</span></span>
<span><span class="co">#&gt; 1 2015-10-19         1 14.581278          NA 4.902768 20.361782</span></span>
<span><span class="co">#&gt; 2 2015-10-22         2  3.878647    3.878647 1.765327 20.228407</span></span>
<span><span class="co">#&gt; 3 2015-10-23         1  3.045381    3.045381 1.611395 12.277686</span></span>
<span><span class="co">#&gt; 4 2015-10-24         4  2.728295    2.728295 1.587628  5.251488</span></span>
<span><span class="co">#&gt; 5 2015-10-25         2  2.876025    2.876025 1.846027  5.279635</span></span>
<span><span class="co">#&gt; 6 2015-10-26         5  3.374939    3.374939 2.365928  6.187512</span></span>
<span><span class="co">#&gt;   R_corrected_lower R_corrected_upper</span></span>
<span><span class="co">#&gt; 1          4.144712          9.421278</span></span>
<span><span class="co">#&gt; 2          1.740119          9.037280</span></span>
<span><span class="co">#&gt; 3          1.607320          7.723497</span></span>
<span><span class="co">#&gt; 4          1.587628          5.251488</span></span>
<span><span class="co">#&gt; 5          1.846027          5.279635</span></span>
<span><span class="co">#&gt; 6          2.365928          6.187512</span></span></code></pre></div>
<p>Now let’s visualise the reproduction number estimates.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Prepare data for visualization</span></span>
<span><span class="va">rt_plot_data</span> <span class="op">&lt;-</span> <span class="va">rt_zika</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">R_corrected</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Skip the first 7 days of unstable estimates</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">date</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span> <span class="op">+</span> <span class="fl">7</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot Rt over time</span></span>
<span><span class="va">rt_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">rt_plot_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">date</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">geom_ribbon</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">R_corrected_lower</span>, ymax <span class="op">=</span> <span class="va">R_corrected_upper</span><span class="op">)</span>, </span>
<span>              fill <span class="op">=</span> <span class="st">"#21908C"</span>, alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">R_corrected</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"#21908C"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#coord_cartesian(ylim = c(0, 3)) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_date</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"14 days"</span>, date_labels <span class="op">=</span> <span class="st">"%d-%m-%Y"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    x <span class="op">=</span> <span class="st">"Time"</span>, </span>
<span>    y <span class="op">=</span> <span class="st">"Reproduction number (Rt)"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Estimated reproduction number for Zika in Girardot, Colombia"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Serial interval: "</span>, <span class="va">zika_si_mean</span>, <span class="st">" days (SD: "</span>, <span class="va">zika_si_sd</span>, <span class="st">" days)"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show Rt plot with epicurve</span></span>
<span><span class="fu"><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></span><span class="op">(</span><span class="va">zika_epicurve</span>, <span class="va">rt_plot</span>, ncol <span class="op">=</span> <span class="fl">1</span>, rel_heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="quick_start_guide_files/figure-html/rt_viz-1.png" width="2100"></p>
<p>The reproduction number plot tells an important epidemiological
story:</p>
<ul>
<li>Initially, Rt was well above 1, indicating rapid epidemic
growth</li>
<li>Around November-December, Rt crosses below 1, suggesting that
control measures or other factors were beginning to reduce
transmission</li>
<li>By January, Rt remains below 1, suggesting the epidemic was being
controlled</li>
</ul>
<p>This analysis demonstrates how Rt estimation can provide valuable
insights for evaluating the effectiveness of interventions and
predicting the future course of an epidemic.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body" line-spacing="2">
<div id="ref-vink2014" class="csl-entry">
<div class="csl-left-margin">1. </div>
<div class="csl-right-inline">Vink, M. A., Bootsma, M. C. &amp; Wallinga, J.
Serial intervals of respiratory infectious diseases: A systematic review
and analysis. <em>American Journal of Epidemiology</em>
<strong>180</strong>, 865–875 (2014).</div>
</div>
<div id="ref-wallinga2007" class="csl-entry">
<div class="csl-left-margin">2. </div>
<div class="csl-right-inline">Wallinga, J. &amp; Lipsitch, M. How generation
intervals shape the relationship between growth rates and reproductive
numbers. <em>Proceedings of the Royal Society B: Biological
Sciences</em> <strong>274</strong>, 599–604 (2007).</div>
</div>
<div id="ref-kamvar2019" class="csl-entry">
<div class="csl-left-margin">3. </div>
<div class="csl-right-inline">Kamvar, Z. N., Cai, J., Pulliam, J. R.,
Schumacher, J. &amp; Jombart, T. <em><a href="https://CRAN.R-project.org/package=outbreaks" class="external-link">Outbreaks: A
Collection of Disease Outbreak Data</a></em>. (2019).</div>
</div>
<div id="ref-rojas2016" class="csl-entry">
<div class="csl-left-margin">4. </div>
<div class="csl-right-inline">Rojas, D. P. <em>et al.</em> The epidemiology
and transmissibility of zika virus in girardot and san andres island,
colombia, september 2015 to january 2016. <em>Eurosurveillance</em>
<strong>21</strong>, 30283 (2016).</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Kylie Ainslie.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
